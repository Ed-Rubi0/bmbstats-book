<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 RCT analysis and prediction in bmbstats | bmbstats: bootstrap magnitude-based statistics for sports scientists</title>
  <meta name="description" content="Chapter 16 RCT analysis and prediction in bmbstats | bmbstats: bootstrap magnitude-based statistics for sports scientists" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 RCT analysis and prediction in bmbstats | bmbstats: bootstrap magnitude-based statistics for sports scientists" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="www.complementarytraining.net" />
  
  
  <meta name="github-repo" content="mladenjovanovic/bmbstats-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 RCT analysis and prediction in bmbstats | bmbstats: bootstrap magnitude-based statistics for sports scientists" />
  <meta name="twitter:site" content="@physical_prep" />
  
  

<meta name="author" content="Mladen Jovanovic" />


<meta name="date" content="2020-07-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="validity-and-reliability.html"/>
<link rel="next" href="appendix-a-dorem-package.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="adv-r.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">bmbstats book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-and-r-packages"><i class="fa fa-check"></i>R and R packages</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="part"><span><b>I Part One</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="description.html"><a href="description.html"><i class="fa fa-check"></i><b>2</b> Description</a>
<ul>
<li class="chapter" data-level="2.1" data-path="description.html"><a href="description.html#comparing-two-independent-groups"><i class="fa fa-check"></i><b>2.1</b> Comparing two independent groups</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="description.html"><a href="description.html#sample-mean-as-the-simplest-statistical-model"><i class="fa fa-check"></i><b>2.1.1</b> Sample <code>mean</code> as the simplest statistical model</a></li>
<li class="chapter" data-level="2.1.2" data-path="description.html"><a href="description.html#effect-sizes"><i class="fa fa-check"></i><b>2.1.2</b> Effect Sizes</a></li>
<li class="chapter" data-level="2.1.3" data-path="description.html"><a href="description.html#the-smallest-effect-size-of-interest"><i class="fa fa-check"></i><b>2.1.3</b> The Smallest Effect Size Of Interest</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="description.html"><a href="description.html#comparing-dependent-groups"><i class="fa fa-check"></i><b>2.2</b> Comparing dependent groups</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="description.html"><a href="description.html#describing-groups-as-independent"><i class="fa fa-check"></i><b>2.2.1</b> Describing groups as independent</a></li>
<li class="chapter" data-level="2.2.2" data-path="description.html"><a href="description.html#effect-sizes-1"><i class="fa fa-check"></i><b>2.2.2</b> Effect Sizes</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="description.html"><a href="description.html#describing-relationship-between-two-variables"><i class="fa fa-check"></i><b>2.3</b> Describing relationship between two variables</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="description.html"><a href="description.html#magnitude-based-estimators"><i class="fa fa-check"></i><b>2.3.1</b> Magnitude-based estimators</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="description.html"><a href="description.html#advanced-uses"><i class="fa fa-check"></i><b>2.4</b> Advanced uses</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="prediction.html"><a href="prediction.html"><i class="fa fa-check"></i><b>3</b> Prediction</a>
<ul>
<li class="chapter" data-level="3.1" data-path="prediction.html"><a href="prediction.html#overfitting"><i class="fa fa-check"></i><b>3.1</b> Overfitting</a></li>
<li class="chapter" data-level="3.2" data-path="prediction.html"><a href="prediction.html#cross-validation"><i class="fa fa-check"></i><b>3.2</b> Cross-Validation</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="prediction.html"><a href="prediction.html#sample-mean-as-the-simplest-predictive-model"><i class="fa fa-check"></i><b>3.2.1</b> Sample <code>mean</code> as the simplest predictive model</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="prediction.html"><a href="prediction.html#bias-variance-decomposition-and-trade-off"><i class="fa fa-check"></i><b>3.3</b> Bias-Variance decomposition and trade-off</a></li>
<li class="chapter" data-level="3.4" data-path="prediction.html"><a href="prediction.html#interpretability"><i class="fa fa-check"></i><b>3.4</b> Interpretability</a></li>
<li class="chapter" data-level="3.5" data-path="prediction.html"><a href="prediction.html#magnitude-based-prediction-estimators"><i class="fa fa-check"></i><b>3.5</b> Magnitude-based prediction estimators</a></li>
<li class="chapter" data-level="3.6" data-path="prediction.html"><a href="prediction.html#practical-example-mas-and-yoyoir1-prediction"><i class="fa fa-check"></i><b>3.6</b> Practical example: MAS and YoYoIR1 prediction</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="prediction.html"><a href="prediction.html#predicting-mas-from-yoyoir1"><i class="fa fa-check"></i><b>3.6.1</b> Predicting MAS from YoYoIR1</a></li>
<li class="chapter" data-level="3.6.2" data-path="prediction.html"><a href="prediction.html#predicting-yoyoir1-from-mas"><i class="fa fa-check"></i><b>3.6.2</b> Predicting YoYoIR1 from MAS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="causal-inference.html"><a href="causal-inference.html"><i class="fa fa-check"></i><b>4</b> Causal inference</a>
<ul>
<li class="chapter" data-level="4.1" data-path="causal-inference.html"><a href="causal-inference.html#necessary-versus-sufficient-causality"><i class="fa fa-check"></i><b>4.1</b> Necessary versus sufficient causality</a></li>
<li class="chapter" data-level="4.2" data-path="causal-inference.html"><a href="causal-inference.html#observational-data"><i class="fa fa-check"></i><b>4.2</b> Observational data</a></li>
<li class="chapter" data-level="4.3" data-path="causal-inference.html"><a href="causal-inference.html#potential-outcomes-or-counterfactuals"><i class="fa fa-check"></i><b>4.3</b> Potential outcomes or counterfactuals</a></li>
<li class="chapter" data-level="4.4" data-path="causal-inference.html"><a href="causal-inference.html#ceteris-paribus-and-the-biases"><i class="fa fa-check"></i><b>4.4</b> <em>Ceteris paribus</em> and the biases</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="causal-inference.html"><a href="causal-inference.html#randomization"><i class="fa fa-check"></i><b>4.4.1</b> Randomization</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="causal-inference.html"><a href="causal-inference.html#subject-matter-knowledge"><i class="fa fa-check"></i><b>4.5</b> Subject matter knowledge</a></li>
<li class="chapter" data-level="4.6" data-path="causal-inference.html"><a href="causal-inference.html#example-of-randomized-control-trial"><i class="fa fa-check"></i><b>4.6</b> Example of randomized control trial</a></li>
<li class="chapter" data-level="4.7" data-path="causal-inference.html"><a href="causal-inference.html#prediction-as-a-complement-to-causal-inference"><i class="fa fa-check"></i><b>4.7</b> Prediction as a complement to causal inference</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="causal-inference.html"><a href="causal-inference.html#analysis-of-the-individual-residuals-responders-vs-non-responders"><i class="fa fa-check"></i><b>4.7.1</b> Analysis of the individual residuals: responders vs non-responders</a></li>
<li class="chapter" data-level="4.7.2" data-path="causal-inference.html"><a href="causal-inference.html#counterfactual-analysis-and-individual-treatment-effects"><i class="fa fa-check"></i><b>4.7.2</b> Counterfactual analysis and Individual Treatment Effects</a></li>
<li class="chapter" data-level="4.7.3" data-path="causal-inference.html"><a href="causal-inference.html#direct-and-indirect-effect-covariates-and-then-some"><i class="fa fa-check"></i><b>4.7.3</b> Direct and indirect effect, covariates and then some</a></li>
<li class="chapter" data-level="4.7.4" data-path="causal-inference.html"><a href="causal-inference.html#model-selection"><i class="fa fa-check"></i><b>4.7.4</b> Model selection</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="causal-inference.html"><a href="causal-inference.html#ergodicity"><i class="fa fa-check"></i><b>4.8</b> Ergodicity</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>5</b> Statistical inference</a>
<ul>
<li class="chapter" data-level="5.1" data-path="statistical-inference.html"><a href="statistical-inference.html#two-kinds-of-uncertainty-two-kinds-of-probability-two-kinds-of-statistical-inference"><i class="fa fa-check"></i><b>5.1</b> Two kinds of uncertainty, two kinds of probability, two kinds of statistical inference</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html"><i class="fa fa-check"></i><b>6</b> Frequentist perspective</a>
<ul>
<li class="chapter" data-level="6.1" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html#null-hypothesis-significance-testing"><i class="fa fa-check"></i><b>6.1</b> Null-Hypothesis Significance Testing</a></li>
<li class="chapter" data-level="6.2" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html#statistical-power"><i class="fa fa-check"></i><b>6.2</b> Statistical Power</a></li>
<li class="chapter" data-level="6.3" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html#new-statistics-confidence-intervals-and-estimation"><i class="fa fa-check"></i><b>6.3</b> New Statistics: Confidence Intervals and Estimation</a></li>
<li class="chapter" data-level="6.4" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html#minimum-effect-tests"><i class="fa fa-check"></i><b>6.4</b> Minimum Effect Tests</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html#individual-vs.-parameter-sesoi"><i class="fa fa-check"></i><b>6.4.1</b> Individual vs. Parameter SESOI</a></li>
<li class="chapter" data-level="6.4.2" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html#two-one-sided-tests-of-equivalence"><i class="fa fa-check"></i><b>6.4.2</b> Two one-sided tests of equivalence</a></li>
<li class="chapter" data-level="6.4.3" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html#superiority-and-non-inferiority"><i class="fa fa-check"></i><b>6.4.3</b> Superiority and Non-Inferiority</a></li>
<li class="chapter" data-level="6.4.4" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html#inferiority-and-non-superiority"><i class="fa fa-check"></i><b>6.4.4</b> Inferiority and Non-Superiority</a></li>
<li class="chapter" data-level="6.4.5" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html#inference-from-mets"><i class="fa fa-check"></i><b>6.4.5</b> Inference from METs</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html#magnitude-based-inference"><i class="fa fa-check"></i><b>6.5</b> Magnitude Based Inference</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="bayesian-perspective.html"><a href="bayesian-perspective.html"><i class="fa fa-check"></i><b>7</b> Bayesian perspective</a>
<ul>
<li class="chapter" data-level="7.1" data-path="bayesian-perspective.html"><a href="bayesian-perspective.html#grid-approximation"><i class="fa fa-check"></i><b>7.1</b> Grid approximation</a></li>
<li class="chapter" data-level="7.2" data-path="bayesian-perspective.html"><a href="bayesian-perspective.html#priors"><i class="fa fa-check"></i><b>7.2</b> Priors</a></li>
<li class="chapter" data-level="7.3" data-path="bayesian-perspective.html"><a href="bayesian-perspective.html#likelihood-function"><i class="fa fa-check"></i><b>7.3</b> Likelihood function</a></li>
<li class="chapter" data-level="7.4" data-path="bayesian-perspective.html"><a href="bayesian-perspective.html#posterior-probability"><i class="fa fa-check"></i><b>7.4</b> Posterior probability</a></li>
<li class="chapter" data-level="7.5" data-path="bayesian-perspective.html"><a href="bayesian-perspective.html#adding-more-possibilities"><i class="fa fa-check"></i><b>7.5</b> Adding more possibilities</a></li>
<li class="chapter" data-level="7.6" data-path="bayesian-perspective.html"><a href="bayesian-perspective.html#different-prior"><i class="fa fa-check"></i><b>7.6</b> Different prior</a></li>
<li class="chapter" data-level="7.7" data-path="bayesian-perspective.html"><a href="bayesian-perspective.html#more-data"><i class="fa fa-check"></i><b>7.7</b> More data</a></li>
<li class="chapter" data-level="7.8" data-path="bayesian-perspective.html"><a href="bayesian-perspective.html#summarizing-prior-and-posterior-distributions-with-map-and-hdi"><i class="fa fa-check"></i><b>7.8</b> Summarizing prior and posterior distributions with MAP and HDI</a></li>
<li class="chapter" data-level="7.9" data-path="bayesian-perspective.html"><a href="bayesian-perspective.html#comparison-to-nhst-type-i-errors"><i class="fa fa-check"></i><b>7.9</b> Comparison to NHST Type I errors</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i><b>8</b> Bootstrap</a>
<ul>
<li class="chapter" data-level="8.1" data-path="bootstrap.html"><a href="bootstrap.html#summarizing-bootstrap-distribution"><i class="fa fa-check"></i><b>8.1</b> Summarizing bootstrap distribution</a></li>
<li class="chapter" data-level="8.2" data-path="bootstrap.html"><a href="bootstrap.html#bootstrap-type-i-errors"><i class="fa fa-check"></i><b>8.2</b> Bootstrap Type I errors</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistical-inference-conclusion.html"><a href="statistical-inference-conclusion.html"><i class="fa fa-check"></i><b>9</b> Statistical inference conclusion</a></li>
<li class="chapter" data-level="10" data-path="measurement-error.html"><a href="measurement-error.html"><i class="fa fa-check"></i><b>10</b> Measurement Error</a>
<ul>
<li class="chapter" data-level="10.1" data-path="measurement-error.html"><a href="measurement-error.html#estimating-te-using-ordinary-least-products-regression"><i class="fa fa-check"></i><b>10.1</b> Estimating <code>TE</code> using <em>ordinary least products</em> regression</a></li>
<li class="chapter" data-level="10.2" data-path="measurement-error.html"><a href="measurement-error.html#smallest-detectable-change"><i class="fa fa-check"></i><b>10.2</b> Smallest Detectable Change</a></li>
<li class="chapter" data-level="10.3" data-path="measurement-error.html"><a href="measurement-error.html#interpreting-individual-changes-using-sesoi-and-sdc"><i class="fa fa-check"></i><b>10.3</b> Interpreting individual changes using SESOI and SDC</a></li>
<li class="chapter" data-level="10.4" data-path="measurement-error.html"><a href="measurement-error.html#what-to-do-when-we-know-the-error"><i class="fa fa-check"></i><b>10.4</b> What to do when we know the error?</a></li>
<li class="chapter" data-level="10.5" data-path="measurement-error.html"><a href="measurement-error.html#extending-the-classical-test-theory"><i class="fa fa-check"></i><b>10.5</b> Extending the Classical Test Theory</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>11</b> Conclusion</a></li>
<li class="part"><span><b>II Part Two</b></span></li>
<li class="chapter" data-level="12" data-path="bmbstats-bootstrap-magnitude-based-statistics-package.html"><a href="bmbstats-bootstrap-magnitude-based-statistics-package.html"><i class="fa fa-check"></i><b>12</b> <code>bmbstats</code>: Bootstrap Magnitude-based Statistics package</a>
<ul>
<li class="chapter" data-level="12.1" data-path="bmbstats-bootstrap-magnitude-based-statistics-package.html"><a href="bmbstats-bootstrap-magnitude-based-statistics-package.html#installation"><i class="fa fa-check"></i><b>12.1</b> Installation</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html"><i class="fa fa-check"></i><b>13</b> Descriptive tasks using <code>bmbstats</code></a>
<ul>
<li class="chapter" data-level="13.1" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html#generating-height-data"><i class="fa fa-check"></i><b>13.1</b> Generating <em>height data</em></a></li>
<li class="chapter" data-level="13.2" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html#visualization-and-analysis-of-a-single-groupvariable"><i class="fa fa-check"></i><b>13.2</b> Visualization and analysis of a single group/variable</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html#using-your-own-estimators"><i class="fa fa-check"></i><b>13.2.1</b> Using your own estimators</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html#visualization-and-analysis-of-the-two-independent-groups"><i class="fa fa-check"></i><b>13.3</b> Visualization and analysis of the two independent groups</a></li>
<li class="chapter" data-level="13.4" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html#nhst-mets-and-mbi-functions"><i class="fa fa-check"></i><b>13.4</b> NHST, METs and MBI functions</a></li>
<li class="chapter" data-level="13.5" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html#comparing-two-dependent-groups"><i class="fa fa-check"></i><b>13.5</b> Comparing two dependent groups</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html#measurement-error-issues"><i class="fa fa-check"></i><b>13.5.1</b> Measurement error issues</a></li>
<li class="chapter" data-level="13.5.2" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html#analysis-of-the-dependent-groups-using-bmbstatscompare_dependent_groups"><i class="fa fa-check"></i><b>13.5.2</b> Analysis of the dependent groups using <code>bmbstats::compare_dependent_groups</code></a></li>
<li class="chapter" data-level="13.5.3" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html#statistical-tests"><i class="fa fa-check"></i><b>13.5.3</b> Statistical tests</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html#describing-relationship-between-two-groups"><i class="fa fa-check"></i><b>13.6</b> Describing relationship between two groups</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="predictive-tasks-using-bmbstats.html"><a href="predictive-tasks-using-bmbstats.html"><i class="fa fa-check"></i><b>14</b> Predictive tasks using <code>bmbstats</code></a>
<ul>
<li class="chapter" data-level="14.1" data-path="predictive-tasks-using-bmbstats.html"><a href="predictive-tasks-using-bmbstats.html#how-to-implement-different-performance-metrics"><i class="fa fa-check"></i><b>14.1</b> How to implement different performance metrics?</a></li>
<li class="chapter" data-level="14.2" data-path="predictive-tasks-using-bmbstats.html"><a href="predictive-tasks-using-bmbstats.html#how-to-use-different-prediction-model"><i class="fa fa-check"></i><b>14.2</b> How to use different prediction model?</a></li>
<li class="chapter" data-level="14.3" data-path="predictive-tasks-using-bmbstats.html"><a href="predictive-tasks-using-bmbstats.html#example-of-using-tuning-parameter"><i class="fa fa-check"></i><b>14.3</b> Example of using tuning parameter</a></li>
<li class="chapter" data-level="14.4" data-path="predictive-tasks-using-bmbstats.html"><a href="predictive-tasks-using-bmbstats.html#plotting"><i class="fa fa-check"></i><b>14.4</b> Plotting</a></li>
<li class="chapter" data-level="14.5" data-path="predictive-tasks-using-bmbstats.html"><a href="predictive-tasks-using-bmbstats.html#comparing-models"><i class="fa fa-check"></i><b>14.5</b> Comparing models</a></li>
<li class="chapter" data-level="14.6" data-path="predictive-tasks-using-bmbstats.html"><a href="predictive-tasks-using-bmbstats.html#bootstrapping-model"><i class="fa fa-check"></i><b>14.6</b> Bootstrapping model</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html"><i class="fa fa-check"></i><b>15</b> Validity and Reliability</a>
<ul>
<li class="chapter" data-level="15.1" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#data-generation"><i class="fa fa-check"></i><b>15.1</b> Data generation</a></li>
<li class="chapter" data-level="15.2" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#validity"><i class="fa fa-check"></i><b>15.2</b> Validity</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#true-vs-criterion"><i class="fa fa-check"></i><b>15.2.1</b> True vs Criterion</a></li>
<li class="chapter" data-level="15.2.2" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#practical-vs-criterion"><i class="fa fa-check"></i><b>15.2.2</b> Practical vs Criterion</a></li>
<li class="chapter" data-level="15.2.3" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#prediction-approach"><i class="fa fa-check"></i><b>15.2.3</b> Prediction approach</a></li>
<li class="chapter" data-level="15.2.4" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#can-we-adjust-for-the-know-criterion-measure-random-error"><i class="fa fa-check"></i><b>15.2.4</b> Can we adjust for the know criterion measure random error?</a></li>
<li class="chapter" data-level="15.2.5" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#estimating-sesoi-for-the-practical-score"><i class="fa fa-check"></i><b>15.2.5</b> Estimating SESOI for the practical score</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#reliability"><i class="fa fa-check"></i><b>15.3</b> Reliability</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#reproducibility"><i class="fa fa-check"></i><b>15.3.1</b> Reproducibility</a></li>
<li class="chapter" data-level="15.3.2" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#repeatability"><i class="fa fa-check"></i><b>15.3.2</b> Repeatability</a></li>
<li class="chapter" data-level="15.3.3" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#the-difference-between-reproducibility-and-repeatability"><i class="fa fa-check"></i><b>15.3.3</b> The difference between Reproducibility and Repeatability</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="rct-analysis-and-prediction-in-bmbstats.html"><a href="rct-analysis-and-prediction-in-bmbstats.html"><i class="fa fa-check"></i><b>16</b> RCT analysis and prediction in <code>bmbstats</code></a>
<ul>
<li class="chapter" data-level="16.1" data-path="rct-analysis-and-prediction-in-bmbstats.html"><a href="rct-analysis-and-prediction-in-bmbstats.html#data-generating-process-behind-rct"><i class="fa fa-check"></i><b>16.1</b> Data Generating Process behind RCT</a></li>
<li class="chapter" data-level="16.2" data-path="rct-analysis-and-prediction-in-bmbstats.html"><a href="rct-analysis-and-prediction-in-bmbstats.html#rct-analysis-using-bmbstatsrct_analysis-function"><i class="fa fa-check"></i><b>16.2</b> RCT analysis using <code>bmbstats::RCT_analysis</code> function</a></li>
<li class="chapter" data-level="16.3" data-path="rct-analysis-and-prediction-in-bmbstats.html"><a href="rct-analysis-and-prediction-in-bmbstats.html#linear-regression-perspective"><i class="fa fa-check"></i><b>16.3</b> Linear Regression Perspective</a></li>
<li class="chapter" data-level="16.4" data-path="rct-analysis-and-prediction-in-bmbstats.html"><a href="rct-analysis-and-prediction-in-bmbstats.html#prediction-perspective-1"><i class="fa fa-check"></i><b>16.4</b> Prediction perspective 1</a></li>
<li class="chapter" data-level="16.5" data-path="rct-analysis-and-prediction-in-bmbstats.html"><a href="rct-analysis-and-prediction-in-bmbstats.html#adding-some-effects"><i class="fa fa-check"></i><b>16.5</b> Adding some effects</a></li>
<li class="chapter" data-level="16.6" data-path="rct-analysis-and-prediction-in-bmbstats.html"><a href="rct-analysis-and-prediction-in-bmbstats.html#what-goes-inside-the-measurement-error-or-control-group-change-or-residuals-sd"><i class="fa fa-check"></i><b>16.6</b> What goes inside the <em>measurement error</em> (or Control group change or residuals <code>SD</code>)?</a></li>
<li class="chapter" data-level="16.7" data-path="rct-analysis-and-prediction-in-bmbstats.html"><a href="rct-analysis-and-prediction-in-bmbstats.html#prediction-perspective-2"><i class="fa fa-check"></i><b>16.7</b> Prediction perspective 2</a></li>
<li class="chapter" data-level="16.8" data-path="rct-analysis-and-prediction-in-bmbstats.html"><a href="rct-analysis-and-prediction-in-bmbstats.html#making-it-more-complex-by-adding-covariate"><i class="fa fa-check"></i><b>16.8</b> Making it more complex by adding covariate</a></li>
</ul></li>
<li><a href="appendix-a-dorem-package.html#appendix-a-dorem-package">Appendix A: <code>dorem</code> package</a></li>
<li><a href="appendix-b-shorts-package.html#appendix-b-shorts-package">Appendix B: <code>shorts</code> package</a></li>
<li class="chapter" data-level="" data-path="appendix-c-recommended-material.html"><a href="appendix-c-recommended-material.html"><i class="fa fa-check"></i>Appendix C: Recommended material</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">bmbstats: bootstrap magnitude-based statistics for sports scientists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rct-analysis-and-prediction-in-bmbstats" class="section level1" number="16">
<h1><span class="header-section-number">Chapter 16</span> RCT analysis and prediction in <code>bmbstats</code></h1>
<p>In this chapter I will demonstrate how to analyze simple randomized controlled trials (RCTs) from both explanatory and predictive perspectives using <code>bmbstats</code> package and functions. As a refresher, please consider re-reading <a href="causal-inference.html#causal-inference">Causal inference</a> chapter.</p>
<div id="data-generating-process-behind-rct" class="section level2" number="16.1">
<h2><span class="header-section-number">16.1</span> Data Generating Process behind RCT</h2>
<p>The following image is re-posted from the <a href="causal-inference.html#causal-inference">Causal inference</a> chapter, outlining Treatment and Non-Treatment effects.</p>
<p><img src="figures/treatment-and-non-treatment-effects.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Let’s consider the following RCT DGP. We have two group (Control and Treatment), each with N=10 athletes, measured twice (Pre-test and Post-test) on the vertical jump height, using a measuring device with a known measurement error (i.e. only instrumentation noise; see <a href="validity-and-reliability.html#validity-and-reliability">Validity and Reliability</a> chapter for more info) estimated through validity and reliability studies and equal to 0.5cm. Control group are doing their normal training for 4 weeks, while Treatment group is doing EMS stimulation of their calf muscles on top of their normal training.</p>
<p>Since this is DGP, we will assume there is no treatment effect nor non-treatment effects. Both Control and Treatment groups will experience normal biological variation in their jump height, which is equal to 1.5cm. Please refer to <a href="validity-and-reliability.html#validity-and-reliability">Validity and Reliability</a> chapter for more info about the concepts of true score and measurement error. SESOI for the measured score will be ±5cm (since there is no proportional bias in the measurement, this will also be SESOI for the true score - see <a href="validity-and-reliability.html#validity-and-reliability">Validity and Reliability</a> chapter for more information).</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-1"></a><span class="kw">require</span>(tidyverse)</span>
<span id="cb181-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-2"></a><span class="kw">require</span>(bmbstats)</span>
<span id="cb181-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-3"></a><span class="kw">require</span>(cowplot)</span>
<span id="cb181-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-4"></a></span>
<span id="cb181-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-5"></a><span class="kw">set.seed</span>(<span class="dv">1667</span>)</span>
<span id="cb181-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-6"></a></span>
<span id="cb181-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-7"></a>n_subjects &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb181-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-8"></a></span>
<span id="cb181-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-9"></a></span>
<span id="cb181-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-10"></a>instrumentation_noise &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb181-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-11"></a>biological_variation &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb181-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-12"></a></span>
<span id="cb181-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-13"></a><span class="co"># -------------------------</span></span>
<span id="cb181-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-14"></a><span class="co"># Treatment effect</span></span>
<span id="cb181-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-15"></a>treatment_systematic &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb181-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-16"></a>treatment_random &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb181-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-17"></a></span>
<span id="cb181-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-18"></a><span class="co"># Non-treatment effect</span></span>
<span id="cb181-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-19"></a>non_treatment_systematic &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb181-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-20"></a>non_treatment_random &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb181-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-21"></a><span class="co">#-------------------------</span></span>
<span id="cb181-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-22"></a></span>
<span id="cb181-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-23"></a>RCT_data &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb181-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-24"></a>  <span class="dt">Athlete =</span> <span class="kw">paste</span>(</span>
<span id="cb181-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-25"></a>    <span class="st">&quot;Athlete&quot;</span>,</span>
<span id="cb181-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-26"></a>    <span class="kw">str_pad</span>(</span>
<span id="cb181-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-27"></a>      <span class="dt">string =</span> <span class="kw">seq</span>(<span class="dv">1</span>, n_subjects),</span>
<span id="cb181-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-28"></a>      <span class="dt">width =</span> <span class="dv">2</span>,</span>
<span id="cb181-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-29"></a>      <span class="dt">pad =</span> <span class="st">&quot;0&quot;</span></span>
<span id="cb181-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-30"></a>    )</span>
<span id="cb181-31"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-31"></a>  ),</span>
<span id="cb181-32"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-32"></a>  <span class="dt">Group =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Treatment&quot;</span>, <span class="st">&quot;Control&quot;</span>), <span class="dt">length.out =</span> n_subjects),</span>
<span id="cb181-33"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-33"></a></span>
<span id="cb181-34"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-34"></a>  <span class="co"># True score</span></span>
<span id="cb181-35"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-35"></a>  <span class="dt">True_score.Pre =</span> <span class="kw">rnorm</span>(n_subjects, <span class="dv">45</span>, <span class="dv">5</span>),</span>
<span id="cb181-36"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-36"></a></span>
<span id="cb181-37"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-37"></a>  <span class="co"># Treatment effect</span></span>
<span id="cb181-38"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-38"></a>  <span class="dt">Treatment_effect =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> n_subjects, <span class="dt">mean =</span> treatment_systematic, <span class="dt">sd =</span> treatment_random),</span>
<span id="cb181-39"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-39"></a>  <span class="dt">Non_treatment_effect =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> n_subjects, <span class="dt">mean =</span> non_treatment_systematic, <span class="dt">sd =</span> non_treatment_random),</span>
<span id="cb181-40"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-40"></a></span>
<span id="cb181-41"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-41"></a>  <span class="co"># Calculate the change in true score</span></span>
<span id="cb181-42"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-42"></a>  <span class="dt">True_score.Change =</span> <span class="kw">if_else</span>(</span>
<span id="cb181-43"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-43"></a>    Group <span class="op">==</span><span class="st"> &quot;Treatment&quot;</span>,</span>
<span id="cb181-44"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-44"></a>    <span class="co"># Treatment group is a sum of treatment and non-treatment effects</span></span>
<span id="cb181-45"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-45"></a>    Treatment_effect <span class="op">+</span><span class="st"> </span>Non_treatment_effect,</span>
<span id="cb181-46"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-46"></a>    <span class="co"># While control group only get non-treatment effects</span></span>
<span id="cb181-47"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-47"></a>    Non_treatment_effect</span>
<span id="cb181-48"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-48"></a>  ),</span>
<span id="cb181-49"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-49"></a>  <span class="dt">True_score.Post =</span> True_score.Pre <span class="op">+</span><span class="st"> </span>True_score.Change,</span>
<span id="cb181-50"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-50"></a></span>
<span id="cb181-51"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-51"></a>  <span class="co"># Manifested score</span></span>
<span id="cb181-52"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-52"></a>  <span class="dt">Manifested_score.Pre =</span> True_score.Pre <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, biological_variation),</span>
<span id="cb181-53"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-53"></a>  <span class="dt">Manifested_score.Post =</span> True_score.Post <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, biological_variation),</span>
<span id="cb181-54"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-54"></a>  <span class="dt">Manifested_score.Change =</span> Manifested_score.Post <span class="op">-</span><span class="st"> </span>Manifested_score.Pre,</span>
<span id="cb181-55"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-55"></a></span>
<span id="cb181-56"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-56"></a>  <span class="co"># Measured score</span></span>
<span id="cb181-57"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-57"></a>  <span class="dt">Measured_score.Pre =</span> Manifested_score.Pre <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, instrumentation_noise),</span>
<span id="cb181-58"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-58"></a>  <span class="dt">Measured_score.Post =</span> Manifested_score.Post <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, instrumentation_noise),</span>
<span id="cb181-59"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-59"></a>  <span class="dt">Measured_score.Change =</span> Measured_score.Post <span class="op">-</span><span class="st"> </span>Measured_score.Pre</span>
<span id="cb181-60"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-60"></a>)</span>
<span id="cb181-61"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-61"></a></span>
<span id="cb181-62"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-62"></a><span class="co"># Make sure that the Group column is a factor</span></span>
<span id="cb181-63"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-63"></a><span class="co"># This will not create issues with PDP+ICE and ICE plotting later</span></span>
<span id="cb181-64"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-64"></a>RCT_data<span class="op">$</span>Group &lt;-<span class="st"> </span><span class="kw">factor</span>(RCT_data<span class="op">$</span>Group)</span>
<span id="cb181-65"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-65"></a></span>
<span id="cb181-66"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-66"></a><span class="kw">head</span>(RCT_data)</span>
<span id="cb181-67"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-67"></a><span class="co">#&gt; # A tibble: 6 x 13</span></span>
<span id="cb181-68"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-68"></a><span class="co">#&gt;   Athlete Group True_score.Pre Treatment_effect Non_treatment_e…</span></span>
<span id="cb181-69"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-69"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;fct&gt;          &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb181-70"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-70"></a><span class="co">#&gt; 1 Athlet… Trea…           52.9                0                0</span></span>
<span id="cb181-71"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-71"></a><span class="co">#&gt; 2 Athlet… Cont…           42.4                0                0</span></span>
<span id="cb181-72"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-72"></a><span class="co">#&gt; 3 Athlet… Trea…           49.2                0                0</span></span>
<span id="cb181-73"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-73"></a><span class="co">#&gt; 4 Athlet… Cont…           44.8                0                0</span></span>
<span id="cb181-74"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-74"></a><span class="co">#&gt; 5 Athlet… Trea…           40.0                0                0</span></span>
<span id="cb181-75"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-75"></a><span class="co">#&gt; 6 Athlet… Cont…           42.6                0                0</span></span>
<span id="cb181-76"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-76"></a><span class="co">#&gt; # … with 8 more variables: True_score.Change &lt;dbl&gt;, True_score.Post &lt;dbl&gt;,</span></span>
<span id="cb181-77"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-77"></a><span class="co">#&gt; #   Manifested_score.Pre &lt;dbl&gt;, Manifested_score.Post &lt;dbl&gt;,</span></span>
<span id="cb181-78"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-78"></a><span class="co">#&gt; #   Manifested_score.Change &lt;dbl&gt;, Measured_score.Pre &lt;dbl&gt;,</span></span>
<span id="cb181-79"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb181-79"></a><span class="co">#&gt; #   Measured_score.Post &lt;dbl&gt;, Measured_score.Change &lt;dbl&gt;</span></span></code></pre></div>
<p>Since we have generated this data, we know that there are no treatment nor non-treatment effects (neither systematic, nor random or variable effects). But let’s plot the data.</p>
<p>First let’s plot the Pre-test measured scores (vertical jump) distribution:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb182-1"></a>bmbstats<span class="op">::</span><span class="kw">plot_raincloud</span>(</span>
<span id="cb182-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb182-2"></a>  RCT_data,</span>
<span id="cb182-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb182-3"></a>  <span class="dt">value =</span> <span class="st">&quot;Measured_score.Pre&quot;</span>,</span>
<span id="cb182-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb182-4"></a>  <span class="dt">groups =</span> <span class="st">&quot;Group&quot;</span></span>
<span id="cb182-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb182-5"></a>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-4-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>And the Post-test:</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb183-1"></a>bmbstats<span class="op">::</span><span class="kw">plot_raincloud</span>(</span>
<span id="cb183-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb183-2"></a>  RCT_data,</span>
<span id="cb183-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb183-3"></a>  <span class="dt">value =</span> <span class="st">&quot;Measured_score.Post&quot;</span>,</span>
<span id="cb183-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb183-4"></a>  <span class="dt">groups =</span> <span class="st">&quot;Group&quot;</span></span>
<span id="cb183-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb183-5"></a>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-5-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>And finally measured change scores:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb184-1"></a>bmbstats<span class="op">::</span><span class="kw">plot_raincloud_SESOI</span>(</span>
<span id="cb184-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb184-2"></a>  RCT_data,</span>
<span id="cb184-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb184-3"></a>  <span class="dt">value =</span> <span class="st">&quot;Measured_score.Change&quot;</span>,</span>
<span id="cb184-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb184-4"></a>  <span class="dt">groups =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb184-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb184-5"></a>  <span class="dt">SESOI_lower =</span> <span class="dv">-5</span>,</span>
<span id="cb184-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb184-6"></a>  <span class="dt">SESOI_upper =</span> <span class="dv">5</span></span>
<span id="cb184-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb184-7"></a>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>From these graphs we can see that there is no difference between group. We have also selected large SESOI taking into account our <em>a priori</em> knowledge about biological variation and measurement error in the vertical jump height.</p>
<p>Let’s plot the individual change fro athletes from the Treatment group:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb185-1"></a>bmbstats<span class="op">::</span><span class="kw">plot_pair_changes</span>(</span>
<span id="cb185-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb185-2"></a>  <span class="dt">group_a =</span> RCT_data<span class="op">$</span>Measured_score.Pre,</span>
<span id="cb185-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb185-3"></a>  <span class="dt">group_b =</span> RCT_data<span class="op">$</span>Measured_score.Post,</span>
<span id="cb185-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb185-4"></a>  <span class="dt">group_a_label =</span> <span class="st">&quot;Measured Pre-test&quot;</span>,</span>
<span id="cb185-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb185-5"></a>  <span class="dt">group_b_label =</span> <span class="st">&quot;Measured Post-test&quot;</span>,</span>
<span id="cb185-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb185-6"></a>  <span class="dt">SESOI_lower =</span> <span class="dv">-5</span>,</span>
<span id="cb185-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb185-7"></a>  <span class="dt">SESOI_upper =</span> <span class="dv">5</span></span>
<span id="cb185-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb185-8"></a>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-7-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="rct-analysis-using-bmbstatsrct_analysis-function" class="section level2" number="16.2">
<h2><span class="header-section-number">16.2</span> RCT analysis using <code>bmbstats::RCT_analysis</code> function</h2>
<p>To perform RCT analysis explained in the <a href="causal-inference.html#causal-inference">Causal inference</a> chapter, we will use <code>bmbstats::RCT_analysis</code> function. <code>bmbstats::RCT_analysis</code> function has three built-in estimator function: <code>bmbstats::RCT_estimators</code>, <code>bmbstats::RCT_estimators_simple</code>, and <code>bmbstats::RCT_estimators_lm</code>. <code>bmbstats::RCT_estimators</code> is more extensive and involves individual group analysis, while the <code>bmbstats::RCT_estimators_simple</code> only provides estimated treatment and non-treatment effects. <code>bmbstats::RCT_estimators_lm</code> will be explained in the next section.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-1"></a>extensive_RCT &lt;-<span class="st"> </span>bmbstats<span class="op">::</span><span class="kw">RCT_analysis</span>(</span>
<span id="cb186-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-2"></a>  <span class="dt">data =</span> RCT_data,</span>
<span id="cb186-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-3"></a>  <span class="dt">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb186-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-4"></a>  <span class="dt">treatment_label =</span> <span class="st">&quot;Treatment&quot;</span>,</span>
<span id="cb186-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-5"></a>  <span class="dt">control_label =</span> <span class="st">&quot;Control&quot;</span>,</span>
<span id="cb186-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-6"></a>  <span class="dt">pre_test =</span> <span class="st">&quot;Measured_score.Pre&quot;</span>,</span>
<span id="cb186-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-7"></a>  <span class="dt">post_test =</span> <span class="st">&quot;Measured_score.Post&quot;</span>,</span>
<span id="cb186-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-8"></a>  <span class="dt">SESOI_lower =</span> <span class="dv">-5</span>,</span>
<span id="cb186-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-9"></a>  <span class="dt">SESOI_upper =</span> <span class="dv">5</span>,</span>
<span id="cb186-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-10"></a>  <span class="dt">control =</span> <span class="kw">model_control</span>(<span class="dt">seed =</span> <span class="dv">1667</span>)</span>
<span id="cb186-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-11"></a>)</span>
<span id="cb186-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-12"></a><span class="co">#&gt; [1] &quot;All values of t are equal to  5 \n Cannot calculate confidence intervals&quot;</span></span>
<span id="cb186-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-13"></a><span class="co">#&gt; [1] &quot;All values of t are equal to  10 \n Cannot calculate confidence intervals&quot;</span></span>
<span id="cb186-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-14"></a></span>
<span id="cb186-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-15"></a></span>
<span id="cb186-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-16"></a>extensive_RCT</span>
<span id="cb186-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-17"></a><span class="co">#&gt; Bootstrap with 2000 resamples and 95% bca confidence intervals.</span></span>
<span id="cb186-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-18"></a><span class="co">#&gt; </span></span>
<span id="cb186-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-19"></a><span class="co">#&gt;                           estimator         value         lower        upper</span></span>
<span id="cb186-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-20"></a><span class="co">#&gt;                         SESOI lower -5.0000000000            NA           NA</span></span>
<span id="cb186-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-21"></a><span class="co">#&gt;                         SESOI upper  5.0000000000            NA           NA</span></span>
<span id="cb186-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-22"></a><span class="co">#&gt;                         SESOI range 10.0000000000            NA           NA</span></span>
<span id="cb186-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-23"></a><span class="co">#&gt;         Control Group Pre-test mean 45.5109521606  4.338522e+01  47.99500924</span></span>
<span id="cb186-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-24"></a><span class="co">#&gt;           Control Group Pre-test SD  3.9597464864  2.821249e+00   5.39401519</span></span>
<span id="cb186-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-25"></a><span class="co">#&gt;        Control Group Post-test mean 45.1257775214  4.327530e+01  47.33738237</span></span>
<span id="cb186-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-26"></a><span class="co">#&gt;          Control Group Post-test SD  3.5092078780  2.612392e+00   4.59657735</span></span>
<span id="cb186-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-27"></a><span class="co">#&gt;       Treatment Group Pre-test mean 42.6896373231  3.878113e+01  46.84572579</span></span>
<span id="cb186-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-28"></a><span class="co">#&gt;         Treatment Group Pre-test SD  6.7766398945  4.783839e+00   8.92052081</span></span>
<span id="cb186-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-29"></a><span class="co">#&gt;      Treatment Group Post-test mean 42.3426726375  3.856045e+01  46.63546378</span></span>
<span id="cb186-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-30"></a><span class="co">#&gt;        Treatment Group Post-test SD  6.8172485979  4.880090e+00   8.96710016</span></span>
<span id="cb186-31"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-31"></a><span class="co">#&gt;                  Pre-test pooled SD  5.5498847059  4.348937e+00   7.08556923</span></span>
<span id="cb186-32"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-32"></a><span class="co">#&gt;           Pre-test Group difference -2.8213148375 -7.362312e+00   1.66624873</span></span>
<span id="cb186-33"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-33"></a><span class="co">#&gt;          Post-test Group difference -2.7831048839 -7.151974e+00   1.84048180</span></span>
<span id="cb186-34"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-34"></a><span class="co">#&gt;           Control Group Change mean -0.3851746392 -1.301390e+00   0.35428624</span></span>
<span id="cb186-35"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-35"></a><span class="co">#&gt;             Control Group Change SD  1.4244343846  9.592800e-01   2.04852176</span></span>
<span id="cb186-36"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-36"></a><span class="co">#&gt;             Control Group Cohen&#39;s d -0.0694022776 -2.627647e-01   0.08120665</span></span>
<span id="cb186-37"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-37"></a><span class="co">#&gt;       Control Group Change to SESOI -0.0385174639 -1.301390e-01   0.03542862</span></span>
<span id="cb186-38"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-38"></a><span class="co">#&gt;    Control Group Change SD to SESOI  0.1424434385  9.592800e-02   0.20485218</span></span>
<span id="cb186-39"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-39"></a><span class="co">#&gt;                Control Group pLower  0.0050812820  3.123715e-04   0.04282747</span></span>
<span id="cb186-40"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-40"></a><span class="co">#&gt;           Control Group pEquivalent  0.9927461183  9.564951e-01   0.99950198</span></span>
<span id="cb186-41"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-41"></a><span class="co">#&gt;               Control Group pHigher  0.0021725997  2.037526e-04   0.01324039</span></span>
<span id="cb186-42"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-42"></a><span class="co">#&gt;         Treatment Group Change mean -0.3469646855 -1.363329e+00   0.72633527</span></span>
<span id="cb186-43"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-43"></a><span class="co">#&gt;           Treatment Group Change SD  1.7452275994  1.230571e+00   2.23150783</span></span>
<span id="cb186-44"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-44"></a><span class="co">#&gt;           Treatment Group Cohen&#39;s d -0.0625174583 -2.845506e-01   0.16106127</span></span>
<span id="cb186-45"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-45"></a><span class="co">#&gt;     Treatment Group Change to SESOI -0.0346964686 -1.363329e-01   0.07263353</span></span>
<span id="cb186-46"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-46"></a><span class="co">#&gt;  Treatment Group Change SD to SESOI  0.1745227599  1.230571e-01   0.22315078</span></span>
<span id="cb186-47"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-47"></a><span class="co">#&gt;              Treatment Group pLower  0.0128923459  1.224420e-03   0.03986666</span></span>
<span id="cb186-48"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-48"></a><span class="co">#&gt;         Treatment Group pEquivalent  0.9803630085  9.469588e-01   0.99789556</span></span>
<span id="cb186-49"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-49"></a><span class="co">#&gt;             Treatment Group pHigher  0.0067446456  6.592220e-04   0.03469121</span></span>
<span id="cb186-50"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-50"></a><span class="co">#&gt;                    Effect Cohen&#39;s d  0.0268246499 -1.142476e+00   1.10911957</span></span>
<span id="cb186-51"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-51"></a><span class="co">#&gt;                   Systematic effect  0.0382099536 -1.239017e+00   1.40527411</span></span>
<span id="cb186-52"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-52"></a><span class="co">#&gt;                       Random effect  1.0083680171 -1.142340e+00   1.85676617</span></span>
<span id="cb186-53"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-53"></a><span class="co">#&gt;          Systematic effect to SESOI  0.0038209954 -1.239017e-01   0.14052741</span></span>
<span id="cb186-54"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-54"></a><span class="co">#&gt;              SESOI to Random effect  9.9170142553 -1.104973e+01 149.46811634</span></span>
<span id="cb186-55"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-55"></a><span class="co">#&gt;                              pLower  0.0003713043  1.345150e-12   0.99988780</span></span>
<span id="cb186-56"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-56"></a><span class="co">#&gt;                         pEquivalent  0.9992167407 -9.960108e-01   1.00000000</span></span>
<span id="cb186-57"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb186-57"></a><span class="co">#&gt;                             pHigher  0.0004119550  1.014997e-12   0.99983149</span></span></code></pre></div>
<p>We can also plot the estimators bootstrap distributions:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb187-1"></a><span class="kw">plot</span>(extensive_RCT)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-9-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>If we use <code>bmbstats::RCT_estimators_simple</code>, we will get much more condensed output:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-1"></a>simple_RCT &lt;-<span class="st"> </span>bmbstats<span class="op">::</span><span class="kw">RCT_analysis</span>(</span>
<span id="cb188-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-2"></a>  <span class="dt">data =</span> RCT_data,</span>
<span id="cb188-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-3"></a>  <span class="dt">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb188-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-4"></a>  <span class="dt">treatment_label =</span> <span class="st">&quot;Treatment&quot;</span>,</span>
<span id="cb188-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-5"></a>  <span class="dt">control_label =</span> <span class="st">&quot;Control&quot;</span>,</span>
<span id="cb188-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-6"></a>  <span class="dt">pre_test =</span> <span class="st">&quot;Measured_score.Pre&quot;</span>,</span>
<span id="cb188-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-7"></a>  <span class="dt">post_test =</span> <span class="st">&quot;Measured_score.Post&quot;</span>,</span>
<span id="cb188-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-8"></a>  <span class="dt">SESOI_lower =</span> <span class="dv">-5</span>,</span>
<span id="cb188-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-9"></a>  <span class="dt">SESOI_upper =</span> <span class="dv">5</span>,</span>
<span id="cb188-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-10"></a>  <span class="dt">estimator_function =</span> bmbstats<span class="op">::</span>RCT_estimators_simple,</span>
<span id="cb188-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-11"></a>  <span class="dt">control =</span> <span class="kw">model_control</span>(<span class="dt">seed =</span> <span class="dv">1667</span>)</span>
<span id="cb188-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-12"></a>)</span>
<span id="cb188-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-13"></a><span class="co">#&gt; [1] &quot;All values of t are equal to  5 \n Cannot calculate confidence intervals&quot;</span></span>
<span id="cb188-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-14"></a><span class="co">#&gt; [1] &quot;All values of t are equal to  10 \n Cannot calculate confidence intervals&quot;</span></span>
<span id="cb188-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-15"></a></span>
<span id="cb188-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-16"></a></span>
<span id="cb188-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-17"></a>simple_RCT</span>
<span id="cb188-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-18"></a><span class="co">#&gt; Bootstrap with 2000 resamples and 95% bca confidence intervals.</span></span>
<span id="cb188-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-19"></a><span class="co">#&gt; </span></span>
<span id="cb188-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-20"></a><span class="co">#&gt;                   estimator         value         lower       upper</span></span>
<span id="cb188-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-21"></a><span class="co">#&gt;                 SESOI lower -5.0000000000            NA          NA</span></span>
<span id="cb188-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-22"></a><span class="co">#&gt;                 SESOI upper  5.0000000000            NA          NA</span></span>
<span id="cb188-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-23"></a><span class="co">#&gt;                 SESOI range 10.0000000000            NA          NA</span></span>
<span id="cb188-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-24"></a><span class="co">#&gt;           Systematic effect  0.0382099536 -1.239017e+00   1.4052741</span></span>
<span id="cb188-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-25"></a><span class="co">#&gt;               Random effect  1.0083680171 -1.142340e+00   1.8567662</span></span>
<span id="cb188-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-26"></a><span class="co">#&gt;  Systematic effect to SESOI  0.0038209954 -1.239017e-01   0.1405274</span></span>
<span id="cb188-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-27"></a><span class="co">#&gt;      SESOI to Random effect  9.9170142553 -1.104973e+01 149.4681163</span></span>
<span id="cb188-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-28"></a><span class="co">#&gt;                      pLower  0.0003713043  1.345150e-12   0.9998878</span></span>
<span id="cb188-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-29"></a><span class="co">#&gt;                 pEquivalent  0.9992167407 -9.960108e-01   1.0000000</span></span>
<span id="cb188-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb188-30"></a><span class="co">#&gt;                     pHigher  0.0004119550  1.014997e-12   0.9998315</span></span></code></pre></div>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb189-1"></a><span class="kw">plot</span>(simple_RCT)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-11-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>As can be seen, the analysis correctly identified no treatment effect. There is an issue with random treatment effects estimation since is demonstrates distribution with two peaks. This effect is due to random treatment effect being zero and the way the root of the squared differences is calculated to avoid irrational numbers (i.e. taking root of negative number).</p>
<p>There are additional graphs that can be produced. All graphs can take <code>control = plot_control</code> parameter to setup plotting options as explained in the previous chapters.</p>
<p>Control group Pre- and Post-test distribution:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb190-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;control-pre-post&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-12-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Treatment group Pre- and Post-test distribution:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb191-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;treatment-pre-post&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-13-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Control change graph:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb192-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;control-change&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-14-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Treatment change graph:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb193-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;treatment-change&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-15-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Change graph:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb194-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;change&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-16-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Individual changes in the Control group:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb195-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;control-paired-change&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-17-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Individual changes in the Treatment group:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb196-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;treatment-paired-change&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-18-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Distribution of the change scores:</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb197-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;change-distribution&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-19-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Treatment effect distribution:</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb198-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;effect-distribution&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-20-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>And finally, adjusted treatment responses:</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb199-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;adjusted-treatment-responses&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-21-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>The adjusted treatment responses are calculated by deducting <code>mean</code> Control group change from individual change in the Treatment group (i.e. <em>adjusted change</em>). Error-bars represent 95% confidence intervals (i.e. <code>SDC</code>) using change <code>SD</code> of the Control group.</p>
<p>The data used to create this graph can be found in the returned object:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb200-1"></a><span class="kw">head</span>(simple_RCT<span class="op">$</span>extra<span class="op">$</span>treatment_responses)</span>
<span id="cb200-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb200-2"></a><span class="co">#&gt;    id     group pre_test post_test     change      SDC change_lower</span></span>
<span id="cb200-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb200-3"></a><span class="co">#&gt; 11  1 Treatment 52.87665  53.06613  0.1894841 3.222294   -3.0328104</span></span>
<span id="cb200-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb200-4"></a><span class="co">#&gt; 12  2 Treatment 48.86917  51.26538  2.3962116 3.222294   -0.8260828</span></span>
<span id="cb200-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb200-5"></a><span class="co">#&gt; 13  3 Treatment 41.83908  39.31947 -2.5196029 3.222294   -5.7418974</span></span>
<span id="cb200-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb200-6"></a><span class="co">#&gt; 14  4 Treatment 43.14467  40.80646 -2.3382079 3.222294   -5.5605023</span></span>
<span id="cb200-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb200-7"></a><span class="co">#&gt; 15  5 Treatment 32.93471  33.26669  0.3319806 3.222294   -2.8903138</span></span>
<span id="cb200-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb200-8"></a><span class="co">#&gt; 16  6 Treatment 34.17358  33.61544 -0.5581425 3.222294   -3.7804369</span></span>
<span id="cb200-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb200-9"></a><span class="co">#&gt;    change_upper adjusted_change adjusted_change_lower adjusted_change_upper</span></span>
<span id="cb200-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb200-10"></a><span class="co">#&gt; 11    3.4117785       0.5746587            -2.6476357              3.796953</span></span>
<span id="cb200-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb200-11"></a><span class="co">#&gt; 12    5.6185061       2.7813863            -0.4409082              6.003681</span></span>
<span id="cb200-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb200-12"></a><span class="co">#&gt; 13    0.7026915      -2.1344283            -5.3567227              1.087866</span></span>
<span id="cb200-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb200-13"></a><span class="co">#&gt; 14    0.8840866      -1.9530332            -5.1753277              1.269261</span></span>
<span id="cb200-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb200-14"></a><span class="co">#&gt; 15    3.5542751       0.7171553            -2.5051392              3.939450</span></span>
<span id="cb200-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb200-15"></a><span class="co">#&gt; 16    2.6641520      -0.1729678            -3.3952623              3.049327</span></span></code></pre></div>
<p>We can also plot the un-adjusted treatment responses:</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb201-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;treatment-responses&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-23-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Let’s re-create this graph using <code>bmbstats::observations_MET</code> function since that function also allows us to set Type I error rates and confidence for plotting.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-1"></a>treatment_group &lt;-<span class="st"> </span><span class="kw">filter</span>(</span>
<span id="cb202-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-2"></a>  RCT_data,</span>
<span id="cb202-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-3"></a>  Group <span class="op">==</span><span class="st"> &quot;Treatment&quot;</span></span>
<span id="cb202-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-4"></a>)</span>
<span id="cb202-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-5"></a></span>
<span id="cb202-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-6"></a>control_group &lt;-<span class="st"> </span><span class="kw">filter</span>(</span>
<span id="cb202-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-7"></a>  RCT_data,</span>
<span id="cb202-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-8"></a>  Group <span class="op">==</span><span class="st"> &quot;Control&quot;</span></span>
<span id="cb202-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-9"></a>)</span>
<span id="cb202-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-10"></a></span>
<span id="cb202-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-11"></a>treatment_responses &lt;-<span class="st"> </span>bmbstats<span class="op">::</span><span class="kw">observations_MET</span>(</span>
<span id="cb202-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-12"></a>  <span class="dt">observations =</span> treatment_group<span class="op">$</span>Measured_score.Change <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(control_group<span class="op">$</span>Measured_score.Change),</span>
<span id="cb202-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-13"></a>  <span class="dt">observations_label =</span> treatment_group<span class="op">$</span>Athlete,</span>
<span id="cb202-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-14"></a></span>
<span id="cb202-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-15"></a>  <span class="co"># Use control group change as measurement error</span></span>
<span id="cb202-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-16"></a>  <span class="dt">measurement_error =</span> <span class="kw">sd</span>(control_group<span class="op">$</span>Measured_score.Change),</span>
<span id="cb202-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-17"></a></span>
<span id="cb202-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-18"></a>  <span class="co"># Degrees of freedom from the reliability study. Use `Inf` for normal distribution</span></span>
<span id="cb202-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-19"></a>  <span class="dt">df =</span> <span class="kw">nrow</span>(control_group) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb202-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-20"></a>  <span class="dt">SESOI_lower =</span> <span class="dv">-5</span>,</span>
<span id="cb202-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-21"></a>  <span class="dt">SESOI_upper =</span> <span class="dv">5</span>,</span>
<span id="cb202-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-22"></a></span>
<span id="cb202-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-23"></a>  <span class="co"># Will not use Bonferroni adjustment here</span></span>
<span id="cb202-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-24"></a>  <span class="dt">alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb202-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-25"></a>  <span class="co"># No adjustment in CIs for plotting</span></span>
<span id="cb202-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-26"></a>  <span class="dt">confidence =</span> <span class="fl">0.95</span></span>
<span id="cb202-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-27"></a>)</span>
<span id="cb202-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-28"></a></span>
<span id="cb202-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-29"></a><span class="kw">plot</span>(</span>
<span id="cb202-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-30"></a>  treatment_responses,</span>
<span id="cb202-31"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-31"></a>  <span class="dt">true_observations =</span> treatment_group<span class="op">$</span>True_score.Change,</span>
<span id="cb202-32"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-32"></a>  <span class="dt">control =</span> <span class="kw">plot_control</span>(<span class="dt">points_size =</span> <span class="dv">5</span>)</span>
<span id="cb202-33"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-33"></a>) <span class="op">+</span></span>
<span id="cb202-34"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb202-34"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="op">-</span><span class="dv">9</span>, <span class="dv">9</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-24-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>This way, Control group is used as <em>sort-of</em> reliability study (see <a href="validity-and-reliability.html#repeatability">Repeatability</a> section in the <a href="validity-and-reliability.html#validity-and-reliability">Validity and Reliability</a> chapter) that provides source of information about the non-treatment effect (in this case 0 for both systematic and random components), biological variation and instrumentation noise. This helps us to provide uncertainty intervals around individual treatment (adjusted) effects.</p>
</div>
<div id="linear-regression-perspective" class="section level2" number="16.3">
<h2><span class="header-section-number">16.3</span> Linear Regression Perspective</h2>
<p>RCT analysis performed with <code>bmbstats::RCT_analysis</code> is the method of differences (i.e. changes). This is similar to the method of differences explained in the <a href="validity-and-reliability.html#validity-and-reliability">Validity and Reliability</a> chapter. Another approach is to utilize linear regression( explained in the <a href="causal-inference.html#prediction-as-a-complement-to-causal-inference">Prediction as a complement to causal inference</a> section of the <a href="causal-inference.html#causal-inference">Causal inference</a> chapter). To understand this, let’s depict this RCT data by using Group as predictor and Change score as outcome:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb203-1"></a><span class="kw">ggplot</span>(</span>
<span id="cb203-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb203-2"></a>  RCT_data,</span>
<span id="cb203-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb203-3"></a>  <span class="kw">aes</span>(<span class="dt">x =</span> Group, <span class="dt">y =</span> Measured_score.Change, <span class="dt">color =</span> Group)) <span class="op">+</span></span>
<span id="cb203-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb203-4"></a><span class="st">  </span><span class="kw">theme_cowplot</span>(<span class="dv">8</span>) <span class="op">+</span></span>
<span id="cb203-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb203-5"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb203-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb203-6"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">Treatment =</span> <span class="st">&quot;#FAA43A&quot;</span>, <span class="dt">Control =</span> <span class="st">&quot;#5DA5DA&quot;</span>))</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-25-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>If we perform the linear regression, we will get the following:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-1"></a>model1 &lt;-<span class="st"> </span><span class="kw">lm</span>(</span>
<span id="cb204-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-2"></a>  Measured_score.Change <span class="op">~</span><span class="st"> </span>Group,</span>
<span id="cb204-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-3"></a>  RCT_data</span>
<span id="cb204-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-4"></a>)</span>
<span id="cb204-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-5"></a></span>
<span id="cb204-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-6"></a><span class="kw">summary</span>(model1)</span>
<span id="cb204-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-7"></a><span class="co">#&gt; </span></span>
<span id="cb204-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-8"></a><span class="co">#&gt; Call:</span></span>
<span id="cb204-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-9"></a><span class="co">#&gt; lm(formula = Measured_score.Change ~ Group, data = RCT_data)</span></span>
<span id="cb204-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-10"></a><span class="co">#&gt; </span></span>
<span id="cb204-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-11"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb204-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-12"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb204-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-13"></a><span class="co">#&gt; -2.6559 -0.9517  0.2315  0.7391  2.7432 </span></span>
<span id="cb204-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-14"></a><span class="co">#&gt; </span></span>
<span id="cb204-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-15"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb204-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-16"></a><span class="co">#&gt;                Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span id="cb204-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-17"></a><span class="co">#&gt; (Intercept)    -0.38517    0.50373  -0.765    0.454</span></span>
<span id="cb204-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-18"></a><span class="co">#&gt; GroupTreatment  0.03821    0.71238   0.054    0.958</span></span>
<span id="cb204-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-19"></a><span class="co">#&gt; </span></span>
<span id="cb204-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-20"></a><span class="co">#&gt; Residual standard error: 1.593 on 18 degrees of freedom</span></span>
<span id="cb204-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-21"></a><span class="co">#&gt; Multiple R-squared:  0.0001598,  Adjusted R-squared:  -0.05539 </span></span>
<span id="cb204-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb204-22"></a><span class="co">#&gt; F-statistic: 0.002877 on 1 and 18 DF,  p-value: 0.9578</span></span></code></pre></div>
<p>Intercept in this case (-0.39cm) represents the <code>mean</code> change in the Control group, while slope (<code>GroupTreatment</code>; 0.04cm) represents estimate of the systematic treatment effect (i.e. difference in means).</p>
<p>This can be easily explained visually:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb205-1"></a>RCT_data<span class="op">$</span>Group_num &lt;-<span class="st"> </span><span class="kw">ifelse</span>(</span>
<span id="cb205-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb205-2"></a>  RCT_data<span class="op">$</span>Group <span class="op">==</span><span class="st"> &quot;Treatment&quot;</span>,</span>
<span id="cb205-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb205-3"></a>  <span class="dv">1</span>,</span>
<span id="cb205-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb205-4"></a>  <span class="dv">0</span></span>
<span id="cb205-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb205-5"></a>)</span>
<span id="cb205-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb205-6"></a></span>
<span id="cb205-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb205-7"></a><span class="kw">ggplot</span>(</span>
<span id="cb205-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb205-8"></a>  RCT_data,</span>
<span id="cb205-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb205-9"></a>  <span class="kw">aes</span>(<span class="dt">x =</span> Group_num, <span class="dt">y =</span> Measured_score.Change)) <span class="op">+</span></span>
<span id="cb205-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb205-10"></a><span class="st">  </span><span class="kw">theme_cowplot</span>(<span class="dv">8</span>) <span class="op">+</span></span>
<span id="cb205-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb205-11"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Group), <span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb205-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb205-12"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">formula =</span> y<span class="op">~</span>x, <span class="dt">se=</span><span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb205-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb205-13"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">Treatment =</span> <span class="st">&quot;#FAA43A&quot;</span>, <span class="dt">Control =</span> <span class="st">&quot;#5DA5DA&quot;</span>)) <span class="op">+</span></span>
<span id="cb205-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb205-14"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(</span>
<span id="cb205-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb205-15"></a>    <span class="dt">name =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb205-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb205-16"></a>    <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb205-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb205-17"></a>    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Treatment&quot;</span>))</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-27-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Random components of the treatment and non-treatment effects can be seen as <em>residuals</em> (actually as <code>SD</code> of the residuals) around <code>mean</code> of the group changes. <code>RSE</code> of this model (1.59cm) represents <em>pooled</em> random errors of both Treatment and Control groups. If we perform <code>SD</code> of the residuals for each Group, we will get the following:</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb206-1"></a>SD_summary &lt;-<span class="st"> </span>RCT_data <span class="op">%&gt;%</span></span>
<span id="cb206-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb206-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">.resid =</span> <span class="kw">residuals</span>(model1)) <span class="op">%&gt;%</span></span>
<span id="cb206-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb206-3"></a><span class="st">  </span><span class="kw">group_by</span>(Group) <span class="op">%&gt;%</span></span>
<span id="cb206-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb206-4"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="st">`</span><span class="dt">Residual SD</span><span class="st">`</span> =<span class="st"> </span><span class="kw">sd</span>(.resid))</span>
<span id="cb206-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb206-5"></a></span>
<span id="cb206-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb206-6"></a>SD_summary</span>
<span id="cb206-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb206-7"></a><span class="co">#&gt; # A tibble: 2 x 2</span></span>
<span id="cb206-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb206-8"></a><span class="co">#&gt;   Group     `Residual SD`</span></span>
<span id="cb206-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb206-9"></a><span class="co">#&gt;   &lt;fct&gt;             &lt;dbl&gt;</span></span>
<span id="cb206-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb206-10"></a><span class="co">#&gt; 1 Control            1.42</span></span>
<span id="cb206-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb206-11"></a><span class="co">#&gt; 2 Treatment          1.75</span></span></code></pre></div>
<p>Estimating random treatment effect is thus equal to <span class="math inline">\(\sqrt{SD_{Treatment \;group}^2 - SD_{Control \; group}^2}\)</span>:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb207-1"></a><span class="kw">sqrt</span>(SD_summary<span class="op">$</span><span class="st">`</span><span class="dt">Residual SD</span><span class="st">`</span>[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>SD_summary<span class="op">$</span><span class="st">`</span><span class="dt">Residual SD</span><span class="st">`</span>[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb207-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb207-2"></a><span class="co">#&gt; [1] 1.008368</span></span></code></pre></div>
<p>If you compare these regression estimates to those from the <code>bmbstats::RCT_analysis</code>, you will notice they are equal.</p>
<p>But, as alluded in <a href="causal-inference.html#causal-inference">Causal inference</a> chapter, one should avoid using Change scores and rather use Pre-test and Post-test scores. In this case, our model would look visually like this (I have added dashed identity line so Pre-test and Post-test comparison is easier):</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb208-1"></a><span class="kw">ggplot</span>(</span>
<span id="cb208-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb208-2"></a>  RCT_data,</span>
<span id="cb208-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb208-3"></a>  <span class="kw">aes</span>(<span class="dt">x =</span> Measured_score.Pre, <span class="dt">y =</span> Measured_score.Post, <span class="dt">color =</span> Group, <span class="dt">fill =</span> Group)) <span class="op">+</span></span>
<span id="cb208-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb208-4"></a><span class="st">  </span><span class="kw">theme_cowplot</span>(<span class="dv">8</span>) <span class="op">+</span></span>
<span id="cb208-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb208-5"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></span>
<span id="cb208-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb208-6"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>, <span class="dt">alpha=</span><span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb208-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb208-7"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.8</span>) <span class="op">+</span></span>
<span id="cb208-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb208-8"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">Treatment =</span> <span class="st">&quot;#FAA43A&quot;</span>, <span class="dt">Control =</span> <span class="st">&quot;#5DA5DA&quot;</span>)) <span class="op">+</span></span>
<span id="cb208-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb208-9"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">Treatment =</span> <span class="st">&quot;#FAA43A&quot;</span>, <span class="dt">Control =</span> <span class="st">&quot;#5DA5DA&quot;</span>))</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-30-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>And estimated linear regression model:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-1"></a>model2 &lt;-<span class="st"> </span><span class="kw">lm</span>(</span>
<span id="cb209-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-2"></a>  Measured_score.Post <span class="op">~</span><span class="st"> </span>Measured_score.Pre <span class="op">+</span><span class="st"> </span>Group,</span>
<span id="cb209-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-3"></a>  RCT_data</span>
<span id="cb209-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-4"></a>)</span>
<span id="cb209-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-5"></a></span>
<span id="cb209-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-6"></a><span class="kw">summary</span>(model2)</span>
<span id="cb209-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-7"></a><span class="co">#&gt; </span></span>
<span id="cb209-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-8"></a><span class="co">#&gt; Call:</span></span>
<span id="cb209-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-9"></a><span class="co">#&gt; lm(formula = Measured_score.Post ~ Measured_score.Pre + Group, </span></span>
<span id="cb209-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-10"></a><span class="co">#&gt;     data = RCT_data)</span></span>
<span id="cb209-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-11"></a><span class="co">#&gt; </span></span>
<span id="cb209-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-12"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb209-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-13"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb209-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-14"></a><span class="co">#&gt; -2.60014 -1.01512  0.04426  0.93174  3.13880 </span></span>
<span id="cb209-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-15"></a><span class="co">#&gt; </span></span>
<span id="cb209-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-16"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb209-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-17"></a><span class="co">#&gt;                    Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb209-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-18"></a><span class="co">#&gt; (Intercept)         2.52854    3.12937   0.808     0.43    </span></span>
<span id="cb209-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-19"></a><span class="co">#&gt; Measured_score.Pre  0.93598    0.06786  13.793 1.16e-10 ***</span></span>
<span id="cb209-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-20"></a><span class="co">#&gt; GroupTreatment     -0.14242    0.73977  -0.193     0.85    </span></span>
<span id="cb209-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-21"></a><span class="co">#&gt; ---</span></span>
<span id="cb209-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-22"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb209-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-23"></a><span class="co">#&gt; </span></span>
<span id="cb209-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-24"></a><span class="co">#&gt; Residual standard error: 1.598 on 17 degrees of freedom</span></span>
<span id="cb209-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-25"></a><span class="co">#&gt; Multiple R-squared:  0.9236, Adjusted R-squared:  0.9146 </span></span>
<span id="cb209-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb209-26"></a><span class="co">#&gt; F-statistic: 102.7 on 2 and 17 DF,  p-value: 3.22e-10</span></span></code></pre></div>
<p>In this model, Pre-test represent covariate. The estimated coefficient for this covariate is 0.94, or very close to 1.</p>
<p>The systematic treatment effect (-0.14cm) can be interpreted as “everything else being equal, changing group from Control to Treatment will result in” effect on the Post-test. Graphically, this represent the <em>vertical gap</em> between the two lines. Please note that in the previous graph, each group is modeled separately, and in this model the lines are assumed to be parallel (i.e. no interaction between the lines - or no interaction between Group and Pre-test). Let us thus plot our model:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb210-1"></a>RCT_data<span class="op">$</span>.pred &lt;-<span class="st"> </span><span class="kw">predict</span>(</span>
<span id="cb210-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb210-2"></a>  model2,</span>
<span id="cb210-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb210-3"></a>  <span class="dt">newdata =</span> RCT_data</span>
<span id="cb210-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb210-4"></a>)</span>
<span id="cb210-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb210-5"></a></span>
<span id="cb210-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb210-6"></a><span class="kw">ggplot</span>(</span>
<span id="cb210-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb210-7"></a>  RCT_data,</span>
<span id="cb210-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb210-8"></a>  <span class="kw">aes</span>(<span class="dt">x =</span> Measured_score.Pre, <span class="dt">y =</span> Measured_score.Post, <span class="dt">color =</span> Group, <span class="dt">fill =</span> Group)) <span class="op">+</span></span>
<span id="cb210-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb210-9"></a><span class="st">  </span><span class="kw">theme_cowplot</span>(<span class="dv">8</span>) <span class="op">+</span></span>
<span id="cb210-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb210-10"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.8</span>) <span class="op">+</span></span>
<span id="cb210-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb210-11"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> .pred)) <span class="op">+</span></span>
<span id="cb210-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb210-12"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">Treatment =</span> <span class="st">&quot;#FAA43A&quot;</span>, <span class="dt">Control =</span> <span class="st">&quot;#5DA5DA&quot;</span>)) <span class="op">+</span></span>
<span id="cb210-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb210-13"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">Treatment =</span> <span class="st">&quot;#FAA43A&quot;</span>, <span class="dt">Control =</span> <span class="st">&quot;#5DA5DA&quot;</span>))</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-32-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>As can be seen from the figure, lines are almost identical, but more importantly, they are now parallel.</p>
<p>To estimate random treatment effect, we can use residuals <code>SD</code> for each group yet again.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb211-1"></a>SD_summary &lt;-<span class="st"> </span>RCT_data <span class="op">%&gt;%</span></span>
<span id="cb211-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb211-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">.resid =</span> <span class="kw">residuals</span>(model2)) <span class="op">%&gt;%</span></span>
<span id="cb211-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb211-3"></a><span class="st">  </span><span class="kw">group_by</span>(Group) <span class="op">%&gt;%</span></span>
<span id="cb211-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb211-4"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="st">`</span><span class="dt">Residual SD</span><span class="st">`</span> =<span class="st"> </span><span class="kw">sd</span>(.resid))</span>
<span id="cb211-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb211-5"></a></span>
<span id="cb211-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb211-6"></a>SD_summary</span>
<span id="cb211-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb211-7"></a><span class="co">#&gt; # A tibble: 2 x 2</span></span>
<span id="cb211-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb211-8"></a><span class="co">#&gt;   Group     `Residual SD`</span></span>
<span id="cb211-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb211-9"></a><span class="co">#&gt;   &lt;fct&gt;             &lt;dbl&gt;</span></span>
<span id="cb211-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb211-10"></a><span class="co">#&gt; 1 Control            1.32</span></span>
<span id="cb211-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb211-11"></a><span class="co">#&gt; 2 Treatment          1.75</span></span></code></pre></div>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb212-1"></a><span class="kw">sqrt</span>(SD_summary<span class="op">$</span><span class="st">`</span><span class="dt">Residual SD</span><span class="st">`</span>[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>SD_summary<span class="op">$</span><span class="st">`</span><span class="dt">Residual SD</span><span class="st">`</span>[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb212-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb212-2"></a><span class="co">#&gt; [1] 1.151716</span></span></code></pre></div>
<p>This concept was a bit hard for me to wrap my head around as well. Residuals are something we cannot explain with our model (be it using simple <code>mean</code> with the method of differences, or using linear regression model with Group and Pre-test). Everything we can explain with the model can be thus seen as systematic effect. Thus, the <em>thing that is left</em> is unexplained variance. This variance is due to biological variation, instrumentation error and random non-treatment effects (which are zero in this example), as well as random treatment effects (which are also zero in this example).</p>
<p>This approach is implemented in <code>bmbstats::RCT_estimators_lm</code> function that we can use in <code>bmbstats::RCT_analysis</code> to get bootstrap CIs:</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-1"></a>regression_RCT &lt;-<span class="st"> </span>bmbstats<span class="op">::</span><span class="kw">RCT_analysis</span>(</span>
<span id="cb213-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-2"></a>  <span class="dt">data =</span> RCT_data,</span>
<span id="cb213-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-3"></a>  <span class="dt">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb213-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-4"></a>  <span class="dt">treatment_label =</span> <span class="st">&quot;Treatment&quot;</span>,</span>
<span id="cb213-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-5"></a>  <span class="dt">control_label =</span> <span class="st">&quot;Control&quot;</span>,</span>
<span id="cb213-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-6"></a>  <span class="dt">pre_test =</span> <span class="st">&quot;Measured_score.Pre&quot;</span>,</span>
<span id="cb213-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-7"></a>  <span class="dt">post_test =</span> <span class="st">&quot;Measured_score.Post&quot;</span>,</span>
<span id="cb213-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-8"></a>  <span class="dt">SESOI_lower =</span> <span class="dv">-5</span>,</span>
<span id="cb213-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-9"></a>  <span class="dt">SESOI_upper =</span> <span class="dv">5</span>,</span>
<span id="cb213-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-10"></a>  <span class="dt">estimator_function =</span> bmbstats<span class="op">::</span>RCT_estimators_lm,</span>
<span id="cb213-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-11"></a>  <span class="dt">control =</span> <span class="kw">model_control</span>(<span class="dt">seed =</span> <span class="dv">1667</span>)</span>
<span id="cb213-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-12"></a>)</span>
<span id="cb213-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-13"></a><span class="co">#&gt; [1] &quot;All values of t are equal to  5 \n Cannot calculate confidence intervals&quot;</span></span>
<span id="cb213-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-14"></a><span class="co">#&gt; [1] &quot;All values of t are equal to  10 \n Cannot calculate confidence intervals&quot;</span></span>
<span id="cb213-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-15"></a></span>
<span id="cb213-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-16"></a></span>
<span id="cb213-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-17"></a>regression_RCT</span>
<span id="cb213-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-18"></a><span class="co">#&gt; Bootstrap with 2000 resamples and 95% bca confidence intervals.</span></span>
<span id="cb213-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-19"></a><span class="co">#&gt; </span></span>
<span id="cb213-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-20"></a><span class="co">#&gt;                   estimator         value         lower      upper</span></span>
<span id="cb213-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-21"></a><span class="co">#&gt;                 SESOI lower -5.0000000000            NA         NA</span></span>
<span id="cb213-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-22"></a><span class="co">#&gt;                 SESOI upper  5.0000000000            NA         NA</span></span>
<span id="cb213-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-23"></a><span class="co">#&gt;                 SESOI range 10.0000000000            NA         NA</span></span>
<span id="cb213-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-24"></a><span class="co">#&gt;           Systematic effect -0.1424169958 -1.545188e+00  1.6146987</span></span>
<span id="cb213-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-25"></a><span class="co">#&gt;               Random effect  1.1517164871 -8.277225e-01  1.9466856</span></span>
<span id="cb213-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-26"></a><span class="co">#&gt;  Systematic effect to SESOI -0.0142416996 -1.545188e-01  0.1614699</span></span>
<span id="cb213-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-27"></a><span class="co">#&gt;      SESOI to Random effect  8.6826924091 -2.122197e+01 39.5968395</span></span>
<span id="cb213-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-28"></a><span class="co">#&gt;                      pLower  0.0002330614  1.379717e-14  1.0000000</span></span>
<span id="cb213-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-29"></a><span class="co">#&gt;                 pEquivalent  0.9996342091 -9.999971e-01  1.0000000</span></span>
<span id="cb213-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb213-30"></a><span class="co">#&gt;                     pHigher  0.0001327295  1.787965e-15  1.0000000</span></span></code></pre></div>
<p>Let’s now compare the results of the linear regression method with the method of differences (which uses Change score analysis):</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb214-1"></a>compare_methods &lt;-<span class="st"> </span><span class="kw">rbind</span>(</span>
<span id="cb214-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb214-2"></a>  <span class="kw">data.frame</span>(<span class="dt">method =</span> <span class="st">&quot;differences&quot;</span>, simple_RCT<span class="op">$</span>estimators),</span>
<span id="cb214-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb214-3"></a>  <span class="kw">data.frame</span>(<span class="dt">method =</span> <span class="st">&quot;linear regression&quot;</span>, regression_RCT<span class="op">$</span>estimators)</span>
<span id="cb214-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb214-4"></a>)</span>
<span id="cb214-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb214-5"></a></span>
<span id="cb214-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb214-6"></a></span>
<span id="cb214-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb214-7"></a><span class="kw">ggplot</span>(</span>
<span id="cb214-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb214-8"></a>  compare_methods,</span>
<span id="cb214-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb214-9"></a>  <span class="kw">aes</span>(<span class="dt">y =</span> method, <span class="dt">x =</span> value)</span>
<span id="cb214-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb214-10"></a>) <span class="op">+</span></span>
<span id="cb214-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb214-11"></a><span class="st">  </span><span class="kw">theme_bw</span>(<span class="dv">8</span>) <span class="op">+</span></span>
<span id="cb214-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb214-12"></a><span class="st">  </span><span class="kw">geom_errorbarh</span>(<span class="kw">aes</span>(<span class="dt">xmax =</span> upper, <span class="dt">xmin =</span> lower),</span>
<span id="cb214-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb214-13"></a>    <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb214-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb214-14"></a>    <span class="dt">height =</span> <span class="dv">0</span></span>
<span id="cb214-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb214-15"></a>  ) <span class="op">+</span></span>
<span id="cb214-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb214-16"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb214-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb214-17"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb214-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb214-18"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb214-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb214-19"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>estimator, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-36-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Which method should be used? For simple designs, these provide almost identical results. We could perform simulations as we have done in the <a href="validity-and-reliability.html#validity-and-reliability">Validity and Reliability</a> chapter to see the behavior of the estimates, but I will leave that to you as an exercise. I would generally follow the advice by <a href="https://www.fharrell.com/post/errmed/#change">Frank Harrell</a> and avoid the use of the change scores, particularly for more complex designs involving covariates and extra parameters of the treatment (i.e. when treatment is not only TRUE/FALSE but can have a continuous membership function, or some type of the loading parameter, like number of jumps performed and so forth).</p>
</div>
<div id="prediction-perspective-1" class="section level2" number="16.4">
<h2><span class="header-section-number">16.4</span> Prediction perspective 1</h2>
<p>Using simple linear regression function brings us to the prediction perspective of modeling the RCT data. Rather than estimating DGP parameters, we are interested in predicting individual responses on the unseen data. We can thus use <code>bmbstats::cv_model</code> function to estimate predictive performance of our simple linear regression model. One thing to keep in mind, is that now we are using SESOI to judge the residuals magnitudes, not observed scores (i.e. measured Post-test). Please note that I have used Group column to setup the CV strata - this results in same number of CV observations in each group.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-1"></a>model3 &lt;-<span class="st"> </span><span class="kw">cv_model</span>(</span>
<span id="cb215-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-2"></a>  Measured_score.Post <span class="op">~</span><span class="st"> </span>Measured_score.Pre <span class="op">+</span><span class="st"> </span>Group,</span>
<span id="cb215-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-3"></a>  RCT_data,</span>
<span id="cb215-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-4"></a>  <span class="dt">SESOI_lower =</span> <span class="dv">-5</span>,</span>
<span id="cb215-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-5"></a>  <span class="dt">SESOI_upper =</span> <span class="dv">5</span>,</span>
<span id="cb215-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-6"></a>  <span class="dt">control =</span> <span class="kw">model_control</span>(</span>
<span id="cb215-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-7"></a>    <span class="dt">seed =</span> <span class="dv">1667</span>,</span>
<span id="cb215-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-8"></a>    <span class="dt">cv_folds =</span> <span class="dv">3</span>,</span>
<span id="cb215-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-9"></a>    <span class="dt">cv_repeats =</span> <span class="dv">10</span>,</span>
<span id="cb215-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-10"></a>    <span class="dt">cv_strata =</span> <span class="kw">factor</span>(RCT_data<span class="op">$</span>Group))</span>
<span id="cb215-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-11"></a>)</span>
<span id="cb215-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-12"></a></span>
<span id="cb215-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-13"></a>model3</span>
<span id="cb215-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-14"></a><span class="co">#&gt; Training data consists of 3 predictors and 20 observations. Cross-Validation of the model was performed using 10 repeats of 3 folds.</span></span>
<span id="cb215-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-15"></a><span class="co">#&gt; </span></span>
<span id="cb215-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-16"></a><span class="co">#&gt; Model performance:</span></span>
<span id="cb215-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-17"></a><span class="co">#&gt; </span></span>
<span id="cb215-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-18"></a><span class="co">#&gt;         metric      training training.pooled testing.pooled        mean</span></span>
<span id="cb215-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-19"></a><span class="co">#&gt;            MBE  2.202681e-14    1.918475e-15    -0.04123424 -0.06466644</span></span>
<span id="cb215-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-20"></a><span class="co">#&gt;            MAE  1.176009e+00    1.125490e+00     1.47603175  1.47790175</span></span>
<span id="cb215-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-21"></a><span class="co">#&gt;           RMSE  1.473109e+00    1.403919e+00     1.82619034  1.79036050</span></span>
<span id="cb215-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-22"></a><span class="co">#&gt;           PPER  9.963039e-01    9.995798e-01     0.99312088  0.96151334</span></span>
<span id="cb215-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-23"></a><span class="co">#&gt;  SESOI to RMSE  6.788364e+00    7.122918e+00     5.47588047  5.82060839</span></span>
<span id="cb215-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-24"></a><span class="co">#&gt;      R-squared  9.235673e-01    9.305786e-01     0.88259682  0.86160357</span></span>
<span id="cb215-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-25"></a><span class="co">#&gt;         MinErr -3.138804e+00   -3.623411e+00    -5.03757174 -2.56189890</span></span>
<span id="cb215-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-26"></a><span class="co">#&gt;         MaxErr  2.600139e+00    2.890624e+00     3.53991399  2.08918814</span></span>
<span id="cb215-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-27"></a><span class="co">#&gt;      MaxAbsErr  3.138804e+00    3.623411e+00     5.03757174  3.08675364</span></span>
<span id="cb215-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-28"></a><span class="co">#&gt;          SD        min       max</span></span>
<span id="cb215-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-29"></a><span class="co">#&gt;  0.91228266 -2.0716103 1.8762924</span></span>
<span id="cb215-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-30"></a><span class="co">#&gt;  0.33700044  0.8701076 2.0982105</span></span>
<span id="cb215-31"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-31"></a><span class="co">#&gt;  0.37125297  1.1312614 2.6810220</span></span>
<span id="cb215-32"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-32"></a><span class="co">#&gt;  0.02661372  0.8929713 0.9939017</span></span>
<span id="cb215-33"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-33"></a><span class="co">#&gt;  1.20914378  3.7299209 8.8396899</span></span>
<span id="cb215-34"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-34"></a><span class="co">#&gt;  0.10805679  0.5866306 0.9743506</span></span>
<span id="cb215-35"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-35"></a><span class="co">#&gt;  1.14780901 -5.0375717 0.3235147</span></span>
<span id="cb215-36"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-36"></a><span class="co">#&gt;  0.96885433 -0.4470821 3.5399140</span></span>
<span id="cb215-37"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb215-37"></a><span class="co">#&gt;  0.76498989  1.7111147 5.0375717</span></span></code></pre></div>
<p>As can be seen from the performance results, we have pretty good prediction of the individual responses since our SESOI is pretty large and we do not have any treatment nor non-treatment effects.</p>
<p><code>bmbstats</code> package comes with additional function <code>bmbstats::RCT_predict</code> that uses returned object by <code>bmbstats::cv_model</code> and analyze is from RCT perspective:</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-1"></a>prediction_RCT &lt;-<span class="st"> </span><span class="kw">RCT_predict</span>(</span>
<span id="cb216-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-2"></a>  model3, </span>
<span id="cb216-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-3"></a>  <span class="dt">new_data =</span> RCT_data,</span>
<span id="cb216-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-4"></a>  <span class="dt">outcome =</span> <span class="st">&quot;Measured_score.Post&quot;</span>,</span>
<span id="cb216-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-5"></a>  <span class="dt">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb216-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-6"></a>  <span class="dt">treatment_label =</span> <span class="st">&quot;Treatment&quot;</span>,</span>
<span id="cb216-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-7"></a>  <span class="dt">control_label =</span> <span class="st">&quot;Control&quot;</span>,</span>
<span id="cb216-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-8"></a>  <span class="dt">subject_label =</span> RCT_data<span class="op">$</span>Athlete</span>
<span id="cb216-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-9"></a>)</span>
<span id="cb216-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-10"></a></span>
<span id="cb216-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-11"></a>prediction_RCT</span>
<span id="cb216-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-12"></a><span class="co">#&gt; Training data consists of 3 predictors and 20 observations. Cross-Validation of the model was performed using 10 repeats of 3 folds.</span></span>
<span id="cb216-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-13"></a><span class="co">#&gt; </span></span>
<span id="cb216-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-14"></a><span class="co">#&gt; Model performance:</span></span>
<span id="cb216-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-15"></a><span class="co">#&gt; </span></span>
<span id="cb216-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-16"></a><span class="co">#&gt;         metric      training training.pooled testing.pooled        mean</span></span>
<span id="cb216-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-17"></a><span class="co">#&gt;            MBE  2.202681e-14    1.918475e-15    -0.04123424 -0.06466644</span></span>
<span id="cb216-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-18"></a><span class="co">#&gt;            MAE  1.176009e+00    1.125490e+00     1.47603175  1.47790175</span></span>
<span id="cb216-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-19"></a><span class="co">#&gt;           RMSE  1.473109e+00    1.403919e+00     1.82619034  1.79036050</span></span>
<span id="cb216-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-20"></a><span class="co">#&gt;           PPER  9.963039e-01    9.995798e-01     0.99312088  0.96151334</span></span>
<span id="cb216-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-21"></a><span class="co">#&gt;  SESOI to RMSE  6.788364e+00    7.122918e+00     5.47588047  5.82060839</span></span>
<span id="cb216-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-22"></a><span class="co">#&gt;      R-squared  9.235673e-01    9.305786e-01     0.88259682  0.86160357</span></span>
<span id="cb216-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-23"></a><span class="co">#&gt;         MinErr -3.138804e+00   -3.623411e+00    -5.03757174 -2.56189890</span></span>
<span id="cb216-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-24"></a><span class="co">#&gt;         MaxErr  2.600139e+00    2.890624e+00     3.53991399  2.08918814</span></span>
<span id="cb216-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-25"></a><span class="co">#&gt;      MaxAbsErr  3.138804e+00    3.623411e+00     5.03757174  3.08675364</span></span>
<span id="cb216-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-26"></a><span class="co">#&gt;          SD        min       max</span></span>
<span id="cb216-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-27"></a><span class="co">#&gt;  0.91228266 -2.0716103 1.8762924</span></span>
<span id="cb216-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-28"></a><span class="co">#&gt;  0.33700044  0.8701076 2.0982105</span></span>
<span id="cb216-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-29"></a><span class="co">#&gt;  0.37125297  1.1312614 2.6810220</span></span>
<span id="cb216-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-30"></a><span class="co">#&gt;  0.02661372  0.8929713 0.9939017</span></span>
<span id="cb216-31"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-31"></a><span class="co">#&gt;  1.20914378  3.7299209 8.8396899</span></span>
<span id="cb216-32"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-32"></a><span class="co">#&gt;  0.10805679  0.5866306 0.9743506</span></span>
<span id="cb216-33"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-33"></a><span class="co">#&gt;  1.14780901 -5.0375717 0.3235147</span></span>
<span id="cb216-34"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-34"></a><span class="co">#&gt;  0.96885433 -0.4470821 3.5399140</span></span>
<span id="cb216-35"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-35"></a><span class="co">#&gt;  0.76498989  1.7111147 5.0375717</span></span>
<span id="cb216-36"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-36"></a><span class="co">#&gt; </span></span>
<span id="cb216-37"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-37"></a><span class="co">#&gt; Individual model results:</span></span>
<span id="cb216-38"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-38"></a><span class="co">#&gt; </span></span>
<span id="cb216-39"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-39"></a><span class="co">#&gt;     subject     group observed predicted    residual  magnitude counterfactual</span></span>
<span id="cb216-40"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-40"></a><span class="co">#&gt;  Athlete 01 Treatment 53.06613  51.87749 -1.18864415 Equivalent       52.01990</span></span>
<span id="cb216-41"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-41"></a><span class="co">#&gt;  Athlete 02   Control 41.74203  42.17581  0.43378581 Equivalent       42.03340</span></span>
<span id="cb216-42"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-42"></a><span class="co">#&gt;  Athlete 03 Treatment 51.26538  48.12658 -3.13880386 Equivalent       48.26899</span></span>
<span id="cb216-43"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-43"></a><span class="co">#&gt;  Athlete 04   Control 44.89588  44.04977 -0.84610959 Equivalent       43.90736</span></span>
<span id="cb216-44"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-44"></a><span class="co">#&gt;  Athlete 05 Treatment 39.31947  41.54657  2.22709299 Equivalent       41.68898</span></span>
<span id="cb216-45"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-45"></a><span class="co">#&gt;  Athlete 06   Control 41.15527  42.16271  1.00744225 Equivalent       42.02030</span></span>
<span id="cb216-46"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-46"></a><span class="co">#&gt;  Athlete 07 Treatment 40.80646  42.76857  1.96211098 Equivalent       42.91099</span></span>
<span id="cb216-47"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-47"></a><span class="co">#&gt;  Athlete 08   Control 48.68788  48.15176 -0.53612109 Equivalent       48.00934</span></span>
<span id="cb216-48"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-48"></a><span class="co">#&gt;  Athlete 09 Treatment 33.26669  33.21228 -0.05441276 Equivalent       33.35469</span></span>
<span id="cb216-49"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-49"></a><span class="co">#&gt;  Athlete 10   Control 45.90508  44.34223 -1.56285495 Equivalent       44.19981</span></span>
<span id="cb216-50"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-50"></a><span class="co">#&gt;  Athlete 11 Treatment 33.61544  34.37183  0.75639501 Equivalent       34.51425</span></span>
<span id="cb216-51"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-51"></a><span class="co">#&gt;  Athlete 12   Control 43.34150  45.94164  2.60013908 Equivalent       45.79923</span></span>
<span id="cb216-52"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-52"></a><span class="co">#&gt;  Athlete 13 Treatment 40.88270  38.87404 -2.00866163 Equivalent       39.01645</span></span>
<span id="cb216-53"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-53"></a><span class="co">#&gt;  Athlete 14   Control 50.96896  50.99231  0.02334441 Equivalent       50.84989</span></span>
<span id="cb216-54"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-54"></a><span class="co">#&gt;  Athlete 15 Treatment 42.08253  41.84993 -0.23260068 Equivalent       41.99235</span></span>
<span id="cb216-55"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-55"></a><span class="co">#&gt;  Athlete 16   Control 49.26936  50.30751  1.03815067 Equivalent       50.16510</span></span>
<span id="cb216-56"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-56"></a><span class="co">#&gt;  Athlete 17 Treatment 40.00091  39.96681 -0.03410111 Equivalent       40.10923</span></span>
<span id="cb216-57"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-57"></a><span class="co">#&gt;  Athlete 18   Control 41.32829  39.57284 -1.75545843 Equivalent       39.43042</span></span>
<span id="cb216-58"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-58"></a><span class="co">#&gt;  Athlete 19 Treatment 49.12101  50.83263  1.71162522 Equivalent       50.97505</span></span>
<span id="cb216-59"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-59"></a><span class="co">#&gt;  Athlete 20   Control 43.96351  43.56119 -0.40231815 Equivalent       43.41878</span></span>
<span id="cb216-60"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-60"></a><span class="co">#&gt;       pITE pITE_magnitude</span></span>
<span id="cb216-61"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-61"></a><span class="co">#&gt;   0.142417     Equivalent</span></span>
<span id="cb216-62"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-62"></a><span class="co">#&gt;  -0.142417     Equivalent</span></span>
<span id="cb216-63"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-63"></a><span class="co">#&gt;   0.142417     Equivalent</span></span>
<span id="cb216-64"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-64"></a><span class="co">#&gt;  -0.142417     Equivalent</span></span>
<span id="cb216-65"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-65"></a><span class="co">#&gt;   0.142417     Equivalent</span></span>
<span id="cb216-66"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-66"></a><span class="co">#&gt;  -0.142417     Equivalent</span></span>
<span id="cb216-67"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-67"></a><span class="co">#&gt;   0.142417     Equivalent</span></span>
<span id="cb216-68"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-68"></a><span class="co">#&gt;  -0.142417     Equivalent</span></span>
<span id="cb216-69"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-69"></a><span class="co">#&gt;   0.142417     Equivalent</span></span>
<span id="cb216-70"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-70"></a><span class="co">#&gt;  -0.142417     Equivalent</span></span>
<span id="cb216-71"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-71"></a><span class="co">#&gt;   0.142417     Equivalent</span></span>
<span id="cb216-72"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-72"></a><span class="co">#&gt;  -0.142417     Equivalent</span></span>
<span id="cb216-73"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-73"></a><span class="co">#&gt;   0.142417     Equivalent</span></span>
<span id="cb216-74"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-74"></a><span class="co">#&gt;  -0.142417     Equivalent</span></span>
<span id="cb216-75"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-75"></a><span class="co">#&gt;   0.142417     Equivalent</span></span>
<span id="cb216-76"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-76"></a><span class="co">#&gt;  -0.142417     Equivalent</span></span>
<span id="cb216-77"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-77"></a><span class="co">#&gt;   0.142417     Equivalent</span></span>
<span id="cb216-78"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-78"></a><span class="co">#&gt;  -0.142417     Equivalent</span></span>
<span id="cb216-79"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-79"></a><span class="co">#&gt;   0.142417     Equivalent</span></span>
<span id="cb216-80"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-80"></a><span class="co">#&gt;  -0.142417     Equivalent</span></span>
<span id="cb216-81"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-81"></a><span class="co">#&gt; </span></span>
<span id="cb216-82"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-82"></a><span class="co">#&gt; Summary of residuals per RCT group:</span></span>
<span id="cb216-83"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-83"></a><span class="co">#&gt; </span></span>
<span id="cb216-84"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-84"></a><span class="co">#&gt;      group         mean       SD</span></span>
<span id="cb216-85"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-85"></a><span class="co">#&gt;    Control 1.634246e-14 1.322097</span></span>
<span id="cb216-86"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-86"></a><span class="co">#&gt;  Treatment 2.771120e-14 1.753394</span></span>
<span id="cb216-87"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-87"></a><span class="co">#&gt; </span></span>
<span id="cb216-88"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-88"></a><span class="co">#&gt; Summary of counterfactual effects of RCT group:</span></span>
<span id="cb216-89"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-89"></a><span class="co">#&gt; </span></span>
<span id="cb216-90"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-90"></a><span class="co">#&gt;      group      pATE pVTE</span></span>
<span id="cb216-91"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-91"></a><span class="co">#&gt;  Treatment  0.142417    0</span></span>
<span id="cb216-92"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-92"></a><span class="co">#&gt;    Control -0.142417    0</span></span>
<span id="cb216-93"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb216-93"></a><span class="co">#&gt;     pooled  0.142417    0</span></span></code></pre></div>
<p>The results of <code>bmbstats::RCT_predict</code> contain (1) model performance (also returned from <code>bmbstats::cv_model</code>), (2) individual model results (which contains individual model predictions, as well as counterfactual predictions assuming Group changes from Control to Treatment and <em>vice versa</em>), (3) residuals summary per group (these are our random effects), and (4) summary of counterfactual effects (please refer to <a href="causal-inference.html#causal-inference">Causal inference</a> chapter for more information about these concepts). The <em>extra</em> details that <code>bmbstats::RCT_predict</code> adds on top of <code>bmbstats::cv_model</code> can be found in the <code>prediction_RCT$extra</code>.</p>
<p>Now that we have the more info about the underlying RCT, we can do various plots. Let’s plot the residuals first:</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb217-1"></a><span class="kw">plot</span>(prediction_RCT, <span class="st">&quot;residuals&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-39-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>To plot individual model predictions use the following:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb218-1"></a><span class="kw">plot</span>(prediction_RCT, <span class="st">&quot;prediction&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-40-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Circlets or dots represent observed (i.e. outcome or target variable), and vertical line represent model predictions. Residual between the two is color coded based on the provided SESOI threshold.</p>
<p>By default, prediction plot uses <code>metric = "RMSE"</code> and <code>metric_cv = "testing.pooled"</code> parameters to plot confidence intervals. We can use some other metric returned from <code>bmbstats::cv_model</code>. Let’s use <code>MaxAbsErr</code> (maximum absolute prediction error) from mean testing CV column:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb219-1"></a><span class="kw">plot</span>(prediction_RCT, <span class="st">&quot;prediction&quot;</span>, <span class="dt">metric =</span> <span class="st">&quot;MaxAbsErr&quot;</span>, <span class="dt">metric_cv =</span> <span class="st">&quot;mean&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-41-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>To plot individual bias-variance error decomposition thorough testing CV folds use:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb220-1"></a><span class="kw">plot</span>(prediction_RCT, <span class="st">&quot;bias-variance&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-42-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Here we can see which athletes are prediction outliers and generally present issues for the predictive model. Together with the individual predictions, we can use this plot and data to gain more info regarding individual reactions to intervention (i.e. who jumps out from the model prediction).</p>
<p>To gain understanding into counterfactual prediction, we could use PDP and ICE plots. The default variable to be used is the Group, which we can change later:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb221-1"></a><span class="kw">plot</span>(prediction_RCT, <span class="st">&quot;pdp+ice&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-43-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>This plot gives us insights into model prediction for each athlete when the Group variable changes, while keeping all other variables the same. Since this is RCT, this plot can be given counterfactual interpretation. The PDP line (thick red line) represent the average of these individual prediction (ICE lines), and as can be seen, the counterfactual effects of changing group is zero (since the line is parallel) and thus represents <em>expected</em> or systematic effect of the treatment.</p>
<p>Let’s do that for out other variable in the model (with addition of the dashed identity line):</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb222-1"></a><span class="kw">plot</span>(prediction_RCT, <span class="st">&quot;pdp+ice&quot;</span>, <span class="dt">predictor =</span> <span class="st">&quot;Measured_score.Pre&quot;</span>) <span class="op">+</span></span>
<span id="cb222-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb222-2"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-44-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>To plot these individual ICE line for each athlete we can use counterfactual plot:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb223-1"></a><span class="kw">plot</span>(prediction_RCT, <span class="st">&quot;counterfactual&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-45-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Since the systematic treatment effect is zero, these are very small. The mean of these individual counterfactual prediction effect is presented in the object printout in the last table as <code>pATE</code> (predicted average treatment effect) and <code>SD</code> of these effects as <code>pVTE</code> (predicted variable treatment effect). In this case, due simple model, the predicted treatment effects are the same, thus the <code>pVTE</code> is equal to zero.</p>
<p>Different way to plot these is to have <em>trellis</em> plot for each individual:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb224-1"></a><span class="kw">plot</span>(prediction_RCT, <span class="st">&quot;ice&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-46-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>These plots represent strong tool for understanding predictive model performance for the RCT data and study designs.</p>
</div>
<div id="adding-some-effects" class="section level2" number="16.5">
<h2><span class="header-section-number">16.5</span> Adding some effects</h2>
<p>The previous example contained no treatment nor non-treatment effects, only biological variation and instrumentation noise. Let’s now consider different treatment - plyometric training that has systematic effect of 5cm (<code>mean</code> or expected change) and random effect of 5cm. But, since this study is done after the off-season, all athletes experienced systematic effect of 2.5cm increase and random effect of 1cm only by normal training. This represents non-treatment effect.</p>
<p>Biological variation (1.5cm) and instrumentation noise (0.5cm) are still involved in the measured scores.</p>
<p>This is the code to generate the data (i.e. DGP):</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-1"></a><span class="kw">set.seed</span>(<span class="dv">16</span>)</span>
<span id="cb225-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-2"></a></span>
<span id="cb225-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-3"></a>n_subjects &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb225-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-4"></a></span>
<span id="cb225-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-5"></a><span class="co"># These stay the same</span></span>
<span id="cb225-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-6"></a>instrumentation_noise &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb225-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-7"></a>biological_variation &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb225-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-8"></a></span>
<span id="cb225-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-9"></a><span class="co"># -------------------------</span></span>
<span id="cb225-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-10"></a><span class="co"># Treatment effect</span></span>
<span id="cb225-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-11"></a>treatment_systematic &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb225-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-12"></a>treatment_random &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb225-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-13"></a></span>
<span id="cb225-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-14"></a><span class="co"># Non-treatment effect</span></span>
<span id="cb225-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-15"></a>non_treatment_systematic &lt;-<span class="st"> </span><span class="fl">2.5</span></span>
<span id="cb225-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-16"></a>non_treatment_random &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb225-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-17"></a><span class="co">#-------------------------</span></span>
<span id="cb225-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-18"></a></span>
<span id="cb225-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-19"></a>RCT_data &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb225-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-20"></a>  <span class="dt">Athlete =</span> <span class="kw">paste</span>(</span>
<span id="cb225-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-21"></a>    <span class="st">&quot;Athlete&quot;</span>,</span>
<span id="cb225-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-22"></a>    <span class="kw">str_pad</span>(</span>
<span id="cb225-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-23"></a>      <span class="dt">string =</span> <span class="kw">seq</span>(<span class="dv">1</span>, n_subjects),</span>
<span id="cb225-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-24"></a>      <span class="dt">width =</span> <span class="dv">2</span>,</span>
<span id="cb225-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-25"></a>      <span class="dt">pad =</span> <span class="st">&quot;0&quot;</span></span>
<span id="cb225-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-26"></a>    )</span>
<span id="cb225-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-27"></a>  ),</span>
<span id="cb225-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-28"></a>  <span class="dt">Group =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Treatment&quot;</span>, <span class="st">&quot;Control&quot;</span>), <span class="dt">length.out =</span> n_subjects),</span>
<span id="cb225-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-29"></a></span>
<span id="cb225-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-30"></a>  <span class="co"># True score</span></span>
<span id="cb225-31"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-31"></a>  <span class="dt">True_score.Pre =</span> <span class="kw">rnorm</span>(n_subjects, <span class="dv">45</span>, <span class="dv">5</span>),</span>
<span id="cb225-32"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-32"></a></span>
<span id="cb225-33"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-33"></a>  <span class="co"># Treatment effect</span></span>
<span id="cb225-34"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-34"></a>  <span class="dt">Treatment_effect =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> n_subjects, <span class="dt">mean =</span> treatment_systematic, <span class="dt">sd =</span> treatment_random),</span>
<span id="cb225-35"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-35"></a>  <span class="dt">Non_treatment_effect =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> n_subjects, <span class="dt">mean =</span> non_treatment_systematic, <span class="dt">sd =</span> non_treatment_random),</span>
<span id="cb225-36"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-36"></a></span>
<span id="cb225-37"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-37"></a>  <span class="co"># Calculate the change in true score</span></span>
<span id="cb225-38"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-38"></a>  <span class="dt">True_score.Change =</span> <span class="kw">if_else</span>(</span>
<span id="cb225-39"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-39"></a>    Group <span class="op">==</span><span class="st"> &quot;Treatment&quot;</span>,</span>
<span id="cb225-40"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-40"></a>    <span class="co"># Treatment group is a sum of treatment and non-treatment effects</span></span>
<span id="cb225-41"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-41"></a>    Treatment_effect <span class="op">+</span><span class="st"> </span>Non_treatment_effect,</span>
<span id="cb225-42"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-42"></a>    <span class="co"># While control group only get non-treatment effects</span></span>
<span id="cb225-43"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-43"></a>    Non_treatment_effect</span>
<span id="cb225-44"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-44"></a>  ),</span>
<span id="cb225-45"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-45"></a>  <span class="dt">True_score.Post =</span> True_score.Pre <span class="op">+</span><span class="st"> </span>True_score.Change,</span>
<span id="cb225-46"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-46"></a></span>
<span id="cb225-47"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-47"></a>  <span class="co"># Manifested score</span></span>
<span id="cb225-48"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-48"></a>  <span class="dt">Manifested_score.Pre =</span> True_score.Pre <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, biological_variation),</span>
<span id="cb225-49"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-49"></a>  <span class="dt">Manifested_score.Post =</span> True_score.Post <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, biological_variation),</span>
<span id="cb225-50"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-50"></a>  <span class="dt">Manifested_score.Change =</span> Manifested_score.Post <span class="op">-</span><span class="st"> </span>Manifested_score.Pre,</span>
<span id="cb225-51"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-51"></a></span>
<span id="cb225-52"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-52"></a>  <span class="co"># Measured score</span></span>
<span id="cb225-53"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-53"></a>  <span class="dt">Measured_score.Pre =</span> Manifested_score.Pre <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, instrumentation_noise),</span>
<span id="cb225-54"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-54"></a>  <span class="dt">Measured_score.Post =</span> Manifested_score.Post <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, instrumentation_noise),</span>
<span id="cb225-55"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-55"></a>  <span class="dt">Measured_score.Change =</span> Measured_score.Post <span class="op">-</span><span class="st"> </span>Measured_score.Pre</span>
<span id="cb225-56"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-56"></a>)</span>
<span id="cb225-57"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-57"></a></span>
<span id="cb225-58"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-58"></a>RCT_data<span class="op">$</span>Group &lt;-<span class="st"> </span><span class="kw">factor</span>(RCT_data<span class="op">$</span>Group)</span>
<span id="cb225-59"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-59"></a></span>
<span id="cb225-60"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-60"></a><span class="kw">head</span>(RCT_data)</span>
<span id="cb225-61"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-61"></a><span class="co">#&gt; # A tibble: 6 x 13</span></span>
<span id="cb225-62"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-62"></a><span class="co">#&gt;   Athlete Group True_score.Pre Treatment_effect Non_treatment_e…</span></span>
<span id="cb225-63"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-63"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;fct&gt;          &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb225-64"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-64"></a><span class="co">#&gt; 1 Athlet… Trea…           47.4           -3.24              1.17</span></span>
<span id="cb225-65"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-65"></a><span class="co">#&gt; 2 Athlet… Cont…           44.4            3.43              4.57</span></span>
<span id="cb225-66"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-66"></a><span class="co">#&gt; 3 Athlet… Trea…           50.5            4.09              2.74</span></span>
<span id="cb225-67"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-67"></a><span class="co">#&gt; 4 Athlet… Cont…           37.8           12.4               2.15</span></span>
<span id="cb225-68"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-68"></a><span class="co">#&gt; 5 Athlet… Trea…           50.7            0.671             1.87</span></span>
<span id="cb225-69"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-69"></a><span class="co">#&gt; 6 Athlet… Cont…           42.7           12.6               2.78</span></span>
<span id="cb225-70"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-70"></a><span class="co">#&gt; # … with 8 more variables: True_score.Change &lt;dbl&gt;, True_score.Post &lt;dbl&gt;,</span></span>
<span id="cb225-71"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-71"></a><span class="co">#&gt; #   Manifested_score.Pre &lt;dbl&gt;, Manifested_score.Post &lt;dbl&gt;,</span></span>
<span id="cb225-72"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-72"></a><span class="co">#&gt; #   Manifested_score.Change &lt;dbl&gt;, Measured_score.Pre &lt;dbl&gt;,</span></span>
<span id="cb225-73"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb225-73"></a><span class="co">#&gt; #   Measured_score.Post &lt;dbl&gt;, Measured_score.Change &lt;dbl&gt;</span></span></code></pre></div>
<p>Let’s plot the data using Pre-test as predictor (x-axis) and Post-test as the outcome (y-axis). Please remember that this plot provide simple linear regression for each group independently. I will add identity line for easier comparison:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb226-1"></a><span class="kw">ggplot</span>(</span>
<span id="cb226-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb226-2"></a>  RCT_data,</span>
<span id="cb226-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb226-3"></a>  <span class="kw">aes</span>(<span class="dt">x =</span> Measured_score.Pre, <span class="dt">y =</span> Measured_score.Post, <span class="dt">color =</span> Group, <span class="dt">fill =</span> Group)) <span class="op">+</span></span>
<span id="cb226-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb226-4"></a><span class="st">  </span><span class="kw">theme_cowplot</span>(<span class="dv">8</span>) <span class="op">+</span></span>
<span id="cb226-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb226-5"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></span>
<span id="cb226-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb226-6"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>, <span class="dt">alpha=</span><span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb226-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb226-7"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.8</span>) <span class="op">+</span></span>
<span id="cb226-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb226-8"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">Treatment =</span> <span class="st">&quot;#FAA43A&quot;</span>, <span class="dt">Control =</span> <span class="st">&quot;#5DA5DA&quot;</span>)) <span class="op">+</span></span>
<span id="cb226-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb226-9"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">Treatment =</span> <span class="st">&quot;#FAA43A&quot;</span>, <span class="dt">Control =</span> <span class="st">&quot;#5DA5DA&quot;</span>))</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-48-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can see that both Control and Treatment group demonstrated improvements since both lines are above the dashed identity line.</p>
<p>Using simple linear regression we get the following coefficients:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-1"></a>model4 &lt;-<span class="st"> </span><span class="kw">lm</span>(</span>
<span id="cb227-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-2"></a>  Measured_score.Post <span class="op">~</span><span class="st"> </span>Measured_score.Pre <span class="op">+</span><span class="st"> </span>Group,</span>
<span id="cb227-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-3"></a>  RCT_data</span>
<span id="cb227-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-4"></a>)</span>
<span id="cb227-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-5"></a></span>
<span id="cb227-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-6"></a><span class="kw">summary</span>(model4)</span>
<span id="cb227-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-7"></a><span class="co">#&gt; </span></span>
<span id="cb227-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-8"></a><span class="co">#&gt; Call:</span></span>
<span id="cb227-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-9"></a><span class="co">#&gt; lm(formula = Measured_score.Post ~ Measured_score.Pre + Group, </span></span>
<span id="cb227-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-10"></a><span class="co">#&gt;     data = RCT_data)</span></span>
<span id="cb227-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-11"></a><span class="co">#&gt; </span></span>
<span id="cb227-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-12"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb227-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-13"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb227-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-14"></a><span class="co">#&gt; -6.5827 -3.5413  0.3856  2.3547  7.9219 </span></span>
<span id="cb227-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-15"></a><span class="co">#&gt; </span></span>
<span id="cb227-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-16"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb227-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-17"></a><span class="co">#&gt;                    Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb227-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-18"></a><span class="co">#&gt; (Intercept)         13.1094     8.5876   1.527 0.145262    </span></span>
<span id="cb227-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-19"></a><span class="co">#&gt; Measured_score.Pre   0.7774     0.1902   4.088 0.000767 ***</span></span>
<span id="cb227-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-20"></a><span class="co">#&gt; GroupTreatment       4.9265     1.9679   2.503 0.022784 *  </span></span>
<span id="cb227-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-21"></a><span class="co">#&gt; ---</span></span>
<span id="cb227-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-22"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb227-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-23"></a><span class="co">#&gt; </span></span>
<span id="cb227-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-24"></a><span class="co">#&gt; Residual standard error: 4.294 on 17 degrees of freedom</span></span>
<span id="cb227-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-25"></a><span class="co">#&gt; Multiple R-squared:  0.6289, Adjusted R-squared:  0.5853 </span></span>
<span id="cb227-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb227-26"></a><span class="co">#&gt; F-statistic: 14.41 on 2 and 17 DF,  p-value: 0.000219</span></span></code></pre></div>
<p>Now the simple linear regression estimated systematic treatment effect of 4.93cm, which is very close to our DGP systematic treatment effect of 5cm.</p>
<p>To estimate random treatment effect, we can use residuals <code>SD</code> for each group:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb228-1"></a>SD_summary &lt;-<span class="st"> </span>RCT_data <span class="op">%&gt;%</span></span>
<span id="cb228-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb228-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">.resid =</span> <span class="kw">residuals</span>(model4)) <span class="op">%&gt;%</span></span>
<span id="cb228-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb228-3"></a><span class="st">  </span><span class="kw">group_by</span>(Group) <span class="op">%&gt;%</span></span>
<span id="cb228-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb228-4"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="st">`</span><span class="dt">Residual SD</span><span class="st">`</span> =<span class="st"> </span><span class="kw">sd</span>(.resid))</span>
<span id="cb228-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb228-5"></a></span>
<span id="cb228-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb228-6"></a>SD_summary</span>
<span id="cb228-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb228-7"></a><span class="co">#&gt; # A tibble: 2 x 2</span></span>
<span id="cb228-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb228-8"></a><span class="co">#&gt;   Group     `Residual SD`</span></span>
<span id="cb228-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb228-9"></a><span class="co">#&gt;   &lt;fct&gt;             &lt;dbl&gt;</span></span>
<span id="cb228-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb228-10"></a><span class="co">#&gt; 1 Control            2.41</span></span>
<span id="cb228-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb228-11"></a><span class="co">#&gt; 2 Treatment          5.39</span></span></code></pre></div>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb229-1"></a><span class="kw">sqrt</span>(SD_summary<span class="op">$</span><span class="st">`</span><span class="dt">Residual SD</span><span class="st">`</span>[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>SD_summary<span class="op">$</span><span class="st">`</span><span class="dt">Residual SD</span><span class="st">`</span>[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb229-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb229-2"></a><span class="co">#&gt; [1] 4.816519</span></span></code></pre></div>
<p>Using <code>bmbstats::RCT_estimators_lm</code> estimator function and <code>bmbstats::RCT_analysis</code> functions, let’s perform the analysis and generate 95% bootstrap confidence intervals:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-1"></a>regression_RCT &lt;-<span class="st"> </span>bmbstats<span class="op">::</span><span class="kw">RCT_analysis</span>(</span>
<span id="cb230-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-2"></a>  <span class="dt">data =</span> RCT_data,</span>
<span id="cb230-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-3"></a>  <span class="dt">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb230-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-4"></a>  <span class="dt">treatment_label =</span> <span class="st">&quot;Treatment&quot;</span>,</span>
<span id="cb230-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-5"></a>  <span class="dt">control_label =</span> <span class="st">&quot;Control&quot;</span>,</span>
<span id="cb230-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-6"></a>  <span class="dt">pre_test =</span> <span class="st">&quot;Measured_score.Pre&quot;</span>,</span>
<span id="cb230-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-7"></a>  <span class="dt">post_test =</span> <span class="st">&quot;Measured_score.Post&quot;</span>,</span>
<span id="cb230-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-8"></a>  <span class="dt">SESOI_lower =</span> <span class="dv">-5</span>,</span>
<span id="cb230-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-9"></a>  <span class="dt">SESOI_upper =</span> <span class="dv">5</span>,</span>
<span id="cb230-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-10"></a>  <span class="dt">estimator_function =</span> bmbstats<span class="op">::</span>RCT_estimators_lm,</span>
<span id="cb230-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-11"></a>  <span class="dt">control =</span> <span class="kw">model_control</span>(<span class="dt">seed =</span> <span class="dv">1667</span>)</span>
<span id="cb230-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-12"></a>)</span>
<span id="cb230-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-13"></a><span class="co">#&gt; [1] &quot;All values of t are equal to  5 \n Cannot calculate confidence intervals&quot;</span></span>
<span id="cb230-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-14"></a><span class="co">#&gt; [1] &quot;All values of t are equal to  10 \n Cannot calculate confidence intervals&quot;</span></span>
<span id="cb230-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-15"></a></span>
<span id="cb230-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-16"></a></span>
<span id="cb230-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-17"></a>regression_RCT</span>
<span id="cb230-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-18"></a><span class="co">#&gt; Bootstrap with 2000 resamples and 95% bca confidence intervals.</span></span>
<span id="cb230-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-19"></a><span class="co">#&gt; </span></span>
<span id="cb230-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-20"></a><span class="co">#&gt;                   estimator       value         lower     upper</span></span>
<span id="cb230-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-21"></a><span class="co">#&gt;                 SESOI lower -5.00000000            NA        NA</span></span>
<span id="cb230-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-22"></a><span class="co">#&gt;                 SESOI upper  5.00000000            NA        NA</span></span>
<span id="cb230-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-23"></a><span class="co">#&gt;                 SESOI range 10.00000000            NA        NA</span></span>
<span id="cb230-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-24"></a><span class="co">#&gt;           Systematic effect  4.92654585   1.082956784 8.7715046</span></span>
<span id="cb230-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-25"></a><span class="co">#&gt;               Random effect  4.81651919   3.443713578 6.3838094</span></span>
<span id="cb230-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-26"></a><span class="co">#&gt;  Systematic effect to SESOI  0.49265458   0.108295678 0.8771505</span></span>
<span id="cb230-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-27"></a><span class="co">#&gt;      SESOI to Random effect  2.07618814 -21.118934945 2.9121218</span></span>
<span id="cb230-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-28"></a><span class="co">#&gt;                      pLower  0.02663292   0.001106225 0.2469677</span></span>
<span id="cb230-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-29"></a><span class="co">#&gt;                 pEquivalent  0.47937140   0.097391976 0.8405754</span></span>
<span id="cb230-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb230-30"></a><span class="co">#&gt;                     pHigher  0.49399568   0.117750794 0.8878213</span></span></code></pre></div>
<p>Here is the estimators bootstrap distribution:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb231-1"></a><span class="kw">plot</span>(regression_RCT)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-53-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>As can be seen from the results, both systematic and random components of the treatment effects were estimated correctly.</p>
<p>Let’s plot the Pre- and Post-Test results for each group (I will let you play and plot other figures as explained in the previous sections):</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb232-1"></a><span class="kw">plot</span>(regression_RCT, <span class="dt">type =</span> <span class="st">&quot;control-paired-change&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-54-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb233-1"></a><span class="kw">plot</span>(regression_RCT, <span class="dt">type =</span> <span class="st">&quot;treatment-paired-change&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-55-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Let’s now plot individual treatment responses with uncertainty intervals:</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb234-1"></a><span class="kw">plot</span>(regression_RCT, <span class="dt">type =</span> <span class="st">&quot;treatment-responses&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-56-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>As explained previously, this type of analysis and plot, uses Control group change score as some type of a <em>proxy</em> to quantify the uncertainty around observed treatment group change scores. Please note that even though we have used linear regression approach to estimate treatment effects, the plots still rely on the change scores.</p>
<p>To check if this plot make sense, we can add the true treatment effects from the DGP using <code>bmbstats::observations_MET</code> function (we can also use <code>bmbstats::observations_MBI</code> function for plotting):</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-1"></a>treatment_group &lt;-<span class="st"> </span><span class="kw">filter</span>(</span>
<span id="cb235-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-2"></a>  RCT_data,</span>
<span id="cb235-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-3"></a>  Group <span class="op">==</span><span class="st"> &quot;Treatment&quot;</span></span>
<span id="cb235-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-4"></a>)</span>
<span id="cb235-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-5"></a></span>
<span id="cb235-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-6"></a>control_group &lt;-<span class="st"> </span><span class="kw">filter</span>(</span>
<span id="cb235-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-7"></a>  RCT_data,</span>
<span id="cb235-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-8"></a>  Group <span class="op">==</span><span class="st"> &quot;Control&quot;</span></span>
<span id="cb235-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-9"></a>)</span>
<span id="cb235-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-10"></a></span>
<span id="cb235-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-11"></a>treatment_responses &lt;-<span class="st"> </span>bmbstats<span class="op">::</span><span class="kw">observations_MET</span>(</span>
<span id="cb235-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-12"></a>  <span class="dt">observations =</span> treatment_group<span class="op">$</span>Measured_score.Change,</span>
<span id="cb235-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-13"></a>  <span class="dt">observations_label =</span> treatment_group<span class="op">$</span>Athlete,</span>
<span id="cb235-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-14"></a></span>
<span id="cb235-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-15"></a>  <span class="co"># Use control group change as measurement error</span></span>
<span id="cb235-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-16"></a>  <span class="dt">measurement_error =</span> <span class="kw">sd</span>(control_group<span class="op">$</span>Measured_score.Change),</span>
<span id="cb235-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-17"></a></span>
<span id="cb235-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-18"></a>  <span class="co"># Degrees of freedom from the reliability study. Use `Inf` for normal distribution</span></span>
<span id="cb235-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-19"></a>  <span class="dt">df =</span> <span class="kw">nrow</span>(control_group) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb235-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-20"></a>  <span class="dt">SESOI_lower =</span> <span class="dv">-5</span>,</span>
<span id="cb235-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-21"></a>  <span class="dt">SESOI_upper =</span> <span class="dv">5</span>,</span>
<span id="cb235-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-22"></a></span>
<span id="cb235-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-23"></a>  <span class="co"># Will not use Bonferroni adjustment here</span></span>
<span id="cb235-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-24"></a>  <span class="dt">alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb235-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-25"></a>  <span class="co"># No adjustment in CIs for plotting</span></span>
<span id="cb235-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-26"></a>  <span class="dt">confidence =</span> <span class="fl">0.95</span></span>
<span id="cb235-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-27"></a>)</span>
<span id="cb235-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-28"></a></span>
<span id="cb235-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-29"></a><span class="kw">plot</span>(</span>
<span id="cb235-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-30"></a>  treatment_responses,</span>
<span id="cb235-31"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-31"></a>  <span class="dt">true_observations =</span> treatment_group<span class="op">$</span>True_score.Change,</span>
<span id="cb235-32"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-32"></a>  <span class="dt">control =</span> <span class="kw">plot_control</span>(<span class="dt">points_size =</span> <span class="dv">5</span>)</span>
<span id="cb235-33"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-33"></a>) <span class="op">+</span></span>
<span id="cb235-34"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb235-34"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">28</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-57-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Adjusted treatment response would deduct <code>mean</code> change from the Control group and would show individual effect ONLY with treatment effect (without non-treatment effect). We can use our DGP generated data frame to generate that graph (or to recreate it) and plot true treatment effects:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-1"></a>treatment_responses &lt;-<span class="st"> </span>bmbstats<span class="op">::</span><span class="kw">observations_MET</span>(</span>
<span id="cb236-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-2"></a>  </span>
<span id="cb236-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-3"></a>  <span class="co"># Adjustment</span></span>
<span id="cb236-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-4"></a>  <span class="dt">observations =</span> treatment_group<span class="op">$</span>Measured_score.Change <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(control_group<span class="op">$</span>Measured_score.Change),</span>
<span id="cb236-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-5"></a>  <span class="dt">observations_label =</span> treatment_group<span class="op">$</span>Athlete,</span>
<span id="cb236-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-6"></a></span>
<span id="cb236-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-7"></a>  <span class="co"># Use control group change as measurement error</span></span>
<span id="cb236-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-8"></a>  <span class="dt">measurement_error =</span> <span class="kw">sd</span>(control_group<span class="op">$</span>Measured_score.Change),</span>
<span id="cb236-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-9"></a></span>
<span id="cb236-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-10"></a>  <span class="co"># Degrees of freedom from the reliability study. Use `Inf` for normal distribution</span></span>
<span id="cb236-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-11"></a>  <span class="dt">df =</span> <span class="kw">nrow</span>(control_group) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb236-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-12"></a>  <span class="dt">SESOI_lower =</span> <span class="dv">-5</span>,</span>
<span id="cb236-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-13"></a>  <span class="dt">SESOI_upper =</span> <span class="dv">5</span>,</span>
<span id="cb236-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-14"></a></span>
<span id="cb236-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-15"></a>  <span class="co"># Will not use Bonferroni adjustment here</span></span>
<span id="cb236-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-16"></a>  <span class="dt">alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb236-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-17"></a>  <span class="co"># No adjustment in CIs for plotting</span></span>
<span id="cb236-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-18"></a>  <span class="dt">confidence =</span> <span class="fl">0.95</span></span>
<span id="cb236-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-19"></a>)</span>
<span id="cb236-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-20"></a></span>
<span id="cb236-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-21"></a><span class="kw">plot</span>(</span>
<span id="cb236-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-22"></a>  treatment_responses,</span>
<span id="cb236-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-23"></a>  <span class="co"># The true observation now is the DGP Treatment effect only</span></span>
<span id="cb236-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-24"></a>  <span class="dt">true_observations =</span> treatment_group<span class="op">$</span>Treatment_effect,</span>
<span id="cb236-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-25"></a>  <span class="dt">control =</span> <span class="kw">plot_control</span>(<span class="dt">points_size =</span> <span class="dv">5</span>)</span>
<span id="cb236-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-26"></a>) <span class="op">+</span></span>
<span id="cb236-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb236-27"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">28</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-58-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="what-goes-inside-the-measurement-error-or-control-group-change-or-residuals-sd" class="section level2" number="16.6">
<h2><span class="header-section-number">16.6</span> What goes inside the <em>measurement error</em> (or Control group change or residuals <code>SD</code>)?</h2>
<p>As already explained, Control group serves as a counter-factual proxy of what would happen to the treatment group if not-receiving the treatment. <code>SD</code> of Control group change is used to represent an estimate of uncertainty around individual responses. In our RCT data, <code>SD</code> of the Control group measured change is equal to 2.23cm. This is equal to the root of squared sums of non-treatment random effect, biological variation and instrumentation noise. Since biological variation and instrumentation affects the change score twice (at Pre- and Post-test) we get the following:</p>
<p><span class="math display">\[
  SD_{control\;change} = \sqrt{2\times biological\;variation^2 + 2\times instrumentation\;noise^2 + non\;treatment\;random\;effect^2}
\]</span>
If we plug our DGP values, we get the following expected <code>SD</code> of the Control group change: 2.45cm. If there is no non-treatment random effect, then <code>SD</code> for the control group would only consist of measurement error.</p>
<p>This measurement error decomposition belongs to the method of differences, but the same error decomposition happens in the <code>SD</code> of the residuals with the linear regression approach.</p>
<p>To demonstrate this, consider random treatment effect estimated using the measured Pre-test and Post-test scores, versus using True scores.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-1"></a>model_true &lt;-<span class="st"> </span><span class="kw">lm</span>(</span>
<span id="cb237-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-2"></a>  True_score.Post <span class="op">~</span><span class="st"> </span>True_score.Pre <span class="op">+</span><span class="st"> </span>Group,</span>
<span id="cb237-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-3"></a>  RCT_data</span>
<span id="cb237-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-4"></a>)</span>
<span id="cb237-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-5"></a></span>
<span id="cb237-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-6"></a><span class="kw">summary</span>(model_true)</span>
<span id="cb237-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-7"></a><span class="co">#&gt; </span></span>
<span id="cb237-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-8"></a><span class="co">#&gt; Call:</span></span>
<span id="cb237-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-9"></a><span class="co">#&gt; lm(formula = True_score.Post ~ True_score.Pre + Group, data = RCT_data)</span></span>
<span id="cb237-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-10"></a><span class="co">#&gt; </span></span>
<span id="cb237-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-11"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb237-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-12"></a><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span id="cb237-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-13"></a><span class="co">#&gt; -8.945 -1.128  0.299  1.822  6.053 </span></span>
<span id="cb237-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-14"></a><span class="co">#&gt; </span></span>
<span id="cb237-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-15"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb237-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-16"></a><span class="co">#&gt;                Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb237-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-17"></a><span class="co">#&gt; (Intercept)     13.7253     8.2176   1.670 0.113184    </span></span>
<span id="cb237-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-18"></a><span class="co">#&gt; True_score.Pre   0.7578     0.1801   4.208 0.000591 ***</span></span>
<span id="cb237-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-19"></a><span class="co">#&gt; GroupTreatment   4.6334     1.7272   2.683 0.015736 *  </span></span>
<span id="cb237-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-20"></a><span class="co">#&gt; ---</span></span>
<span id="cb237-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-21"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb237-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-22"></a><span class="co">#&gt; </span></span>
<span id="cb237-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-23"></a><span class="co">#&gt; Residual standard error: 3.764 on 17 degrees of freedom</span></span>
<span id="cb237-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-24"></a><span class="co">#&gt; Multiple R-squared:  0.6497, Adjusted R-squared:  0.6085 </span></span>
<span id="cb237-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb237-25"></a><span class="co">#&gt; F-statistic: 15.76 on 2 and 17 DF,  p-value: 0.0001342</span></span></code></pre></div>
<p>The model with measured scores is the model we have used so far (<code>model4</code>), but I am repeating it here for the sake of easier comprehension:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-1"></a>model_measured &lt;-<span class="st"> </span><span class="kw">lm</span>(</span>
<span id="cb238-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-2"></a>  Measured_score.Post <span class="op">~</span><span class="st"> </span>Measured_score.Pre <span class="op">+</span><span class="st"> </span>Group,</span>
<span id="cb238-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-3"></a>  RCT_data</span>
<span id="cb238-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-4"></a>)</span>
<span id="cb238-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-5"></a></span>
<span id="cb238-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-6"></a><span class="kw">summary</span>(model_measured)</span>
<span id="cb238-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-7"></a><span class="co">#&gt; </span></span>
<span id="cb238-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-8"></a><span class="co">#&gt; Call:</span></span>
<span id="cb238-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-9"></a><span class="co">#&gt; lm(formula = Measured_score.Post ~ Measured_score.Pre + Group, </span></span>
<span id="cb238-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-10"></a><span class="co">#&gt;     data = RCT_data)</span></span>
<span id="cb238-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-11"></a><span class="co">#&gt; </span></span>
<span id="cb238-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-12"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb238-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-13"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb238-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-14"></a><span class="co">#&gt; -6.5827 -3.5413  0.3856  2.3547  7.9219 </span></span>
<span id="cb238-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-15"></a><span class="co">#&gt; </span></span>
<span id="cb238-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-16"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb238-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-17"></a><span class="co">#&gt;                    Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb238-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-18"></a><span class="co">#&gt; (Intercept)         13.1094     8.5876   1.527 0.145262    </span></span>
<span id="cb238-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-19"></a><span class="co">#&gt; Measured_score.Pre   0.7774     0.1902   4.088 0.000767 ***</span></span>
<span id="cb238-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-20"></a><span class="co">#&gt; GroupTreatment       4.9265     1.9679   2.503 0.022784 *  </span></span>
<span id="cb238-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-21"></a><span class="co">#&gt; ---</span></span>
<span id="cb238-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-22"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb238-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-23"></a><span class="co">#&gt; </span></span>
<span id="cb238-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-24"></a><span class="co">#&gt; Residual standard error: 4.294 on 17 degrees of freedom</span></span>
<span id="cb238-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-25"></a><span class="co">#&gt; Multiple R-squared:  0.6289, Adjusted R-squared:  0.5853 </span></span>
<span id="cb238-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb238-26"></a><span class="co">#&gt; F-statistic: 14.41 on 2 and 17 DF,  p-value: 0.000219</span></span></code></pre></div>
<p>Estimate random treatment effect for each model are the following, we can use residuals <code>SD</code> for each group:</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb239-1"></a>SD_summary_true &lt;-<span class="st"> </span>RCT_data <span class="op">%&gt;%</span></span>
<span id="cb239-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb239-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">.resid =</span> <span class="kw">residuals</span>(model_true)) <span class="op">%&gt;%</span></span>
<span id="cb239-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb239-3"></a><span class="st">  </span><span class="kw">group_by</span>(Group) <span class="op">%&gt;%</span></span>
<span id="cb239-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb239-4"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="st">`</span><span class="dt">Residual SD</span><span class="st">`</span> =<span class="st"> </span><span class="kw">sd</span>(.resid))</span>
<span id="cb239-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb239-5"></a></span>
<span id="cb239-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb239-6"></a>SD_summary_true</span>
<span id="cb239-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb239-7"></a><span class="co">#&gt; # A tibble: 2 x 2</span></span>
<span id="cb239-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb239-8"></a><span class="co">#&gt;   Group     `Residual SD`</span></span>
<span id="cb239-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb239-9"></a><span class="co">#&gt;   &lt;fct&gt;             &lt;dbl&gt;</span></span>
<span id="cb239-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb239-10"></a><span class="co">#&gt; 1 Control            1.47</span></span>
<span id="cb239-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb239-11"></a><span class="co">#&gt; 2 Treatment          4.96</span></span></code></pre></div>
<p>The <code>SD</code> of the Control group residuals using the True scores should only involve random non-treatment effect, which is in our case equal to 1cm, and <code>SD</code> of the Treatment group residuals should be 5cm.</p>
<p>Let’s see whats the case with the model that uses Measured scores:</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb240-1"></a>SD_summary_measured &lt;-<span class="st"> </span>RCT_data <span class="op">%&gt;%</span></span>
<span id="cb240-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb240-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">.resid =</span> <span class="kw">residuals</span>(model_measured)) <span class="op">%&gt;%</span></span>
<span id="cb240-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb240-3"></a><span class="st">  </span><span class="kw">group_by</span>(Group) <span class="op">%&gt;%</span></span>
<span id="cb240-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb240-4"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="st">`</span><span class="dt">Residual SD</span><span class="st">`</span> =<span class="st"> </span><span class="kw">sd</span>(.resid))</span>
<span id="cb240-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb240-5"></a></span>
<span id="cb240-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb240-6"></a></span>
<span id="cb240-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb240-7"></a>SD_summary_measured</span>
<span id="cb240-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb240-8"></a><span class="co">#&gt; # A tibble: 2 x 2</span></span>
<span id="cb240-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb240-9"></a><span class="co">#&gt;   Group     `Residual SD`</span></span>
<span id="cb240-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb240-10"></a><span class="co">#&gt;   &lt;fct&gt;             &lt;dbl&gt;</span></span>
<span id="cb240-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb240-11"></a><span class="co">#&gt; 1 Control            2.41</span></span>
<span id="cb240-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb240-12"></a><span class="co">#&gt; 2 Treatment          5.39</span></span></code></pre></div>
<p>The <code>SD</code> of the Control group residuals using the measured scores should now involve random non-treatment effect (1cm), 2 x biological variation (1.5cm) and 2 x instrumentation noise (0.5cm), which is around <span class="math inline">\(\sqrt{1^2 + 2*1.5^2 + 2*0.5^2}\)</span>, or 2.45cm.</p>
<p>The <code>SD</code> of the Treatment group residuals using the measured scores should now involve random non-treatment effect (1cm), 2 x biological variation (1.5cm), 2 x instrumentation noise (0.5cm), and additional random treatment effect (5cm) which is around <span class="math inline">\(\sqrt{1^2 + 2*1.5^2 + 2*0.5^2 + 5^2}\)</span>, or 5.57cm.</p>
<p>Estimated random treatment effects:</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb241-1"></a><span class="kw">sqrt</span>(SD_summary_true<span class="op">$</span><span class="st">`</span><span class="dt">Residual SD</span><span class="st">`</span>[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>SD_summary_true<span class="op">$</span><span class="st">`</span><span class="dt">Residual SD</span><span class="st">`</span>[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb241-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb241-2"></a><span class="co">#&gt; [1] 4.738641</span></span></code></pre></div>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb242-1"></a><span class="kw">sqrt</span>(SD_summary_measured<span class="op">$</span><span class="st">`</span><span class="dt">Residual SD</span><span class="st">`</span>[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>SD_summary_measured<span class="op">$</span><span class="st">`</span><span class="dt">Residual SD</span><span class="st">`</span>[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb242-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb242-2"></a><span class="co">#&gt; [1] 4.816519</span></span></code></pre></div>
<p>As can be seen, these are exactly the same. So, using measures scores and <code>SD</code> of control group change or residuals can <em>recover</em> true random treatment effect value.</p>
</div>
<div id="prediction-perspective-2" class="section level2" number="16.7">
<h2><span class="header-section-number">16.7</span> Prediction perspective 2</h2>
<p>Let’s see what happens when we run this RCT through predictive model.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-1"></a>model5 &lt;-<span class="st"> </span><span class="kw">cv_model</span>(</span>
<span id="cb243-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-2"></a>  Measured_score.Post <span class="op">~</span><span class="st"> </span>Measured_score.Pre <span class="op">+</span><span class="st"> </span>Group,</span>
<span id="cb243-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-3"></a>  RCT_data,</span>
<span id="cb243-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-4"></a>  <span class="dt">SESOI_lower =</span> <span class="dv">-5</span>,</span>
<span id="cb243-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-5"></a>  <span class="dt">SESOI_upper =</span> <span class="dv">5</span>,</span>
<span id="cb243-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-6"></a>  <span class="dt">control =</span> <span class="kw">model_control</span>(</span>
<span id="cb243-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-7"></a>    <span class="dt">seed =</span> <span class="dv">1667</span>,</span>
<span id="cb243-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-8"></a>    <span class="dt">cv_folds =</span> <span class="dv">3</span>,</span>
<span id="cb243-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-9"></a>    <span class="dt">cv_repeats =</span> <span class="dv">10</span>,</span>
<span id="cb243-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-10"></a>    <span class="dt">cv_strata =</span> <span class="kw">factor</span>(RCT_data<span class="op">$</span>Group))</span>
<span id="cb243-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-11"></a>)</span>
<span id="cb243-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-12"></a></span>
<span id="cb243-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-13"></a>prediction_RCT &lt;-<span class="st"> </span><span class="kw">RCT_predict</span>(</span>
<span id="cb243-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-14"></a>  model5, </span>
<span id="cb243-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-15"></a>  <span class="dt">new_data =</span> RCT_data,</span>
<span id="cb243-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-16"></a>  <span class="dt">outcome =</span> <span class="st">&quot;Measured_score.Post&quot;</span>,</span>
<span id="cb243-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-17"></a>  <span class="dt">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb243-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-18"></a>  <span class="dt">treatment_label =</span> <span class="st">&quot;Treatment&quot;</span>,</span>
<span id="cb243-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-19"></a>  <span class="dt">control_label =</span> <span class="st">&quot;Control&quot;</span>,</span>
<span id="cb243-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-20"></a>  <span class="dt">subject_label =</span> RCT_data<span class="op">$</span>Athlete</span>
<span id="cb243-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-21"></a>)</span>
<span id="cb243-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-22"></a></span>
<span id="cb243-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-23"></a>prediction_RCT</span>
<span id="cb243-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-24"></a><span class="co">#&gt; Training data consists of 3 predictors and 20 observations. Cross-Validation of the model was performed using 10 repeats of 3 folds.</span></span>
<span id="cb243-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-25"></a><span class="co">#&gt; </span></span>
<span id="cb243-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-26"></a><span class="co">#&gt; Model performance:</span></span>
<span id="cb243-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-27"></a><span class="co">#&gt; </span></span>
<span id="cb243-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-28"></a><span class="co">#&gt;         metric      training training.pooled testing.pooled        mean</span></span>
<span id="cb243-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-29"></a><span class="co">#&gt;            MBE -9.947541e-15    3.055367e-15     -0.1404122 -0.02732047</span></span>
<span id="cb243-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-30"></a><span class="co">#&gt;            MAE  3.175698e+00    3.037705e+00      3.8691755  3.90512133</span></span>
<span id="cb243-31"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-31"></a><span class="co">#&gt;           RMSE  3.959134e+00    3.786361e+00      4.7871794  4.73835660</span></span>
<span id="cb243-32"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-32"></a><span class="co">#&gt;           PPER  7.666283e-01    8.120334e-01      0.7012521  0.63888951</span></span>
<span id="cb243-33"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-33"></a><span class="co">#&gt;  SESOI to RMSE  2.525805e+00    2.641058e+00      2.0889127  2.17362777</span></span>
<span id="cb243-34"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-34"></a><span class="co">#&gt;      R-squared  6.289308e-01    6.606104e-01      0.4579491  0.21880124</span></span>
<span id="cb243-35"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-35"></a><span class="co">#&gt;         MinErr -7.921899e+00   -1.032365e+01    -10.0942651 -6.76317807</span></span>
<span id="cb243-36"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-36"></a><span class="co">#&gt;         MaxErr  6.582672e+00    8.806128e+00      9.2485263  6.05923474</span></span>
<span id="cb243-37"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-37"></a><span class="co">#&gt;      MaxAbsErr  7.921899e+00    1.032365e+01     10.0942651  8.02937811</span></span>
<span id="cb243-38"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-38"></a><span class="co">#&gt;          SD         min        max</span></span>
<span id="cb243-39"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-39"></a><span class="co">#&gt;  2.12193361  -3.5145897  3.3371789</span></span>
<span id="cb243-40"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-40"></a><span class="co">#&gt;  0.93683875   2.6186933  6.8884587</span></span>
<span id="cb243-41"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-41"></a><span class="co">#&gt;  0.85876892   3.4284211  7.2937938</span></span>
<span id="cb243-42"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-42"></a><span class="co">#&gt;  0.07928795   0.4413183  0.7862394</span></span>
<span id="cb243-43"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-43"></a><span class="co">#&gt;  0.37022957   1.3710286  2.9167945</span></span>
<span id="cb243-44"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-44"></a><span class="co">#&gt;  0.64551950  -1.5780914  0.7986431</span></span>
<span id="cb243-45"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-45"></a><span class="co">#&gt;  2.33015461 -10.0942651 -2.7453015</span></span>
<span id="cb243-46"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-46"></a><span class="co">#&gt;  2.11053360   0.1401500  9.2485263</span></span>
<span id="cb243-47"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-47"></a><span class="co">#&gt;  1.17919840   5.5787979 10.0942651</span></span>
<span id="cb243-48"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-48"></a><span class="co">#&gt; </span></span>
<span id="cb243-49"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-49"></a><span class="co">#&gt; Individual model results:</span></span>
<span id="cb243-50"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-50"></a><span class="co">#&gt; </span></span>
<span id="cb243-51"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-51"></a><span class="co">#&gt;     subject     group observed predicted   residual  magnitude counterfactual</span></span>
<span id="cb243-52"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-52"></a><span class="co">#&gt;  Athlete 01 Treatment 47.54084  54.12352  6.5826720     Higher       49.19697</span></span>
<span id="cb243-53"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-53"></a><span class="co">#&gt;  Athlete 02   Control 50.47892  47.33454 -3.1443811 Equivalent       52.26108</span></span>
<span id="cb243-54"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-54"></a><span class="co">#&gt;  Athlete 03 Treatment 58.19673  57.64224 -0.5544865 Equivalent       52.71569</span></span>
<span id="cb243-55"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-55"></a><span class="co">#&gt;  Athlete 04   Control 39.83268  40.93613  1.1034457 Equivalent       45.86267</span></span>
<span id="cb243-56"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-56"></a><span class="co">#&gt;  Athlete 05 Treatment 52.43478  56.13132  3.6965427 Equivalent       51.20477</span></span>
<span id="cb243-57"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-57"></a><span class="co">#&gt;  Athlete 06   Control 45.34422  45.12752 -0.2166979 Equivalent       50.05407</span></span>
<span id="cb243-58"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-58"></a><span class="co">#&gt;  Athlete 07 Treatment 53.97310  48.13585 -5.8372501      Lower       43.20931</span></span>
<span id="cb243-59"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-59"></a><span class="co">#&gt;  Athlete 08   Control 48.35425  47.34404 -1.0102111 Equivalent       52.27059</span></span>
<span id="cb243-60"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-60"></a><span class="co">#&gt;  Athlete 09 Treatment 65.05732  58.93766 -6.1196617      Lower       54.01111</span></span>
<span id="cb243-61"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-61"></a><span class="co">#&gt;  Athlete 10   Control 46.69332  50.18284  3.4895230 Equivalent       55.10938</span></span>
<span id="cb243-62"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-62"></a><span class="co">#&gt;  Athlete 11 Treatment 57.82698  58.90031  1.0733333 Equivalent       53.97377</span></span>
<span id="cb243-63"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-63"></a><span class="co">#&gt;  Athlete 12   Control 49.16140  48.36452 -0.7968803 Equivalent       53.29107</span></span>
<span id="cb243-64"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-64"></a><span class="co">#&gt;  Athlete 13 Treatment 46.24005  50.92561  4.6855567 Equivalent       45.99907</span></span>
<span id="cb243-65"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-65"></a><span class="co">#&gt;  Athlete 14   Control 57.44395  54.26840 -3.1755549 Equivalent       59.19494</span></span>
<span id="cb243-66"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-66"></a><span class="co">#&gt;  Athlete 15 Treatment 50.02857  56.51530  6.4867253     Higher       51.58875</span></span>
<span id="cb243-67"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-67"></a><span class="co">#&gt;  Athlete 16   Control 37.56101  41.57384  4.0128333 Equivalent       46.50039</span></span>
<span id="cb243-68"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-68"></a><span class="co">#&gt;  Athlete 17 Treatment 59.95868  52.03678 -7.9218991      Lower       47.11023</span></span>
<span id="cb243-69"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-69"></a><span class="co">#&gt;  Athlete 18   Control 49.31810  48.42968 -0.8884198 Equivalent       53.35623</span></span>
<span id="cb243-70"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-70"></a><span class="co">#&gt;  Athlete 19 Treatment 53.26809  51.17656 -2.0915325 Equivalent       46.25001</span></span>
<span id="cb243-71"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-71"></a><span class="co">#&gt;  Athlete 20   Control 53.52199  54.14833  0.6263431 Equivalent       59.07488</span></span>
<span id="cb243-72"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-72"></a><span class="co">#&gt;       pITE pITE_magnitude</span></span>
<span id="cb243-73"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-73"></a><span class="co">#&gt;  -4.926546     Equivalent</span></span>
<span id="cb243-74"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-74"></a><span class="co">#&gt;   4.926546     Equivalent</span></span>
<span id="cb243-75"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-75"></a><span class="co">#&gt;  -4.926546     Equivalent</span></span>
<span id="cb243-76"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-76"></a><span class="co">#&gt;   4.926546     Equivalent</span></span>
<span id="cb243-77"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-77"></a><span class="co">#&gt;  -4.926546     Equivalent</span></span>
<span id="cb243-78"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-78"></a><span class="co">#&gt;   4.926546     Equivalent</span></span>
<span id="cb243-79"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-79"></a><span class="co">#&gt;  -4.926546     Equivalent</span></span>
<span id="cb243-80"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-80"></a><span class="co">#&gt;   4.926546     Equivalent</span></span>
<span id="cb243-81"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-81"></a><span class="co">#&gt;  -4.926546     Equivalent</span></span>
<span id="cb243-82"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-82"></a><span class="co">#&gt;   4.926546     Equivalent</span></span>
<span id="cb243-83"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-83"></a><span class="co">#&gt;  -4.926546     Equivalent</span></span>
<span id="cb243-84"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-84"></a><span class="co">#&gt;   4.926546     Equivalent</span></span>
<span id="cb243-85"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-85"></a><span class="co">#&gt;  -4.926546     Equivalent</span></span>
<span id="cb243-86"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-86"></a><span class="co">#&gt;   4.926546     Equivalent</span></span>
<span id="cb243-87"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-87"></a><span class="co">#&gt;  -4.926546     Equivalent</span></span>
<span id="cb243-88"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-88"></a><span class="co">#&gt;   4.926546     Equivalent</span></span>
<span id="cb243-89"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-89"></a><span class="co">#&gt;  -4.926546     Equivalent</span></span>
<span id="cb243-90"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-90"></a><span class="co">#&gt;   4.926546     Equivalent</span></span>
<span id="cb243-91"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-91"></a><span class="co">#&gt;  -4.926546     Equivalent</span></span>
<span id="cb243-92"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-92"></a><span class="co">#&gt;   4.926546     Equivalent</span></span>
<span id="cb243-93"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-93"></a><span class="co">#&gt; </span></span>
<span id="cb243-94"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-94"></a><span class="co">#&gt; Summary of residuals per RCT group:</span></span>
<span id="cb243-95"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-95"></a><span class="co">#&gt; </span></span>
<span id="cb243-96"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-96"></a><span class="co">#&gt;      group          mean       SD</span></span>
<span id="cb243-97"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-97"></a><span class="co">#&gt;    Control -9.237121e-15 2.411836</span></span>
<span id="cb243-98"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-98"></a><span class="co">#&gt;  Treatment -1.065814e-14 5.386633</span></span>
<span id="cb243-99"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-99"></a><span class="co">#&gt; </span></span>
<span id="cb243-100"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-100"></a><span class="co">#&gt; Summary of counterfactual effects of RCT group:</span></span>
<span id="cb243-101"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-101"></a><span class="co">#&gt; </span></span>
<span id="cb243-102"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-102"></a><span class="co">#&gt;      group      pATE pVTE</span></span>
<span id="cb243-103"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-103"></a><span class="co">#&gt;  Treatment -4.926546    0</span></span>
<span id="cb243-104"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-104"></a><span class="co">#&gt;    Control  4.926546    0</span></span>
<span id="cb243-105"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb243-105"></a><span class="co">#&gt;     pooled  4.926546    0</span></span></code></pre></div>
<p>The prediction performance in this case is much worse (compared to previous RCT example), since now there are systematic and random treatment and non-treatment effects. Although we can <em>explain</em> the RCT components, we cannot use it to predict individual responses.</p>
<p>Let’s check the individual predictions:</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb244-1"></a><span class="kw">plot</span>(prediction_RCT, <span class="st">&quot;prediction&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-66-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can now see that certain residuals are larger than SESOI (indicated by green or red color on the figure).</p>
<p>Here is the PDP+ICE plot:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb245-1"></a><span class="kw">plot</span>(prediction_RCT, <span class="st">&quot;pdp+ice&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-67-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Parallel lines indicate that we predict that each individual will have same treatment effect (indicated by <code>pVTE</code> as well as with the arrows of same length in the counterfactual plot that follows). If we plot PDP+ICE for the measured Pre-test, we will get the following figure:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb246-1"></a><span class="kw">plot</span>(prediction_RCT, <span class="st">&quot;pdp+ice&quot;</span>, <span class="dt">predictor =</span> <span class="st">&quot;Measured_score.Pre&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb246-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb246-2"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-68-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Two thin lines indicate two groups and the gap between them represents the systematic treatment effect.</p>
<p>Estimating individual counterfactual effects when switching group:</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb247-1"></a><span class="kw">plot</span>(prediction_RCT, <span class="st">&quot;counterfactual&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-69-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>As can be seen, counterfactual plot depicts same treatment effect for every individual.</p>
</div>
<div id="making-it-more-complex-by-adding-covariate" class="section level2" number="16.8">
<h2><span class="header-section-number">16.8</span> Making it more complex by adding covariate</h2>
<p>To make this more complex, let’s assume that besides randomizing athletes to Treatment and Control group, we have also measured their lower body strength using relative back squat 1RM. This variable represents our covariate, and we can expect (i.e. we hypothesize) that individuals with higher relative strength will manifest bigger improvements from the plyometric intervention.</p>
<p>The following code represented DGP, where the effects of the training intervention depend on the 1RM squat (i.e. the higher the relative squat, the higher the training intervention). But on top of that, we are going to reduce the improvement based on the initial jump height (i.e. the higher someone jumps, the less improvement over time). It is assumed that squat 1RM and Pre-training jump height are unrelated (independent). Random components of the treatment and non-treatment effects are zero, and the only variance in the measured scores is due to biological noise and instrumentation error.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-1"></a><span class="kw">set.seed</span>(<span class="dv">16</span>)</span>
<span id="cb248-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-2"></a></span>
<span id="cb248-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-3"></a>n_subjects &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb248-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-4"></a></span>
<span id="cb248-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-5"></a><span class="co"># These stay the same</span></span>
<span id="cb248-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-6"></a>instrumentation_noise &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb248-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-7"></a>biological_variation &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb248-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-8"></a></span>
<span id="cb248-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-9"></a><span class="co"># -------------------------</span></span>
<span id="cb248-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-10"></a><span class="co"># These are not used in this DGP</span></span>
<span id="cb248-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-11"></a><span class="co"># Treatment effect</span></span>
<span id="cb248-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-12"></a>treatment_systematic &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb248-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-13"></a>treatment_random &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb248-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-14"></a></span>
<span id="cb248-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-15"></a><span class="co"># Non-treatment effect</span></span>
<span id="cb248-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-16"></a>non_treatment_systematic &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb248-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-17"></a>non_treatment_random &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb248-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-18"></a><span class="co">#-------------------------</span></span>
<span id="cb248-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-19"></a></span>
<span id="cb248-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-20"></a>RCT_data &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb248-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-21"></a>  <span class="dt">Athlete =</span> <span class="kw">paste</span>(</span>
<span id="cb248-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-22"></a>    <span class="st">&quot;Athlete&quot;</span>,</span>
<span id="cb248-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-23"></a>    <span class="kw">str_pad</span>(</span>
<span id="cb248-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-24"></a>      <span class="dt">string =</span> <span class="kw">seq</span>(<span class="dv">1</span>, n_subjects),</span>
<span id="cb248-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-25"></a>      <span class="dt">width =</span> <span class="dv">2</span>,</span>
<span id="cb248-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-26"></a>      <span class="dt">pad =</span> <span class="st">&quot;0&quot;</span></span>
<span id="cb248-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-27"></a>    )</span>
<span id="cb248-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-28"></a>  ),</span>
<span id="cb248-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-29"></a>  <span class="dt">Group =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Treatment&quot;</span>, <span class="st">&quot;Control&quot;</span>), <span class="dt">length.out =</span> n_subjects),</span>
<span id="cb248-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-30"></a></span>
<span id="cb248-31"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-31"></a>  <span class="co"># Strength covariate</span></span>
<span id="cb248-32"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-32"></a>  <span class="dt">Squat_1RM_relative =</span> <span class="kw">rnorm</span>(n_subjects, <span class="dv">1</span>, <span class="fl">0.4</span>),</span>
<span id="cb248-33"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-33"></a>  <span class="co"># True score</span></span>
<span id="cb248-34"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-34"></a>  <span class="dt">True_score.Pre =</span> <span class="kw">rnorm</span>(n_subjects, <span class="dv">45</span>, <span class="dv">5</span>),</span>
<span id="cb248-35"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-35"></a></span>
<span id="cb248-36"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-36"></a>  <span class="co"># Treatment effect</span></span>
<span id="cb248-37"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-37"></a>  <span class="dt">Treatment_effect =</span> (<span class="dv">10</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.002</span> <span class="op">*</span><span class="st"> </span>True_score.Pre<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>Squat_1RM_relative,</span>
<span id="cb248-38"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-38"></a>  <span class="dt">Non_treatment_effect =</span> <span class="dv">15</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.005</span> <span class="op">*</span><span class="st"> </span>True_score.Pre<span class="op">^</span><span class="dv">2</span>,</span>
<span id="cb248-39"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-39"></a></span>
<span id="cb248-40"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-40"></a>  <span class="co"># Calculate the change in true score</span></span>
<span id="cb248-41"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-41"></a>  <span class="dt">True_score.Change =</span> <span class="kw">if_else</span>(</span>
<span id="cb248-42"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-42"></a>    Group <span class="op">==</span><span class="st"> &quot;Treatment&quot;</span>,</span>
<span id="cb248-43"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-43"></a>    <span class="co"># Treatment group is a sum of treatment and non-treatment effects</span></span>
<span id="cb248-44"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-44"></a>    Treatment_effect <span class="op">+</span><span class="st"> </span>Non_treatment_effect,</span>
<span id="cb248-45"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-45"></a>    <span class="co"># While control group only get non-treatment effects</span></span>
<span id="cb248-46"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-46"></a>    Non_treatment_effect</span>
<span id="cb248-47"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-47"></a>  ),</span>
<span id="cb248-48"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-48"></a>  </span>
<span id="cb248-49"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-49"></a>  <span class="dt">True_score.Post =</span> True_score.Pre <span class="op">+</span><span class="st"> </span>True_score.Change,</span>
<span id="cb248-50"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-50"></a></span>
<span id="cb248-51"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-51"></a>  <span class="co"># Manifested score</span></span>
<span id="cb248-52"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-52"></a>  <span class="dt">Manifested_score.Pre =</span> True_score.Pre <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, biological_variation),</span>
<span id="cb248-53"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-53"></a>  <span class="dt">Manifested_score.Post =</span> True_score.Post <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, biological_variation),</span>
<span id="cb248-54"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-54"></a>  <span class="dt">Manifested_score.Change =</span> Manifested_score.Post <span class="op">-</span><span class="st"> </span>Manifested_score.Pre,</span>
<span id="cb248-55"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-55"></a></span>
<span id="cb248-56"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-56"></a>  <span class="co"># Measured score</span></span>
<span id="cb248-57"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-57"></a>  <span class="dt">Measured_score.Pre =</span> Manifested_score.Pre <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, instrumentation_noise),</span>
<span id="cb248-58"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-58"></a>  <span class="dt">Measured_score.Post =</span> Manifested_score.Post <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, instrumentation_noise),</span>
<span id="cb248-59"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-59"></a>  <span class="dt">Measured_score.Change =</span> Measured_score.Post <span class="op">-</span><span class="st"> </span>Measured_score.Pre</span>
<span id="cb248-60"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-60"></a>)</span>
<span id="cb248-61"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-61"></a></span>
<span id="cb248-62"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-62"></a><span class="kw">head</span>(RCT_data)</span>
<span id="cb248-63"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-63"></a><span class="co">#&gt; # A tibble: 6 x 14</span></span>
<span id="cb248-64"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-64"></a><span class="co">#&gt;   Athlete Group Squat_1RM_relat… True_score.Pre Treatment_effect</span></span>
<span id="cb248-65"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-65"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;            &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb248-66"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-66"></a><span class="co">#&gt; 1 Athlet… Trea…            1.19            36.8             9.88</span></span>
<span id="cb248-67"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-67"></a><span class="co">#&gt; 2 Athlet… Cont…            0.950           43.4             6.87</span></span>
<span id="cb248-68"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-68"></a><span class="co">#&gt; 3 Athlet… Trea…            1.44            44.1            10.2 </span></span>
<span id="cb248-69"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-69"></a><span class="co">#&gt; 4 Athlet… Cont…            0.422           52.4             2.33</span></span>
<span id="cb248-70"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-70"></a><span class="co">#&gt; 5 Athlet… Trea…            1.46            40.7            11.2 </span></span>
<span id="cb248-71"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-71"></a><span class="co">#&gt; 6 Athlet… Cont…            0.813           52.6             4.44</span></span>
<span id="cb248-72"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-72"></a><span class="co">#&gt; # … with 9 more variables: Non_treatment_effect &lt;dbl&gt;, True_score.Change &lt;dbl&gt;,</span></span>
<span id="cb248-73"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-73"></a><span class="co">#&gt; #   True_score.Post &lt;dbl&gt;, Manifested_score.Pre &lt;dbl&gt;,</span></span>
<span id="cb248-74"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-74"></a><span class="co">#&gt; #   Manifested_score.Post &lt;dbl&gt;, Manifested_score.Change &lt;dbl&gt;,</span></span>
<span id="cb248-75"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-75"></a><span class="co">#&gt; #   Measured_score.Pre &lt;dbl&gt;, Measured_score.Post &lt;dbl&gt;,</span></span>
<span id="cb248-76"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb248-76"></a><span class="co">#&gt; #   Measured_score.Change &lt;dbl&gt;</span></span></code></pre></div>
<p><em>To be continued</em></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="validity-and-reliability.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix-a-dorem-package.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mladenjovanovic/bmbstats-book/16-RCT-analysis-prediction.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

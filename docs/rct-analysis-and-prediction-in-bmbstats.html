<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 RCT analysis and prediction in bmbstats | bmbstats: bootstrap magnitude-based statistics for sports scientists</title>
  <meta name="description" content="Chapter 16 RCT analysis and prediction in bmbstats | bmbstats: bootstrap magnitude-based statistics for sports scientists" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 RCT analysis and prediction in bmbstats | bmbstats: bootstrap magnitude-based statistics for sports scientists" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="www.complementarytraining.net" />
  
  
  <meta name="github-repo" content="mladenjovanovic/bmbstats-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 RCT analysis and prediction in bmbstats | bmbstats: bootstrap magnitude-based statistics for sports scientists" />
  <meta name="twitter:site" content="@physical_prep" />
  
  

<meta name="author" content="Mladen Jovanovic" />


<meta name="date" content="2020-07-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="validity-and-reliability.html"/>
<link rel="next" href="appendix-a-dorem-package.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="adv-r.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">bmbstats book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-and-r-packages"><i class="fa fa-check"></i>R and R packages</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="part"><span><b>I Part One</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="description.html"><a href="description.html"><i class="fa fa-check"></i><b>2</b> Description</a>
<ul>
<li class="chapter" data-level="2.1" data-path="description.html"><a href="description.html#comparing-two-independent-groups"><i class="fa fa-check"></i><b>2.1</b> Comparing two independent groups</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="description.html"><a href="description.html#sample-mean-as-the-simplest-statistical-model"><i class="fa fa-check"></i><b>2.1.1</b> Sample <code>mean</code> as the simplest statistical model</a></li>
<li class="chapter" data-level="2.1.2" data-path="description.html"><a href="description.html#effect-sizes"><i class="fa fa-check"></i><b>2.1.2</b> Effect Sizes</a></li>
<li class="chapter" data-level="2.1.3" data-path="description.html"><a href="description.html#the-smallest-effect-size-of-interest"><i class="fa fa-check"></i><b>2.1.3</b> The Smallest Effect Size Of Interest</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="description.html"><a href="description.html#comparing-dependent-groups"><i class="fa fa-check"></i><b>2.2</b> Comparing dependent groups</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="description.html"><a href="description.html#describing-groups-as-independent"><i class="fa fa-check"></i><b>2.2.1</b> Describing groups as independent</a></li>
<li class="chapter" data-level="2.2.2" data-path="description.html"><a href="description.html#effect-sizes-1"><i class="fa fa-check"></i><b>2.2.2</b> Effect Sizes</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="description.html"><a href="description.html#describing-relationship-between-two-variables"><i class="fa fa-check"></i><b>2.3</b> Describing relationship between two variables</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="description.html"><a href="description.html#magnitude-based-estimators"><i class="fa fa-check"></i><b>2.3.1</b> Magnitude-based estimators</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="description.html"><a href="description.html#advanced-uses"><i class="fa fa-check"></i><b>2.4</b> Advanced uses</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="prediction.html"><a href="prediction.html"><i class="fa fa-check"></i><b>3</b> Prediction</a>
<ul>
<li class="chapter" data-level="3.1" data-path="prediction.html"><a href="prediction.html#overfitting"><i class="fa fa-check"></i><b>3.1</b> Overfitting</a></li>
<li class="chapter" data-level="3.2" data-path="prediction.html"><a href="prediction.html#cross-validation"><i class="fa fa-check"></i><b>3.2</b> Cross-Validation</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="prediction.html"><a href="prediction.html#sample-mean-as-the-simplest-predictive-model"><i class="fa fa-check"></i><b>3.2.1</b> Sample <code>mean</code> as the simplest predictive model</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="prediction.html"><a href="prediction.html#bias-variance-decomposition-and-trade-off"><i class="fa fa-check"></i><b>3.3</b> Bias-Variance decomposition and trade-off</a></li>
<li class="chapter" data-level="3.4" data-path="prediction.html"><a href="prediction.html#interpretability"><i class="fa fa-check"></i><b>3.4</b> Interpretability</a></li>
<li class="chapter" data-level="3.5" data-path="prediction.html"><a href="prediction.html#magnitude-based-prediction-estimators"><i class="fa fa-check"></i><b>3.5</b> Magnitude-based prediction estimators</a></li>
<li class="chapter" data-level="3.6" data-path="prediction.html"><a href="prediction.html#practical-example-mas-and-yoyoir1-prediction"><i class="fa fa-check"></i><b>3.6</b> Practical example: MAS and YoYoIR1 prediction</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="prediction.html"><a href="prediction.html#predicting-mas-from-yoyoir1"><i class="fa fa-check"></i><b>3.6.1</b> Predicting MAS from YoYoIR1</a></li>
<li class="chapter" data-level="3.6.2" data-path="prediction.html"><a href="prediction.html#predicting-yoyoir1-from-mas"><i class="fa fa-check"></i><b>3.6.2</b> Predicting YoYoIR1 from MAS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="causal-inference.html"><a href="causal-inference.html"><i class="fa fa-check"></i><b>4</b> Causal inference</a>
<ul>
<li class="chapter" data-level="4.1" data-path="causal-inference.html"><a href="causal-inference.html#necessary-versus-sufficient-causality"><i class="fa fa-check"></i><b>4.1</b> Necessary versus sufficient causality</a></li>
<li class="chapter" data-level="4.2" data-path="causal-inference.html"><a href="causal-inference.html#observational-data"><i class="fa fa-check"></i><b>4.2</b> Observational data</a></li>
<li class="chapter" data-level="4.3" data-path="causal-inference.html"><a href="causal-inference.html#potential-outcomes-or-counterfactuals"><i class="fa fa-check"></i><b>4.3</b> Potential outcomes or counterfactuals</a></li>
<li class="chapter" data-level="4.4" data-path="causal-inference.html"><a href="causal-inference.html#ceteris-paribus-and-the-biases"><i class="fa fa-check"></i><b>4.4</b> <em>Ceteris paribus</em> and the biases</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="causal-inference.html"><a href="causal-inference.html#randomization"><i class="fa fa-check"></i><b>4.4.1</b> Randomization</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="causal-inference.html"><a href="causal-inference.html#subject-matter-knowledge"><i class="fa fa-check"></i><b>4.5</b> Subject matter knowledge</a></li>
<li class="chapter" data-level="4.6" data-path="causal-inference.html"><a href="causal-inference.html#example-of-randomized-control-trial"><i class="fa fa-check"></i><b>4.6</b> Example of randomized control trial</a></li>
<li class="chapter" data-level="4.7" data-path="causal-inference.html"><a href="causal-inference.html#prediction-as-a-complement-to-causal-inference"><i class="fa fa-check"></i><b>4.7</b> Prediction as a complement to causal inference</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="causal-inference.html"><a href="causal-inference.html#analysis-of-the-individual-residuals-responders-vs-non-responders"><i class="fa fa-check"></i><b>4.7.1</b> Analysis of the individual residuals: responders vs non-responders</a></li>
<li class="chapter" data-level="4.7.2" data-path="causal-inference.html"><a href="causal-inference.html#counterfactual-analysis-and-individual-treatment-effects"><i class="fa fa-check"></i><b>4.7.2</b> Counterfactual analysis and Individual Treatment Effects</a></li>
<li class="chapter" data-level="4.7.3" data-path="causal-inference.html"><a href="causal-inference.html#direct-and-indirect-effect-covariates-and-then-some"><i class="fa fa-check"></i><b>4.7.3</b> Direct and indirect effect, covariates and then some</a></li>
<li class="chapter" data-level="4.7.4" data-path="causal-inference.html"><a href="causal-inference.html#model-selection"><i class="fa fa-check"></i><b>4.7.4</b> Model selection</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="causal-inference.html"><a href="causal-inference.html#ergodicity"><i class="fa fa-check"></i><b>4.8</b> Ergodicity</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>5</b> Statistical inference</a>
<ul>
<li class="chapter" data-level="5.1" data-path="statistical-inference.html"><a href="statistical-inference.html#two-kinds-of-uncertainty-two-kinds-of-probability-two-kinds-of-statistical-inference"><i class="fa fa-check"></i><b>5.1</b> Two kinds of uncertainty, two kinds of probability, two kinds of statistical inference</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html"><i class="fa fa-check"></i><b>6</b> Frequentist perspective</a>
<ul>
<li class="chapter" data-level="6.1" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html#null-hypothesis-significance-testing"><i class="fa fa-check"></i><b>6.1</b> Null-Hypothesis Significance Testing</a></li>
<li class="chapter" data-level="6.2" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html#statistical-power"><i class="fa fa-check"></i><b>6.2</b> Statistical Power</a></li>
<li class="chapter" data-level="6.3" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html#new-statistics-confidence-intervals-and-estimation"><i class="fa fa-check"></i><b>6.3</b> New Statistics: Confidence Intervals and Estimation</a></li>
<li class="chapter" data-level="6.4" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html#minimum-effect-tests"><i class="fa fa-check"></i><b>6.4</b> Minimum Effect Tests</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html#individual-vs.-parameter-sesoi"><i class="fa fa-check"></i><b>6.4.1</b> Individual vs. Parameter SESOI</a></li>
<li class="chapter" data-level="6.4.2" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html#two-one-sided-tests-of-equivalence"><i class="fa fa-check"></i><b>6.4.2</b> Two one-sided tests of equivalence</a></li>
<li class="chapter" data-level="6.4.3" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html#superiority-and-non-inferiority"><i class="fa fa-check"></i><b>6.4.3</b> Superiority and Non-Inferiority</a></li>
<li class="chapter" data-level="6.4.4" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html#inferiority-and-non-superiority"><i class="fa fa-check"></i><b>6.4.4</b> Inferiority and Non-Superiority</a></li>
<li class="chapter" data-level="6.4.5" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html#inference-from-mets"><i class="fa fa-check"></i><b>6.4.5</b> Inference from METs</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="frequentist-perspective.html"><a href="frequentist-perspective.html#magnitude-based-inference"><i class="fa fa-check"></i><b>6.5</b> Magnitude Based Inference</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="bayesian-perspective.html"><a href="bayesian-perspective.html"><i class="fa fa-check"></i><b>7</b> Bayesian perspective</a>
<ul>
<li class="chapter" data-level="7.1" data-path="bayesian-perspective.html"><a href="bayesian-perspective.html#grid-approximation"><i class="fa fa-check"></i><b>7.1</b> Grid approximation</a></li>
<li class="chapter" data-level="7.2" data-path="bayesian-perspective.html"><a href="bayesian-perspective.html#priors"><i class="fa fa-check"></i><b>7.2</b> Priors</a></li>
<li class="chapter" data-level="7.3" data-path="bayesian-perspective.html"><a href="bayesian-perspective.html#likelihood-function"><i class="fa fa-check"></i><b>7.3</b> Likelihood function</a></li>
<li class="chapter" data-level="7.4" data-path="bayesian-perspective.html"><a href="bayesian-perspective.html#posterior-probability"><i class="fa fa-check"></i><b>7.4</b> Posterior probability</a></li>
<li class="chapter" data-level="7.5" data-path="bayesian-perspective.html"><a href="bayesian-perspective.html#adding-more-possibilities"><i class="fa fa-check"></i><b>7.5</b> Adding more possibilities</a></li>
<li class="chapter" data-level="7.6" data-path="bayesian-perspective.html"><a href="bayesian-perspective.html#different-prior"><i class="fa fa-check"></i><b>7.6</b> Different prior</a></li>
<li class="chapter" data-level="7.7" data-path="bayesian-perspective.html"><a href="bayesian-perspective.html#more-data"><i class="fa fa-check"></i><b>7.7</b> More data</a></li>
<li class="chapter" data-level="7.8" data-path="bayesian-perspective.html"><a href="bayesian-perspective.html#summarizing-prior-and-posterior-distributions-with-map-and-hdi"><i class="fa fa-check"></i><b>7.8</b> Summarizing prior and posterior distributions with MAP and HDI</a></li>
<li class="chapter" data-level="7.9" data-path="bayesian-perspective.html"><a href="bayesian-perspective.html#comparison-to-nhst-type-i-errors"><i class="fa fa-check"></i><b>7.9</b> Comparison to NHST Type I errors</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i><b>8</b> Bootstrap</a>
<ul>
<li class="chapter" data-level="8.1" data-path="bootstrap.html"><a href="bootstrap.html#summarizing-bootstrap-distribution"><i class="fa fa-check"></i><b>8.1</b> Summarizing bootstrap distribution</a></li>
<li class="chapter" data-level="8.2" data-path="bootstrap.html"><a href="bootstrap.html#bootstrap-type-i-errors"><i class="fa fa-check"></i><b>8.2</b> Bootstrap Type I errors</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistical-inference-conclusion.html"><a href="statistical-inference-conclusion.html"><i class="fa fa-check"></i><b>9</b> Statistical inference conclusion</a></li>
<li class="chapter" data-level="10" data-path="measurement-error.html"><a href="measurement-error.html"><i class="fa fa-check"></i><b>10</b> Measurement Error</a>
<ul>
<li class="chapter" data-level="10.1" data-path="measurement-error.html"><a href="measurement-error.html#estimating-te-using-ordinary-least-products-regression"><i class="fa fa-check"></i><b>10.1</b> Estimating <code>TE</code> using <em>ordinary least products</em> regression</a></li>
<li class="chapter" data-level="10.2" data-path="measurement-error.html"><a href="measurement-error.html#smallest-detectable-change"><i class="fa fa-check"></i><b>10.2</b> Smallest Detectable Change</a></li>
<li class="chapter" data-level="10.3" data-path="measurement-error.html"><a href="measurement-error.html#interpreting-individual-changes-using-sesoi-and-sdc"><i class="fa fa-check"></i><b>10.3</b> Interpreting individual changes using SESOI and SDC</a></li>
<li class="chapter" data-level="10.4" data-path="measurement-error.html"><a href="measurement-error.html#what-to-do-when-we-know-the-error"><i class="fa fa-check"></i><b>10.4</b> What to do when we know the error?</a></li>
<li class="chapter" data-level="10.5" data-path="measurement-error.html"><a href="measurement-error.html#extending-the-classical-test-theory"><i class="fa fa-check"></i><b>10.5</b> Extending the Classical Test Theory</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>11</b> Conclusion</a></li>
<li class="part"><span><b>II Part Two</b></span></li>
<li class="chapter" data-level="12" data-path="bmbstats-bootstrap-magnitude-based-statistics-package.html"><a href="bmbstats-bootstrap-magnitude-based-statistics-package.html"><i class="fa fa-check"></i><b>12</b> <code>bmbstats</code>: Bootstrap Magnitude-based Statistics package</a>
<ul>
<li class="chapter" data-level="12.1" data-path="bmbstats-bootstrap-magnitude-based-statistics-package.html"><a href="bmbstats-bootstrap-magnitude-based-statistics-package.html#installation"><i class="fa fa-check"></i><b>12.1</b> Installation</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html"><i class="fa fa-check"></i><b>13</b> Descriptive tasks using <code>bmbstats</code></a>
<ul>
<li class="chapter" data-level="13.1" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html#generating-height-data"><i class="fa fa-check"></i><b>13.1</b> Generating <em>height data</em></a></li>
<li class="chapter" data-level="13.2" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html#visualization-and-analysis-of-a-single-groupvariable"><i class="fa fa-check"></i><b>13.2</b> Visualization and analysis of a single group/variable</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html#using-your-own-estimators"><i class="fa fa-check"></i><b>13.2.1</b> Using your own estimators</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html#visualization-and-analysis-of-the-two-independent-groups"><i class="fa fa-check"></i><b>13.3</b> Visualization and analysis of the two independent groups</a></li>
<li class="chapter" data-level="13.4" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html#nhst-mets-and-mbi-functions"><i class="fa fa-check"></i><b>13.4</b> NHST, METs and MBI functions</a></li>
<li class="chapter" data-level="13.5" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html#comparing-two-dependent-groups"><i class="fa fa-check"></i><b>13.5</b> Comparing two dependent groups</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html#measurement-error-issues"><i class="fa fa-check"></i><b>13.5.1</b> Measurement error issues</a></li>
<li class="chapter" data-level="13.5.2" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html#analysis-of-the-dependent-groups-using-bmbstatscompare_dependent_groups"><i class="fa fa-check"></i><b>13.5.2</b> Analysis of the dependent groups using <code>bmbstats::compare_dependent_groups</code></a></li>
<li class="chapter" data-level="13.5.3" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html#statistical-tests"><i class="fa fa-check"></i><b>13.5.3</b> Statistical tests</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="descriptive-tasks-using-bmbstats.html"><a href="descriptive-tasks-using-bmbstats.html#describing-relationship-between-two-groups"><i class="fa fa-check"></i><b>13.6</b> Describing relationship between two groups</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="predictive-tasks-using-bmbstats.html"><a href="predictive-tasks-using-bmbstats.html"><i class="fa fa-check"></i><b>14</b> Predictive tasks using <code>bmbstats</code></a>
<ul>
<li class="chapter" data-level="14.1" data-path="predictive-tasks-using-bmbstats.html"><a href="predictive-tasks-using-bmbstats.html#how-to-implement-different-performance-metrics"><i class="fa fa-check"></i><b>14.1</b> How to implement different performance metrics?</a></li>
<li class="chapter" data-level="14.2" data-path="predictive-tasks-using-bmbstats.html"><a href="predictive-tasks-using-bmbstats.html#how-to-use-different-prediction-model"><i class="fa fa-check"></i><b>14.2</b> How to use different prediction model?</a></li>
<li class="chapter" data-level="14.3" data-path="predictive-tasks-using-bmbstats.html"><a href="predictive-tasks-using-bmbstats.html#example-of-using-tuning-parameter"><i class="fa fa-check"></i><b>14.3</b> Example of using tuning parameter</a></li>
<li class="chapter" data-level="14.4" data-path="predictive-tasks-using-bmbstats.html"><a href="predictive-tasks-using-bmbstats.html#plotting"><i class="fa fa-check"></i><b>14.4</b> Plotting</a></li>
<li class="chapter" data-level="14.5" data-path="predictive-tasks-using-bmbstats.html"><a href="predictive-tasks-using-bmbstats.html#comparing-models"><i class="fa fa-check"></i><b>14.5</b> Comparing models</a></li>
<li class="chapter" data-level="14.6" data-path="predictive-tasks-using-bmbstats.html"><a href="predictive-tasks-using-bmbstats.html#bootstrapping-model"><i class="fa fa-check"></i><b>14.6</b> Bootstrapping model</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html"><i class="fa fa-check"></i><b>15</b> Validity and Reliability</a>
<ul>
<li class="chapter" data-level="15.1" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#data-generation"><i class="fa fa-check"></i><b>15.1</b> Data generation</a></li>
<li class="chapter" data-level="15.2" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#validity"><i class="fa fa-check"></i><b>15.2</b> Validity</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#true-vs-criterion"><i class="fa fa-check"></i><b>15.2.1</b> True vs Criterion</a></li>
<li class="chapter" data-level="15.2.2" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#practical-vs-criterion"><i class="fa fa-check"></i><b>15.2.2</b> Practical vs Criterion</a></li>
<li class="chapter" data-level="15.2.3" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#prediction-approach"><i class="fa fa-check"></i><b>15.2.3</b> Prediction approach</a></li>
<li class="chapter" data-level="15.2.4" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#can-we-adjust-for-the-know-criterion-measure-random-error"><i class="fa fa-check"></i><b>15.2.4</b> Can we adjust for the know criterion measure random error?</a></li>
<li class="chapter" data-level="15.2.5" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#estimating-sesoi-for-the-practical-score"><i class="fa fa-check"></i><b>15.2.5</b> Estimating SESOI for the practical score</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#reliability"><i class="fa fa-check"></i><b>15.3</b> Reliability</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#reproducibility"><i class="fa fa-check"></i><b>15.3.1</b> Reproducibility</a></li>
<li class="chapter" data-level="15.3.2" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#repeatability"><i class="fa fa-check"></i><b>15.3.2</b> Repeatability</a></li>
<li class="chapter" data-level="15.3.3" data-path="validity-and-reliability.html"><a href="validity-and-reliability.html#the-difference-between-reproducibility-and-repeatability"><i class="fa fa-check"></i><b>15.3.3</b> The difference between Reproducibility and Repeatability</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="rct-analysis-and-prediction-in-bmbstats.html"><a href="rct-analysis-and-prediction-in-bmbstats.html"><i class="fa fa-check"></i><b>16</b> RCT analysis and prediction in <code>bmbstats</code></a>
<ul>
<li class="chapter" data-level="16.1" data-path="rct-analysis-and-prediction-in-bmbstats.html"><a href="rct-analysis-and-prediction-in-bmbstats.html#data-generating-process-behind-rct"><i class="fa fa-check"></i><b>16.1</b> Data Generating Process behind RCT</a></li>
<li class="chapter" data-level="16.2" data-path="rct-analysis-and-prediction-in-bmbstats.html"><a href="rct-analysis-and-prediction-in-bmbstats.html#rct-analysis-using-bmbstatsrct_analysis-function"><i class="fa fa-check"></i><b>16.2</b> RCT analysis using <code>bmbstats::RCT_analysis</code> function</a></li>
<li class="chapter" data-level="16.3" data-path="rct-analysis-and-prediction-in-bmbstats.html"><a href="rct-analysis-and-prediction-in-bmbstats.html#adding-some-effects"><i class="fa fa-check"></i><b>16.3</b> Adding some effects</a></li>
<li class="chapter" data-level="16.4" data-path="rct-analysis-and-prediction-in-bmbstats.html"><a href="rct-analysis-and-prediction-in-bmbstats.html#what-goes-inside-the-measurement-error"><i class="fa fa-check"></i><b>16.4</b> What goes inside the <em>measurement error</em>?</a></li>
<li class="chapter" data-level="16.5" data-path="rct-analysis-and-prediction-in-bmbstats.html"><a href="rct-analysis-and-prediction-in-bmbstats.html#prediction-perspective"><i class="fa fa-check"></i><b>16.5</b> Prediction perspective</a></li>
</ul></li>
<li><a href="appendix-a-dorem-package.html#appendix-a-dorem-package">Appendix A: <code>dorem</code> package</a></li>
<li><a href="appendix-b-shorts-package.html#appendix-b-shorts-package">Appendix B: <code>shorts</code> package</a></li>
<li class="chapter" data-level="" data-path="appendix-c-recommended-material.html"><a href="appendix-c-recommended-material.html"><i class="fa fa-check"></i>Appendix C: Recommended material</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">bmbstats: bootstrap magnitude-based statistics for sports scientists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rct-analysis-and-prediction-in-bmbstats" class="section level1" number="16">
<h1><span class="header-section-number">Chapter 16</span> RCT analysis and prediction in <code>bmbstats</code></h1>
<p>In this chapter I will demonstrate how to analyze simple randomized controlled trials (RCTs) from both explanatory and predictive perspectives using <code>bmbstats</code> package and functions. As a refresher, please consider re-reading <a href="causal-inference.html#causal-inference">Causal inference</a> chapter.</p>
<div id="data-generating-process-behind-rct" class="section level2" number="16.1">
<h2><span class="header-section-number">16.1</span> Data Generating Process behind RCT</h2>
<p>The following image is re-posted from the <a href="causal-inference.html#causal-inference">Causal inference</a> chapter, outlining Treatment and Non-Treatment effects.</p>
<p><img src="figures/treatment-and-non-treatment-effects.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Let’s consider the following RCT DGP. We have two group (Control and Treatment), each with N=10 athletes, measured twice (Pre-test and Post-test) on the vertical jump height, using a measuring device with a known measurement error (i.e. only instrumentation noise; see <a href="validity-and-reliability.html#validity-and-reliability">Validity and Reliability</a> chapter for more info) estimated through validity and reliability studies and equal to 0.5cm. Control group are doing their normal training for 4 weeks, while Treatment group is doing EMS stimulation of their calf muscles on top of their normal training.</p>
<p>Since this is DGP, we will assume there is no treatment effect nor non-treatment effects. Both Control and Treatment groups will experience normal biological variation in their jump height, which is equal to 1.5cm. Please refer to <a href="validity-and-reliability.html#validity-and-reliability">Validity and Reliability</a> chapter for more info about the concepts of true score and measurement error. SESOI for the measured score will be ±5cm (since there is no proportional bias in the measurement, this will also be SESOI for the true score - see previous chapter for more information).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-1"></a><span class="kw">require</span>(tidyverse)</span>
<span id="cb2-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-2"></a><span class="kw">require</span>(bmbstats)</span>
<span id="cb2-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-3"></a><span class="kw">require</span>(cowplot)</span>
<span id="cb2-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-4"></a></span>
<span id="cb2-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-5"></a><span class="kw">set.seed</span>(<span class="dv">1667</span>)</span>
<span id="cb2-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-6"></a></span>
<span id="cb2-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-7"></a>n_subjects &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb2-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-8"></a></span>
<span id="cb2-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-9"></a></span>
<span id="cb2-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-10"></a>instrumentation_noise &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb2-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-11"></a>biological_variation &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb2-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-12"></a></span>
<span id="cb2-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-13"></a><span class="co"># -------------------------</span></span>
<span id="cb2-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-14"></a><span class="co"># Treatment effect</span></span>
<span id="cb2-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-15"></a>treatment_systematic &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb2-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-16"></a>treatment_random &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb2-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-17"></a></span>
<span id="cb2-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-18"></a><span class="co"># Non-treatment effect</span></span>
<span id="cb2-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-19"></a>non_treatment_systematic &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb2-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-20"></a>non_treatment_random &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb2-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-21"></a><span class="co">#-------------------------</span></span>
<span id="cb2-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-22"></a></span>
<span id="cb2-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-23"></a>RCT_data &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb2-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-24"></a>  <span class="dt">Athlete =</span> <span class="kw">paste</span>(</span>
<span id="cb2-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-25"></a>    <span class="st">&quot;Athlete&quot;</span>,</span>
<span id="cb2-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-26"></a>    <span class="kw">str_pad</span>(</span>
<span id="cb2-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-27"></a>      <span class="dt">string =</span> <span class="kw">seq</span>(<span class="dv">1</span>, n_subjects),</span>
<span id="cb2-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-28"></a>      <span class="dt">width =</span> <span class="dv">2</span>,</span>
<span id="cb2-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-29"></a>      <span class="dt">pad =</span> <span class="st">&quot;0&quot;</span></span>
<span id="cb2-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-30"></a>    )</span>
<span id="cb2-31"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-31"></a>  ),</span>
<span id="cb2-32"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-32"></a>  <span class="dt">Group =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Treatment&quot;</span>, <span class="st">&quot;Control&quot;</span>), <span class="dt">length.out =</span> n_subjects),</span>
<span id="cb2-33"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-33"></a></span>
<span id="cb2-34"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-34"></a>  <span class="co"># True score</span></span>
<span id="cb2-35"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-35"></a>  <span class="dt">True_score.Pre =</span> <span class="kw">rnorm</span>(n_subjects, <span class="dv">45</span>, <span class="dv">5</span>),</span>
<span id="cb2-36"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-36"></a></span>
<span id="cb2-37"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-37"></a>  <span class="co"># Treatment effect</span></span>
<span id="cb2-38"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-38"></a>  <span class="dt">Treatment_effect =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> n_subjects, <span class="dt">mean =</span> treatment_systematic, <span class="dt">sd =</span> treatment_random),</span>
<span id="cb2-39"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-39"></a>  <span class="dt">Non_treatment_effect =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> n_subjects, <span class="dt">mean =</span> non_treatment_systematic, <span class="dt">sd =</span> non_treatment_random),</span>
<span id="cb2-40"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-40"></a></span>
<span id="cb2-41"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-41"></a>  <span class="co"># Calculate the change in true score</span></span>
<span id="cb2-42"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-42"></a>  <span class="dt">True_score.Change =</span> <span class="kw">if_else</span>(</span>
<span id="cb2-43"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-43"></a>    Group <span class="op">==</span><span class="st"> &quot;Treatment&quot;</span>,</span>
<span id="cb2-44"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-44"></a>    <span class="co"># Treatment group is a sum of treatment and non-treatment effects</span></span>
<span id="cb2-45"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-45"></a>    Treatment_effect <span class="op">+</span><span class="st"> </span>Non_treatment_effect,</span>
<span id="cb2-46"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-46"></a>    <span class="co"># While control group only get non-treatment effects</span></span>
<span id="cb2-47"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-47"></a>    Non_treatment_effect</span>
<span id="cb2-48"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-48"></a>  ),</span>
<span id="cb2-49"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-49"></a>  <span class="dt">True_score.Post =</span> True_score.Pre <span class="op">+</span><span class="st"> </span>True_score.Change,</span>
<span id="cb2-50"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-50"></a></span>
<span id="cb2-51"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-51"></a>  <span class="co"># Manifested score</span></span>
<span id="cb2-52"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-52"></a>  <span class="dt">Manifested_score.Pre =</span> True_score.Pre <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, biological_variation),</span>
<span id="cb2-53"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-53"></a>  <span class="dt">Manifested_score.Post =</span> True_score.Post <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, biological_variation),</span>
<span id="cb2-54"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-54"></a>  <span class="dt">Manifested_score.Change =</span> Manifested_score.Post <span class="op">-</span><span class="st"> </span>Manifested_score.Pre,</span>
<span id="cb2-55"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-55"></a></span>
<span id="cb2-56"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-56"></a>  <span class="co"># Measured score</span></span>
<span id="cb2-57"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-57"></a>  <span class="dt">Measured_score.Pre =</span> Manifested_score.Pre <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, instrumentation_noise),</span>
<span id="cb2-58"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-58"></a>  <span class="dt">Measured_score.Post =</span> Manifested_score.Post <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, instrumentation_noise),</span>
<span id="cb2-59"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-59"></a>  <span class="dt">Measured_score.Change =</span> Measured_score.Post <span class="op">-</span><span class="st"> </span>Measured_score.Pre</span>
<span id="cb2-60"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-60"></a>)</span>
<span id="cb2-61"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-61"></a></span>
<span id="cb2-62"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-62"></a><span class="kw">head</span>(RCT_data)</span>
<span id="cb2-63"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-63"></a><span class="co">#&gt; # A tibble: 6 x 13</span></span>
<span id="cb2-64"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-64"></a><span class="co">#&gt;   Athlete Group True_score.Pre Treatment_effect Non_treatment_e…</span></span>
<span id="cb2-65"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-65"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb2-66"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-66"></a><span class="co">#&gt; 1 Athlet… Trea…           52.9                0                0</span></span>
<span id="cb2-67"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-67"></a><span class="co">#&gt; 2 Athlet… Cont…           42.4                0                0</span></span>
<span id="cb2-68"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-68"></a><span class="co">#&gt; 3 Athlet… Trea…           49.2                0                0</span></span>
<span id="cb2-69"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-69"></a><span class="co">#&gt; 4 Athlet… Cont…           44.8                0                0</span></span>
<span id="cb2-70"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-70"></a><span class="co">#&gt; 5 Athlet… Trea…           40.0                0                0</span></span>
<span id="cb2-71"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-71"></a><span class="co">#&gt; 6 Athlet… Cont…           42.6                0                0</span></span>
<span id="cb2-72"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-72"></a><span class="co">#&gt; # … with 8 more variables: True_score.Change &lt;dbl&gt;, True_score.Post &lt;dbl&gt;,</span></span>
<span id="cb2-73"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-73"></a><span class="co">#&gt; #   Manifested_score.Pre &lt;dbl&gt;, Manifested_score.Post &lt;dbl&gt;,</span></span>
<span id="cb2-74"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-74"></a><span class="co">#&gt; #   Manifested_score.Change &lt;dbl&gt;, Measured_score.Pre &lt;dbl&gt;,</span></span>
<span id="cb2-75"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb2-75"></a><span class="co">#&gt; #   Measured_score.Post &lt;dbl&gt;, Measured_score.Change &lt;dbl&gt;</span></span></code></pre></div>
<p>Since we have generated this data, we know that there are no treatment nor non-treatment effects (neither systematic, nor random or variable effects). But let’s plot the data.</p>
<p>First let’s plot the Pre-test measured scores (vertical jump) distribution:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb3-1"></a>bmbstats<span class="op">::</span><span class="kw">plot_raincloud</span>(</span>
<span id="cb3-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb3-2"></a>  RCT_data,</span>
<span id="cb3-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb3-3"></a>  <span class="dt">value =</span> <span class="st">&quot;Measured_score.Pre&quot;</span>,</span>
<span id="cb3-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb3-4"></a>  <span class="dt">groups =</span> <span class="st">&quot;Group&quot;</span></span>
<span id="cb3-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb3-5"></a>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-4-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>And the Post-test:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb4-1"></a>bmbstats<span class="op">::</span><span class="kw">plot_raincloud</span>(</span>
<span id="cb4-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb4-2"></a>  RCT_data,</span>
<span id="cb4-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb4-3"></a>  <span class="dt">value =</span> <span class="st">&quot;Measured_score.Post&quot;</span>,</span>
<span id="cb4-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb4-4"></a>  <span class="dt">groups =</span> <span class="st">&quot;Group&quot;</span></span>
<span id="cb4-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb4-5"></a>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-5-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>And finally measured change scores:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb5-1"></a>bmbstats<span class="op">::</span><span class="kw">plot_raincloud_SESOI</span>(</span>
<span id="cb5-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb5-2"></a>  RCT_data,</span>
<span id="cb5-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb5-3"></a>  <span class="dt">value =</span> <span class="st">&quot;Measured_score.Change&quot;</span>,</span>
<span id="cb5-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb5-4"></a>  <span class="dt">groups =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb5-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb5-5"></a>  <span class="dt">SESOI_lower =</span> <span class="dv">-5</span>,</span>
<span id="cb5-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb5-6"></a>  <span class="dt">SESOI_upper =</span> <span class="dv">5</span></span>
<span id="cb5-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb5-7"></a>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>From these graphs we can see that there is no difference between group. We have also selected large SESOI taking into account our a-priori knowledge about biological variation and measurement error in the vertical jump height.</p>
<p>Let’s plot the individual change fro athletes from the Treatment group:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb6-1"></a>bmbstats<span class="op">::</span><span class="kw">plot_pair_changes</span>(</span>
<span id="cb6-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb6-2"></a>  <span class="dt">group_a =</span> RCT_data<span class="op">$</span>Measured_score.Pre,</span>
<span id="cb6-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb6-3"></a>  <span class="dt">group_b =</span> RCT_data<span class="op">$</span>Measured_score.Post,</span>
<span id="cb6-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb6-4"></a>  <span class="dt">group_a_label =</span> <span class="st">&quot;Measured Pre-test&quot;</span>,</span>
<span id="cb6-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb6-5"></a>  <span class="dt">group_b_label =</span> <span class="st">&quot;Measured Post-test&quot;</span>,</span>
<span id="cb6-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb6-6"></a>  <span class="dt">SESOI_lower =</span> <span class="dv">-5</span>,</span>
<span id="cb6-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb6-7"></a>  <span class="dt">SESOI_upper =</span> <span class="dv">5</span></span>
<span id="cb6-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb6-8"></a>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-7-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="rct-analysis-using-bmbstatsrct_analysis-function" class="section level2" number="16.2">
<h2><span class="header-section-number">16.2</span> RCT analysis using <code>bmbstats::RCT_analysis</code> function</h2>
<p>To perform RCT analysis explained in the <a href="causal-inference.html#causal-inference">Causal inference</a> chapter, we will use <code>bmbstats::RCT_analysis</code> function. <code>bmbstats::RCT_analysis</code> function has two built-in estimator function: <code>bmbstats::RCT_estimators</code> and <code>bmbstats::RCT_estimators_simple</code>. <code>bmbstats::RCT_estimators</code> is more extensive and involves individual group analysis, while the <code>bmbstats::RCT_estimators_simple</code> only provides estimated treatment and non-treatment effects.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-1"></a>extensive_RCT &lt;-<span class="st"> </span>bmbstats<span class="op">::</span><span class="kw">RCT_analysis</span>(</span>
<span id="cb7-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-2"></a>  <span class="dt">data =</span> RCT_data,</span>
<span id="cb7-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-3"></a>  <span class="dt">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb7-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-4"></a>  <span class="dt">treatment_label =</span> <span class="st">&quot;Treatment&quot;</span>,</span>
<span id="cb7-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-5"></a>  <span class="dt">control_label =</span> <span class="st">&quot;Control&quot;</span>,</span>
<span id="cb7-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-6"></a>  <span class="dt">pre_test =</span> <span class="st">&quot;Measured_score.Pre&quot;</span>,</span>
<span id="cb7-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-7"></a>  <span class="dt">post_test =</span> <span class="st">&quot;Measured_score.Post&quot;</span>,</span>
<span id="cb7-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-8"></a>  <span class="dt">SESOI_lower =</span> <span class="dv">-5</span>,</span>
<span id="cb7-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-9"></a>  <span class="dt">SESOI_upper =</span> <span class="dv">5</span>,</span>
<span id="cb7-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-10"></a>  <span class="dt">control =</span> <span class="kw">model_control</span>(<span class="dt">seed =</span> <span class="dv">1667</span>)</span>
<span id="cb7-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-11"></a>)</span>
<span id="cb7-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-12"></a><span class="co">#&gt; [1] &quot;All values of t are equal to  5 \n Cannot calculate confidence intervals&quot;</span></span>
<span id="cb7-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-13"></a><span class="co">#&gt; [1] &quot;All values of t are equal to  10 \n Cannot calculate confidence intervals&quot;</span></span>
<span id="cb7-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-14"></a></span>
<span id="cb7-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-15"></a></span>
<span id="cb7-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-16"></a>extensive_RCT</span>
<span id="cb7-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-17"></a><span class="co">#&gt; Bootstrap with 2000 resamples and 95% bca confidence intervals.</span></span>
<span id="cb7-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-18"></a><span class="co">#&gt; </span></span>
<span id="cb7-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-19"></a><span class="co">#&gt;                           estimator         value         lower       upper</span></span>
<span id="cb7-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-20"></a><span class="co">#&gt;                         SESOI lower -5.0000000000            NA          NA</span></span>
<span id="cb7-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-21"></a><span class="co">#&gt;                         SESOI upper  5.0000000000            NA          NA</span></span>
<span id="cb7-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-22"></a><span class="co">#&gt;                         SESOI range 10.0000000000            NA          NA</span></span>
<span id="cb7-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-23"></a><span class="co">#&gt;         Control Group Pre-test mean 45.5109521606  4.331148e+01 48.21036084</span></span>
<span id="cb7-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-24"></a><span class="co">#&gt;           Control Group Pre-test SD  3.9597464864  2.855004e+00  5.85827992</span></span>
<span id="cb7-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-25"></a><span class="co">#&gt;        Control Group Post-test mean 45.1257775214  4.313070e+01 47.47599410</span></span>
<span id="cb7-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-26"></a><span class="co">#&gt;          Control Group Post-test SD  3.5092078780  2.571001e+00  4.87446945</span></span>
<span id="cb7-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-27"></a><span class="co">#&gt;       Treatment Group Pre-test mean 42.6896373231  3.865745e+01 46.72775073</span></span>
<span id="cb7-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-28"></a><span class="co">#&gt;         Treatment Group Pre-test SD  6.7766398945  4.721891e+00  9.43000440</span></span>
<span id="cb7-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-29"></a><span class="co">#&gt;      Treatment Group Post-test mean 42.3426726375  3.847114e+01 46.62049607</span></span>
<span id="cb7-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-30"></a><span class="co">#&gt;        Treatment Group Post-test SD  6.8172485979  4.650529e+00  9.42580140</span></span>
<span id="cb7-31"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-31"></a><span class="co">#&gt;                  Pre-test pooled SD  5.5498847059  4.320704e+00  7.42005780</span></span>
<span id="cb7-32"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-32"></a><span class="co">#&gt;           Pre-test Group difference -2.8213148375 -7.699018e+00  1.79257029</span></span>
<span id="cb7-33"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-33"></a><span class="co">#&gt;          Post-test Group difference -2.7831048839 -7.536144e+00  1.92992786</span></span>
<span id="cb7-34"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-34"></a><span class="co">#&gt;           Control Group Change mean -0.3851746392 -1.335798e+00  0.40887509</span></span>
<span id="cb7-35"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-35"></a><span class="co">#&gt;             Control Group Change SD  1.4244343846  9.784351e-01  2.20497980</span></span>
<span id="cb7-36"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-36"></a><span class="co">#&gt;             Control Group Cohen&#39;s d -0.0694022776 -2.718276e-01  0.08822495</span></span>
<span id="cb7-37"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-37"></a><span class="co">#&gt;       Control Group Change to SESOI -0.0385174639 -1.335798e-01  0.04088751</span></span>
<span id="cb7-38"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-38"></a><span class="co">#&gt;    Control Group Change SD to SESOI  0.1424434385  9.784351e-02  0.22049798</span></span>
<span id="cb7-39"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-39"></a><span class="co">#&gt;                Control Group pLower  0.0050812820  2.555858e-04  0.04726465</span></span>
<span id="cb7-40"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-40"></a><span class="co">#&gt;           Control Group pEquivalent  0.9927461183  9.394569e-01  0.99960354</span></span>
<span id="cb7-41"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-41"></a><span class="co">#&gt;               Control Group pHigher  0.0021725997  1.041601e-04  0.02120446</span></span>
<span id="cb7-42"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-42"></a><span class="co">#&gt;         Treatment Group Change mean -0.3469646855 -1.414503e+00  0.67665105</span></span>
<span id="cb7-43"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-43"></a><span class="co">#&gt;           Treatment Group Change SD  1.7452275994  1.250376e+00  2.44737128</span></span>
<span id="cb7-44"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-44"></a><span class="co">#&gt;           Treatment Group Cohen&#39;s d -0.0625174583 -2.928988e-01  0.13865744</span></span>
<span id="cb7-45"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-45"></a><span class="co">#&gt;     Treatment Group Change to SESOI -0.0346964686 -1.414503e-01  0.06766510</span></span>
<span id="cb7-46"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-46"></a><span class="co">#&gt;  Treatment Group Change SD to SESOI  0.1745227599  1.250376e-01  0.24473713</span></span>
<span id="cb7-47"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-47"></a><span class="co">#&gt;              Treatment Group pLower  0.0128923459  1.054894e-03  0.04971288</span></span>
<span id="cb7-48"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-48"></a><span class="co">#&gt;         Treatment Group pEquivalent  0.9803630085  9.201771e-01  0.99808935</span></span>
<span id="cb7-49"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-49"></a><span class="co">#&gt;             Treatment Group pHigher  0.0067446456  6.362436e-04  0.04797000</span></span>
<span id="cb7-50"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-50"></a><span class="co">#&gt;                    Effect Cohen&#39;s d  0.0268246499 -1.133010e+00  1.16779153</span></span>
<span id="cb7-51"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-51"></a><span class="co">#&gt;                   Systematic effect  0.0382099536 -1.285889e+00  1.47903212</span></span>
<span id="cb7-52"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-52"></a><span class="co">#&gt;                       Random effect  1.0083680171 -1.192373e+00  1.89420374</span></span>
<span id="cb7-53"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-53"></a><span class="co">#&gt;          Systematic effect to SESOI  0.0038209954 -1.285889e-01  0.14790321</span></span>
<span id="cb7-54"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-54"></a><span class="co">#&gt;              SESOI to Random effect  9.9170142553 -1.047902e+01 98.30169044</span></span>
<span id="cb7-55"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-55"></a><span class="co">#&gt;                              pLower  0.0003713043  2.406229e-12  0.99977466</span></span>
<span id="cb7-56"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-56"></a><span class="co">#&gt;                         pEquivalent  0.9992167407 -9.939859e-01  1.00000000</span></span>
<span id="cb7-57"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb7-57"></a><span class="co">#&gt;                             pHigher  0.0004119550  8.728491e-13  0.99975725</span></span></code></pre></div>
<p>We can also plot the estimators bootstrap distributions:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb8-1"></a><span class="kw">plot</span>(extensive_RCT)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-9-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>If we use <code>bmbstats::RCT_estimators_simple</code>, we will get much more condensed output:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-1"></a>simple_RCT &lt;-<span class="st"> </span>bmbstats<span class="op">::</span><span class="kw">RCT_analysis</span>(</span>
<span id="cb9-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-2"></a>  <span class="dt">data =</span> RCT_data,</span>
<span id="cb9-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-3"></a>  <span class="dt">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb9-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-4"></a>  <span class="dt">treatment_label =</span> <span class="st">&quot;Treatment&quot;</span>,</span>
<span id="cb9-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-5"></a>  <span class="dt">control_label =</span> <span class="st">&quot;Control&quot;</span>,</span>
<span id="cb9-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-6"></a>  <span class="dt">pre_test =</span> <span class="st">&quot;Measured_score.Pre&quot;</span>,</span>
<span id="cb9-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-7"></a>  <span class="dt">post_test =</span> <span class="st">&quot;Measured_score.Post&quot;</span>,</span>
<span id="cb9-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-8"></a>  <span class="dt">SESOI_lower =</span> <span class="dv">-5</span>,</span>
<span id="cb9-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-9"></a>  <span class="dt">SESOI_upper =</span> <span class="dv">5</span>,</span>
<span id="cb9-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-10"></a>  <span class="dt">estimator_function =</span> bmbstats<span class="op">::</span>RCT_estimators_simple,</span>
<span id="cb9-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-11"></a>  <span class="dt">control =</span> <span class="kw">model_control</span>(<span class="dt">seed =</span> <span class="dv">1667</span>)</span>
<span id="cb9-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-12"></a>)</span>
<span id="cb9-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-13"></a><span class="co">#&gt; [1] &quot;All values of t are equal to  5 \n Cannot calculate confidence intervals&quot;</span></span>
<span id="cb9-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-14"></a><span class="co">#&gt; [1] &quot;All values of t are equal to  10 \n Cannot calculate confidence intervals&quot;</span></span>
<span id="cb9-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-15"></a></span>
<span id="cb9-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-16"></a></span>
<span id="cb9-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-17"></a>simple_RCT</span>
<span id="cb9-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-18"></a><span class="co">#&gt; Bootstrap with 2000 resamples and 95% bca confidence intervals.</span></span>
<span id="cb9-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-19"></a><span class="co">#&gt; </span></span>
<span id="cb9-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-20"></a><span class="co">#&gt;                   estimator         value         lower      upper</span></span>
<span id="cb9-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-21"></a><span class="co">#&gt;                 SESOI lower -5.0000000000            NA         NA</span></span>
<span id="cb9-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-22"></a><span class="co">#&gt;                 SESOI upper  5.0000000000            NA         NA</span></span>
<span id="cb9-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-23"></a><span class="co">#&gt;                 SESOI range 10.0000000000            NA         NA</span></span>
<span id="cb9-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-24"></a><span class="co">#&gt;           Systematic effect  0.0382099536 -1.285889e+00  1.4790321</span></span>
<span id="cb9-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-25"></a><span class="co">#&gt;               Random effect  1.0083680171 -1.192373e+00  1.8942037</span></span>
<span id="cb9-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-26"></a><span class="co">#&gt;  Systematic effect to SESOI  0.0038209954 -1.285889e-01  0.1479032</span></span>
<span id="cb9-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-27"></a><span class="co">#&gt;      SESOI to Random effect  9.9170142553 -1.047902e+01 98.3016904</span></span>
<span id="cb9-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-28"></a><span class="co">#&gt;                      pLower  0.0003713043  2.406229e-12  0.9997747</span></span>
<span id="cb9-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-29"></a><span class="co">#&gt;                 pEquivalent  0.9992167407 -9.939859e-01  1.0000000</span></span>
<span id="cb9-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb9-30"></a><span class="co">#&gt;                     pHigher  0.0004119550  8.728491e-13  0.9997572</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb10-1"></a><span class="kw">plot</span>(simple_RCT)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-11-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>As can be seen, the analysis correctly identified no treatment effect. There is an issue with random treatment effects estimation since is demonstrates distribution with two peaks. This effect is due to random treatment effect being zero and the way the root of the squared differences is calculated to avoid irrational numbers (i.e. taking root of negative number).</p>
<p>There are additional graphs that can be produced. All graphs can take <code>control = plot_control</code> parameter to setup plotting options as explained in the previous chapters.</p>
<p>Control group Pre- and Post-test distribution:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb11-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;control-pre-post&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-12-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Treatment group Pre- and Post-test distribution:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb12-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;treatment-pre-post&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-13-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Control change graph:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb13-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;control-change&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-14-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Treatment change graph:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb14-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;treatment-change&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-15-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Change graph:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb15-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;change&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-16-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Individual changes in the Control group:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb16-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;control-paired-change&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-17-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Individual changes in the Treatment group:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb17-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;treatment-paired-change&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-18-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Distribution of the change scores:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb18-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;change-distribution&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-19-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Treatment effect distribution:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb19-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;effect-distribution&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-20-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>And finally, adjusted treatment responses:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb20-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;adjusted-treatment-responses&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-21-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>The adjusted treatment responses are calculated by deducting <code>mean</code> Control group change from individual change in the Treatment group (i.e. <em>adjusted change</em>). Error-bars represent 95% confidence intervals (i.e. <code>SDC</code>) using change <code>SD</code> of the Control group.
The data used to create this graph can be found in the returned object:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb21-1"></a><span class="kw">head</span>(simple_RCT<span class="op">$</span>extra<span class="op">$</span>treatment_responses)</span>
<span id="cb21-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb21-2"></a><span class="co">#&gt;    id     group pre_test post_test     change      SDC change_lower</span></span>
<span id="cb21-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb21-3"></a><span class="co">#&gt; 11  1 Treatment 52.87665  53.06613  0.1894841 3.222294   -3.0328104</span></span>
<span id="cb21-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb21-4"></a><span class="co">#&gt; 12  2 Treatment 48.86917  51.26538  2.3962116 3.222294   -0.8260828</span></span>
<span id="cb21-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb21-5"></a><span class="co">#&gt; 13  3 Treatment 41.83908  39.31947 -2.5196029 3.222294   -5.7418974</span></span>
<span id="cb21-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb21-6"></a><span class="co">#&gt; 14  4 Treatment 43.14467  40.80646 -2.3382079 3.222294   -5.5605023</span></span>
<span id="cb21-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb21-7"></a><span class="co">#&gt; 15  5 Treatment 32.93471  33.26669  0.3319806 3.222294   -2.8903138</span></span>
<span id="cb21-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb21-8"></a><span class="co">#&gt; 16  6 Treatment 34.17358  33.61544 -0.5581425 3.222294   -3.7804369</span></span>
<span id="cb21-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb21-9"></a><span class="co">#&gt;    change_upper adjusted_change adjusted_change_lower adjusted_change_upper</span></span>
<span id="cb21-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb21-10"></a><span class="co">#&gt; 11    3.4117785       0.5746587            -2.6476357              3.796953</span></span>
<span id="cb21-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb21-11"></a><span class="co">#&gt; 12    5.6185061       2.7813863            -0.4409082              6.003681</span></span>
<span id="cb21-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb21-12"></a><span class="co">#&gt; 13    0.7026915      -2.1344283            -5.3567227              1.087866</span></span>
<span id="cb21-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb21-13"></a><span class="co">#&gt; 14    0.8840866      -1.9530332            -5.1753277              1.269261</span></span>
<span id="cb21-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb21-14"></a><span class="co">#&gt; 15    3.5542751       0.7171553            -2.5051392              3.939450</span></span>
<span id="cb21-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb21-15"></a><span class="co">#&gt; 16    2.6641520      -0.1729678            -3.3952623              3.049327</span></span></code></pre></div>
<p>We can also plot the un-adjusted treatment responses:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb22-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;treatment-responses&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-23-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Let’s re-create this graph using <code>bmbstats::observations_MET</code> function since that function also allows us to set Type I error rates and confidence for plotting.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-1"></a>treatment_group &lt;-<span class="st"> </span><span class="kw">filter</span>(</span>
<span id="cb23-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-2"></a>  RCT_data,</span>
<span id="cb23-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-3"></a>  Group <span class="op">==</span><span class="st"> &quot;Treatment&quot;</span></span>
<span id="cb23-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-4"></a>)</span>
<span id="cb23-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-5"></a></span>
<span id="cb23-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-6"></a>control_group &lt;-<span class="st"> </span><span class="kw">filter</span>(</span>
<span id="cb23-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-7"></a>  RCT_data,</span>
<span id="cb23-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-8"></a>  Group <span class="op">==</span><span class="st"> &quot;Control&quot;</span></span>
<span id="cb23-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-9"></a>)</span>
<span id="cb23-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-10"></a></span>
<span id="cb23-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-11"></a>treatment_responses &lt;-<span class="st"> </span>bmbstats<span class="op">::</span><span class="kw">observations_MET</span>(</span>
<span id="cb23-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-12"></a>  <span class="dt">observations =</span> treatment_group<span class="op">$</span>Measured_score.Change <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(control_group<span class="op">$</span>Measured_score.Change),</span>
<span id="cb23-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-13"></a>  <span class="dt">observations_label =</span> treatment_group<span class="op">$</span>Athlete,</span>
<span id="cb23-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-14"></a></span>
<span id="cb23-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-15"></a>  <span class="co"># Use control group change as measurement error</span></span>
<span id="cb23-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-16"></a>  <span class="dt">measurement_error =</span> <span class="kw">sd</span>(control_group<span class="op">$</span>Measured_score.Change),</span>
<span id="cb23-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-17"></a></span>
<span id="cb23-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-18"></a>  <span class="co"># Degrees of freedom from the reliability study. Use `Inf` for normal distribution</span></span>
<span id="cb23-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-19"></a>  <span class="dt">df =</span> <span class="kw">nrow</span>(control_group) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb23-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-20"></a>  <span class="dt">SESOI_lower =</span> <span class="dv">-5</span>,</span>
<span id="cb23-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-21"></a>  <span class="dt">SESOI_upper =</span> <span class="dv">5</span>,</span>
<span id="cb23-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-22"></a></span>
<span id="cb23-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-23"></a>  <span class="co"># Will not use Bonferroni adjustment here</span></span>
<span id="cb23-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-24"></a>  <span class="dt">alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb23-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-25"></a>  <span class="co"># No adjustment in CIs for plotting</span></span>
<span id="cb23-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-26"></a>  <span class="dt">confidence =</span> <span class="fl">0.95</span></span>
<span id="cb23-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-27"></a>)</span>
<span id="cb23-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-28"></a></span>
<span id="cb23-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-29"></a><span class="kw">plot</span>(</span>
<span id="cb23-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-30"></a>  treatment_responses,</span>
<span id="cb23-31"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-31"></a>  <span class="dt">true_observations =</span> treatment_group<span class="op">$</span>True_score.Change,</span>
<span id="cb23-32"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-32"></a>  <span class="dt">control =</span> <span class="kw">plot_control</span>(<span class="dt">points_size =</span> <span class="dv">5</span>)</span>
<span id="cb23-33"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-33"></a>) <span class="op">+</span></span>
<span id="cb23-34"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb23-34"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="op">-</span><span class="dv">9</span>, <span class="dv">9</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-24-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>This way, Control group is used as <em>sort-of</em> reliability study (see <a href="validity-and-reliability.html#repeatability">Repeatability</a> section in the <a href="validity-and-reliability.html#validity-and-reliability">Validity and Reliability</a> chapter) that provides source of information about the non-treatment effect (in this case 0 for both systematic and random components), biological variation and instrumentation noise. This helps us to provide uncertainty intervals around individual treatment (adjusted) effects.</p>
</div>
<div id="adding-some-effects" class="section level2" number="16.3">
<h2><span class="header-section-number">16.3</span> Adding some effects</h2>
<p>The previous example contained no treatment nor non-treatment effects, only biological variation and instrumentation noise. Let’s now consider different treatment - plyometric training that has systematic effect of 5cm (<code>mean</code> or expected change) and random effect of 5cm. But, since this study is done after the off-season, all athletes experienced systematic effect of 2.5cm and random effect of 1cm only by normal training. This represents non-treatment effect.</p>
<p>This is the code to generate the data (i.e. DGP):</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-1"></a><span class="kw">set.seed</span>(<span class="dv">16</span>)</span>
<span id="cb24-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-2"></a></span>
<span id="cb24-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-3"></a>n_subjects &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb24-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-4"></a></span>
<span id="cb24-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-5"></a><span class="co"># These stay the same</span></span>
<span id="cb24-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-6"></a>instrumentation_noise &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb24-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-7"></a>biological_variation &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb24-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-8"></a></span>
<span id="cb24-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-9"></a><span class="co"># -------------------------</span></span>
<span id="cb24-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-10"></a><span class="co"># Treatment effect</span></span>
<span id="cb24-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-11"></a>treatment_systematic &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb24-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-12"></a>treatment_random &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb24-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-13"></a></span>
<span id="cb24-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-14"></a><span class="co"># Non-treatment effect</span></span>
<span id="cb24-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-15"></a>non_treatment_systematic &lt;-<span class="st"> </span><span class="fl">2.5</span></span>
<span id="cb24-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-16"></a>non_treatment_random &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb24-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-17"></a><span class="co">#-------------------------</span></span>
<span id="cb24-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-18"></a></span>
<span id="cb24-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-19"></a>RCT_data &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb24-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-20"></a>  <span class="dt">Athlete =</span> <span class="kw">paste</span>(</span>
<span id="cb24-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-21"></a>    <span class="st">&quot;Athlete&quot;</span>,</span>
<span id="cb24-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-22"></a>    <span class="kw">str_pad</span>(</span>
<span id="cb24-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-23"></a>      <span class="dt">string =</span> <span class="kw">seq</span>(<span class="dv">1</span>, n_subjects),</span>
<span id="cb24-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-24"></a>      <span class="dt">width =</span> <span class="dv">2</span>,</span>
<span id="cb24-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-25"></a>      <span class="dt">pad =</span> <span class="st">&quot;0&quot;</span></span>
<span id="cb24-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-26"></a>    )</span>
<span id="cb24-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-27"></a>  ),</span>
<span id="cb24-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-28"></a>  <span class="dt">Group =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Treatment&quot;</span>, <span class="st">&quot;Control&quot;</span>), <span class="dt">length.out =</span> n_subjects),</span>
<span id="cb24-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-29"></a></span>
<span id="cb24-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-30"></a>  <span class="co"># True score</span></span>
<span id="cb24-31"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-31"></a>  <span class="dt">True_score.Pre =</span> <span class="kw">rnorm</span>(n_subjects, <span class="dv">45</span>, <span class="dv">5</span>),</span>
<span id="cb24-32"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-32"></a></span>
<span id="cb24-33"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-33"></a>  <span class="co"># Treatment effect</span></span>
<span id="cb24-34"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-34"></a>  <span class="dt">Treatment_effect =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> n_subjects, <span class="dt">mean =</span> treatment_systematic, <span class="dt">sd =</span> treatment_random),</span>
<span id="cb24-35"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-35"></a>  <span class="dt">Non_treatment_effect =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> n_subjects, <span class="dt">mean =</span> non_treatment_systematic, <span class="dt">sd =</span> non_treatment_random),</span>
<span id="cb24-36"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-36"></a></span>
<span id="cb24-37"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-37"></a>  <span class="co"># Calculate the change in true score</span></span>
<span id="cb24-38"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-38"></a>  <span class="dt">True_score.Change =</span> <span class="kw">if_else</span>(</span>
<span id="cb24-39"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-39"></a>    Group <span class="op">==</span><span class="st"> &quot;Treatment&quot;</span>,</span>
<span id="cb24-40"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-40"></a>    <span class="co"># Treatment group is a sum of treatment and non-treatment effects</span></span>
<span id="cb24-41"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-41"></a>    Treatment_effect <span class="op">+</span><span class="st"> </span>Non_treatment_effect,</span>
<span id="cb24-42"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-42"></a>    <span class="co"># While control group only get non-treatment effects</span></span>
<span id="cb24-43"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-43"></a>    Non_treatment_effect</span>
<span id="cb24-44"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-44"></a>  ),</span>
<span id="cb24-45"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-45"></a>  <span class="dt">True_score.Post =</span> True_score.Pre <span class="op">+</span><span class="st"> </span>True_score.Change,</span>
<span id="cb24-46"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-46"></a></span>
<span id="cb24-47"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-47"></a>  <span class="co"># Manifested score</span></span>
<span id="cb24-48"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-48"></a>  <span class="dt">Manifested_score.Pre =</span> True_score.Pre <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, biological_variation),</span>
<span id="cb24-49"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-49"></a>  <span class="dt">Manifested_score.Post =</span> True_score.Post <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, biological_variation),</span>
<span id="cb24-50"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-50"></a>  <span class="dt">Manifested_score.Change =</span> Manifested_score.Post <span class="op">-</span><span class="st"> </span>Manifested_score.Pre,</span>
<span id="cb24-51"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-51"></a></span>
<span id="cb24-52"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-52"></a>  <span class="co"># Measured score</span></span>
<span id="cb24-53"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-53"></a>  <span class="dt">Measured_score.Pre =</span> Manifested_score.Pre <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, instrumentation_noise),</span>
<span id="cb24-54"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-54"></a>  <span class="dt">Measured_score.Post =</span> Manifested_score.Post <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, instrumentation_noise),</span>
<span id="cb24-55"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-55"></a>  <span class="dt">Measured_score.Change =</span> Measured_score.Post <span class="op">-</span><span class="st"> </span>Measured_score.Pre</span>
<span id="cb24-56"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-56"></a>)</span>
<span id="cb24-57"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-57"></a></span>
<span id="cb24-58"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-58"></a><span class="kw">head</span>(RCT_data)</span>
<span id="cb24-59"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-59"></a><span class="co">#&gt; # A tibble: 6 x 13</span></span>
<span id="cb24-60"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-60"></a><span class="co">#&gt;   Athlete Group True_score.Pre Treatment_effect Non_treatment_e…</span></span>
<span id="cb24-61"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-61"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb24-62"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-62"></a><span class="co">#&gt; 1 Athlet… Trea…           47.4           -3.24              1.17</span></span>
<span id="cb24-63"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-63"></a><span class="co">#&gt; 2 Athlet… Cont…           44.4            3.43              4.57</span></span>
<span id="cb24-64"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-64"></a><span class="co">#&gt; 3 Athlet… Trea…           50.5            4.09              2.74</span></span>
<span id="cb24-65"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-65"></a><span class="co">#&gt; 4 Athlet… Cont…           37.8           12.4               2.15</span></span>
<span id="cb24-66"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-66"></a><span class="co">#&gt; 5 Athlet… Trea…           50.7            0.671             1.87</span></span>
<span id="cb24-67"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-67"></a><span class="co">#&gt; 6 Athlet… Cont…           42.7           12.6               2.78</span></span>
<span id="cb24-68"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-68"></a><span class="co">#&gt; # … with 8 more variables: True_score.Change &lt;dbl&gt;, True_score.Post &lt;dbl&gt;,</span></span>
<span id="cb24-69"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-69"></a><span class="co">#&gt; #   Manifested_score.Pre &lt;dbl&gt;, Manifested_score.Post &lt;dbl&gt;,</span></span>
<span id="cb24-70"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-70"></a><span class="co">#&gt; #   Manifested_score.Change &lt;dbl&gt;, Measured_score.Pre &lt;dbl&gt;,</span></span>
<span id="cb24-71"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb24-71"></a><span class="co">#&gt; #   Measured_score.Post &lt;dbl&gt;, Measured_score.Change &lt;dbl&gt;</span></span></code></pre></div>
<p>Using <code>bmbstats::RCT_estimators_simple</code> estimator and <code>bmbstats::RCT_analysis</code> functions, let’s perform the analysis and generate 95% bootstrap confidence intervals:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-1"></a>simple_RCT &lt;-<span class="st"> </span>bmbstats<span class="op">::</span><span class="kw">RCT_analysis</span>(</span>
<span id="cb25-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-2"></a>  <span class="dt">data =</span> RCT_data,</span>
<span id="cb25-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-3"></a>  <span class="dt">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb25-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-4"></a>  <span class="dt">treatment_label =</span> <span class="st">&quot;Treatment&quot;</span>,</span>
<span id="cb25-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-5"></a>  <span class="dt">control_label =</span> <span class="st">&quot;Control&quot;</span>,</span>
<span id="cb25-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-6"></a>  <span class="dt">pre_test =</span> <span class="st">&quot;Measured_score.Pre&quot;</span>,</span>
<span id="cb25-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-7"></a>  <span class="dt">post_test =</span> <span class="st">&quot;Measured_score.Post&quot;</span>,</span>
<span id="cb25-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-8"></a>  <span class="dt">SESOI_lower =</span> <span class="dv">-5</span>,</span>
<span id="cb25-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-9"></a>  <span class="dt">SESOI_upper =</span> <span class="dv">5</span>,</span>
<span id="cb25-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-10"></a>  <span class="dt">estimator_function =</span> bmbstats<span class="op">::</span>RCT_estimators_simple,</span>
<span id="cb25-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-11"></a>  <span class="dt">control =</span> <span class="kw">model_control</span>(<span class="dt">seed =</span> <span class="dv">1667</span>)</span>
<span id="cb25-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-12"></a>)</span>
<span id="cb25-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-13"></a><span class="co">#&gt; [1] &quot;All values of t are equal to  5 \n Cannot calculate confidence intervals&quot;</span></span>
<span id="cb25-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-14"></a><span class="co">#&gt; [1] &quot;All values of t are equal to  10 \n Cannot calculate confidence intervals&quot;</span></span>
<span id="cb25-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-15"></a></span>
<span id="cb25-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-16"></a></span>
<span id="cb25-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-17"></a>simple_RCT</span>
<span id="cb25-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-18"></a><span class="co">#&gt; Bootstrap with 2000 resamples and 95% bca confidence intervals.</span></span>
<span id="cb25-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-19"></a><span class="co">#&gt; </span></span>
<span id="cb25-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-20"></a><span class="co">#&gt;                   estimator       value        lower     upper</span></span>
<span id="cb25-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-21"></a><span class="co">#&gt;                 SESOI lower -5.00000000           NA        NA</span></span>
<span id="cb25-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-22"></a><span class="co">#&gt;                 SESOI upper  5.00000000           NA        NA</span></span>
<span id="cb25-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-23"></a><span class="co">#&gt;                 SESOI range 10.00000000           NA        NA</span></span>
<span id="cb25-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-24"></a><span class="co">#&gt;           Systematic effect  4.42401313  0.937218218 8.4502825</span></span>
<span id="cb25-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-25"></a><span class="co">#&gt;               Random effect  5.26248077  3.549738890 7.0563291</span></span>
<span id="cb25-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-26"></a><span class="co">#&gt;  Systematic effect to SESOI  0.44240131  0.093721822 0.8450283</span></span>
<span id="cb25-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-27"></a><span class="co">#&gt;      SESOI to Random effect  1.90024447 -6.132025557 2.8734665</span></span>
<span id="cb25-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-28"></a><span class="co">#&gt;                      pLower  0.05346845  0.007442588 0.1580833</span></span>
<span id="cb25-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-29"></a><span class="co">#&gt;                 pEquivalent  0.48890860  0.207267132 0.8265598</span></span>
<span id="cb25-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb25-30"></a><span class="co">#&gt;                     pHigher  0.45762296  0.132962860 0.7926445</span></span></code></pre></div>
<p>Here is the estimators bootstrap distribution:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb26-1"></a><span class="kw">plot</span>(simple_RCT)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-27-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>As can be seen from the results, both systematic and random components of the treatment effects were estimated correctly. We can now plot individual treatment responses:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb27-1"></a><span class="kw">plot</span>(simple_RCT, <span class="dt">type =</span> <span class="st">&quot;treatment-responses&quot;</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-28-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>And we can add the true treatment effects on the plot from the DGP:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-1"></a>treatment_group &lt;-<span class="st"> </span><span class="kw">filter</span>(</span>
<span id="cb28-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-2"></a>  RCT_data,</span>
<span id="cb28-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-3"></a>  Group <span class="op">==</span><span class="st"> &quot;Treatment&quot;</span></span>
<span id="cb28-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-4"></a>)</span>
<span id="cb28-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-5"></a></span>
<span id="cb28-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-6"></a>control_group &lt;-<span class="st"> </span><span class="kw">filter</span>(</span>
<span id="cb28-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-7"></a>  RCT_data,</span>
<span id="cb28-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-8"></a>  Group <span class="op">==</span><span class="st"> &quot;Control&quot;</span></span>
<span id="cb28-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-9"></a>)</span>
<span id="cb28-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-10"></a></span>
<span id="cb28-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-11"></a>treatment_responses &lt;-<span class="st"> </span>bmbstats<span class="op">::</span><span class="kw">observations_MET</span>(</span>
<span id="cb28-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-12"></a>  <span class="dt">observations =</span> treatment_group<span class="op">$</span>Measured_score.Change,</span>
<span id="cb28-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-13"></a>  <span class="dt">observations_label =</span> treatment_group<span class="op">$</span>Athlete,</span>
<span id="cb28-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-14"></a></span>
<span id="cb28-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-15"></a>  <span class="co"># Use control group change as measurement error</span></span>
<span id="cb28-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-16"></a>  <span class="dt">measurement_error =</span> <span class="kw">sd</span>(control_group<span class="op">$</span>Measured_score.Change),</span>
<span id="cb28-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-17"></a></span>
<span id="cb28-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-18"></a>  <span class="co"># Degrees of freedom from the reliability study. Use `Inf` for normal distribution</span></span>
<span id="cb28-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-19"></a>  <span class="dt">df =</span> <span class="kw">nrow</span>(control_group) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb28-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-20"></a>  <span class="dt">SESOI_lower =</span> <span class="dv">-5</span>,</span>
<span id="cb28-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-21"></a>  <span class="dt">SESOI_upper =</span> <span class="dv">5</span>,</span>
<span id="cb28-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-22"></a></span>
<span id="cb28-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-23"></a>  <span class="co"># Will not use Bonferroni adjustment here</span></span>
<span id="cb28-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-24"></a>  <span class="dt">alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb28-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-25"></a>  <span class="co"># No adjustment in CIs for plotting</span></span>
<span id="cb28-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-26"></a>  <span class="dt">confidence =</span> <span class="fl">0.95</span></span>
<span id="cb28-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-27"></a>)</span>
<span id="cb28-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-28"></a></span>
<span id="cb28-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-29"></a><span class="kw">plot</span>(</span>
<span id="cb28-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-30"></a>  treatment_responses,</span>
<span id="cb28-31"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-31"></a>  <span class="dt">true_observations =</span> treatment_group<span class="op">$</span>True_score.Change,</span>
<span id="cb28-32"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-32"></a>  <span class="dt">control =</span> <span class="kw">plot_control</span>(<span class="dt">points_size =</span> <span class="dv">5</span>)</span>
<span id="cb28-33"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-33"></a>) <span class="op">+</span></span>
<span id="cb28-34"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb28-34"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">28</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-29-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Adjusted treatment response would deduct <code>mean</code> change from the Control group and would show individual effect ONLY with treatment effect (without non-treatment effect). We can use our DGP generated data frame to generate that graph (or to recreate it) and plot true treatment effects:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-1"></a>treatment_responses &lt;-<span class="st"> </span>bmbstats<span class="op">::</span><span class="kw">observations_MET</span>(</span>
<span id="cb29-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-2"></a>  </span>
<span id="cb29-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-3"></a>  <span class="co"># Adjustment</span></span>
<span id="cb29-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-4"></a>  <span class="dt">observations =</span> treatment_group<span class="op">$</span>Measured_score.Change <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(control_group<span class="op">$</span>Measured_score.Change),</span>
<span id="cb29-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-5"></a>  <span class="dt">observations_label =</span> treatment_group<span class="op">$</span>Athlete,</span>
<span id="cb29-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-6"></a></span>
<span id="cb29-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-7"></a>  <span class="co"># Use control group change as measurement error</span></span>
<span id="cb29-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-8"></a>  <span class="dt">measurement_error =</span> <span class="kw">sd</span>(control_group<span class="op">$</span>Measured_score.Change),</span>
<span id="cb29-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-9"></a></span>
<span id="cb29-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-10"></a>  <span class="co"># Degrees of freedom from the reliability study. Use `Inf` for normal distribution</span></span>
<span id="cb29-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-11"></a>  <span class="dt">df =</span> <span class="kw">nrow</span>(control_group) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb29-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-12"></a>  <span class="dt">SESOI_lower =</span> <span class="dv">-5</span>,</span>
<span id="cb29-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-13"></a>  <span class="dt">SESOI_upper =</span> <span class="dv">5</span>,</span>
<span id="cb29-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-14"></a></span>
<span id="cb29-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-15"></a>  <span class="co"># Will not use Bonferroni adjustment here</span></span>
<span id="cb29-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-16"></a>  <span class="dt">alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb29-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-17"></a>  <span class="co"># No adjustment in CIs for plotting</span></span>
<span id="cb29-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-18"></a>  <span class="dt">confidence =</span> <span class="fl">0.95</span></span>
<span id="cb29-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-19"></a>)</span>
<span id="cb29-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-20"></a></span>
<span id="cb29-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-21"></a><span class="kw">plot</span>(</span>
<span id="cb29-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-22"></a>  treatment_responses,</span>
<span id="cb29-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-23"></a>  <span class="co"># The true observation now is the DGP Treatment effect only</span></span>
<span id="cb29-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-24"></a>  <span class="dt">true_observations =</span> treatment_group<span class="op">$</span>Treatment_effect,</span>
<span id="cb29-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-25"></a>  <span class="dt">control =</span> <span class="kw">plot_control</span>(<span class="dt">points_size =</span> <span class="dv">5</span>)</span>
<span id="cb29-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-26"></a>) <span class="op">+</span></span>
<span id="cb29-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb29-27"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">28</span>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-30-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="what-goes-inside-the-measurement-error" class="section level2" number="16.4">
<h2><span class="header-section-number">16.4</span> What goes inside the <em>measurement error</em>?</h2>
<p>As already explained, Control group serves as a counter-factual proxy of what would happen to the treatment group if not-receiving the treatment. <code>SD</code> of Control group change is used to represent an estimate of uncertainty around individual responses. In our RCT data, <code>SD</code> of the Control group measured change is equal to 2.23cm. This is equal to the root of squared sums of non-treatment random effect, biological variation and instrumentation noise. Since biological variation and instrumentation affects the change score twice (at Pre- and Post-test) we get the following:</p>
<p><span class="math display">\[
  SD_{control\;change} = \sqrt{2\times biological\;variation^2 + 2\times instrumentation\;noise^2 + non\;treatment\;random\;effect^2}
\]</span>
If we plug our DGP values, we get the following expected <code>SD</code> of the Control group change: 2.45cm. If there is no non-treatment random effect, then <code>SD</code> for the control group would only consist of measurement error.</p>
</div>
<div id="prediction-perspective" class="section level2" number="16.5">
<h2><span class="header-section-number">16.5</span> Prediction perspective</h2>
<p><strong>To be continued</strong></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-1"></a><span class="kw">set.seed</span>(<span class="dv">16</span>)</span>
<span id="cb30-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-2"></a></span>
<span id="cb30-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-3"></a>n_subjects &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb30-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-4"></a></span>
<span id="cb30-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-5"></a><span class="co"># These stay the same</span></span>
<span id="cb30-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-6"></a>instrumentation_noise &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb30-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-7"></a>biological_variation &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb30-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-8"></a></span>
<span id="cb30-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-9"></a><span class="co"># -------------------------</span></span>
<span id="cb30-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-10"></a><span class="co"># Treatment effect</span></span>
<span id="cb30-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-11"></a>treatment_systematic &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb30-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-12"></a>treatment_random &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb30-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-13"></a></span>
<span id="cb30-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-14"></a><span class="co"># Non-treatment effect</span></span>
<span id="cb30-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-15"></a>non_treatment_systematic &lt;-<span class="st"> </span><span class="fl">2.5</span></span>
<span id="cb30-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-16"></a>non_treatment_random &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb30-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-17"></a><span class="co">#-------------------------</span></span>
<span id="cb30-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-18"></a></span>
<span id="cb30-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-19"></a>RCT_data &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb30-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-20"></a>  <span class="dt">Athlete =</span> <span class="kw">paste</span>(</span>
<span id="cb30-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-21"></a>    <span class="st">&quot;Athlete&quot;</span>,</span>
<span id="cb30-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-22"></a>    <span class="kw">str_pad</span>(</span>
<span id="cb30-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-23"></a>      <span class="dt">string =</span> <span class="kw">seq</span>(<span class="dv">1</span>, n_subjects),</span>
<span id="cb30-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-24"></a>      <span class="dt">width =</span> <span class="dv">2</span>,</span>
<span id="cb30-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-25"></a>      <span class="dt">pad =</span> <span class="st">&quot;0&quot;</span></span>
<span id="cb30-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-26"></a>    )</span>
<span id="cb30-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-27"></a>  ),</span>
<span id="cb30-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-28"></a>  <span class="dt">Group =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Treatment&quot;</span>, <span class="st">&quot;Control&quot;</span>), <span class="dt">length.out =</span> n_subjects),</span>
<span id="cb30-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-29"></a></span>
<span id="cb30-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-30"></a>  <span class="co"># Strength covariate</span></span>
<span id="cb30-31"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-31"></a>  <span class="dt">Squat_1RM_relative =</span> <span class="kw">rnorm</span>(n_subjects, <span class="dv">1</span>, <span class="fl">0.4</span>),</span>
<span id="cb30-32"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-32"></a>  <span class="co"># True score</span></span>
<span id="cb30-33"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-33"></a>  <span class="dt">True_score.Pre =</span> <span class="kw">rnorm</span>(n_subjects, <span class="dv">45</span>, <span class="dv">5</span>),</span>
<span id="cb30-34"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-34"></a></span>
<span id="cb30-35"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-35"></a>  <span class="co"># Treatment effect</span></span>
<span id="cb30-36"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-36"></a>  <span class="dt">Treatment_effect =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> n_subjects, <span class="dt">mean =</span> treatment_systematic <span class="op">*</span><span class="st"> </span>Squat_1RM_relative, <span class="dt">sd =</span> treatment_random),</span>
<span id="cb30-37"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-37"></a>  <span class="dt">Non_treatment_effect =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> n_subjects, <span class="dt">mean =</span> non_treatment_systematic, <span class="dt">sd =</span> non_treatment_random),</span>
<span id="cb30-38"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-38"></a></span>
<span id="cb30-39"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-39"></a>  <span class="co"># Calculate the change in true score</span></span>
<span id="cb30-40"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-40"></a>  <span class="dt">True_score.Change =</span> <span class="kw">if_else</span>(</span>
<span id="cb30-41"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-41"></a>    Group <span class="op">==</span><span class="st"> &quot;Treatment&quot;</span>,</span>
<span id="cb30-42"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-42"></a>    <span class="co"># Treatment group is a sum of treatment and non-treatment effects</span></span>
<span id="cb30-43"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-43"></a>    Treatment_effect <span class="op">+</span><span class="st"> </span>Non_treatment_effect,</span>
<span id="cb30-44"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-44"></a>    <span class="co"># While control group only get non-treatment effects</span></span>
<span id="cb30-45"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-45"></a>    Non_treatment_effect</span>
<span id="cb30-46"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-46"></a>  ),</span>
<span id="cb30-47"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-47"></a>  <span class="dt">True_score.Post =</span> True_score.Pre <span class="op">+</span><span class="st"> </span>True_score.Change,</span>
<span id="cb30-48"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-48"></a></span>
<span id="cb30-49"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-49"></a>  <span class="co"># Manifested score</span></span>
<span id="cb30-50"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-50"></a>  <span class="dt">Manifested_score.Pre =</span> True_score.Pre <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, biological_variation),</span>
<span id="cb30-51"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-51"></a>  <span class="dt">Manifested_score.Post =</span> True_score.Post <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, biological_variation),</span>
<span id="cb30-52"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-52"></a>  <span class="dt">Manifested_score.Change =</span> Manifested_score.Post <span class="op">-</span><span class="st"> </span>Manifested_score.Pre,</span>
<span id="cb30-53"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-53"></a></span>
<span id="cb30-54"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-54"></a>  <span class="co"># Measured score</span></span>
<span id="cb30-55"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-55"></a>  <span class="dt">Measured_score.Pre =</span> Manifested_score.Pre <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, instrumentation_noise),</span>
<span id="cb30-56"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-56"></a>  <span class="dt">Measured_score.Post =</span> Manifested_score.Post <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n_subjects, <span class="dv">0</span>, instrumentation_noise),</span>
<span id="cb30-57"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-57"></a>  <span class="dt">Measured_score.Change =</span> Measured_score.Post <span class="op">-</span><span class="st"> </span>Measured_score.Pre</span>
<span id="cb30-58"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-58"></a>)</span>
<span id="cb30-59"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-59"></a></span>
<span id="cb30-60"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-60"></a><span class="kw">head</span>(RCT_data)</span>
<span id="cb30-61"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-61"></a><span class="co">#&gt; # A tibble: 6 x 14</span></span>
<span id="cb30-62"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-62"></a><span class="co">#&gt;   Athlete Group Squat_1RM_relat… True_score.Pre Treatment_effect</span></span>
<span id="cb30-63"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-63"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;            &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb30-64"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-64"></a><span class="co">#&gt; 1 Athlet… Trea…            1.19            36.8           -0.674</span></span>
<span id="cb30-65"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-65"></a><span class="co">#&gt; 2 Athlet… Cont…            0.950           43.4           15.1  </span></span>
<span id="cb30-66"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-66"></a><span class="co">#&gt; 3 Athlet… Trea…            1.44            44.1            8.40 </span></span>
<span id="cb30-67"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-67"></a><span class="co">#&gt; 4 Athlet… Cont…            0.422           52.4            0.366</span></span>
<span id="cb30-68"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-68"></a><span class="co">#&gt; 5 Athlet… Trea…            1.46            40.7            4.14 </span></span>
<span id="cb30-69"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-69"></a><span class="co">#&gt; 6 Athlet… Cont…            0.813           52.6            5.48 </span></span>
<span id="cb30-70"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-70"></a><span class="co">#&gt; # … with 9 more variables: Non_treatment_effect &lt;dbl&gt;, True_score.Change &lt;dbl&gt;,</span></span>
<span id="cb30-71"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-71"></a><span class="co">#&gt; #   True_score.Post &lt;dbl&gt;, Manifested_score.Pre &lt;dbl&gt;,</span></span>
<span id="cb30-72"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-72"></a><span class="co">#&gt; #   Manifested_score.Post &lt;dbl&gt;, Manifested_score.Change &lt;dbl&gt;,</span></span>
<span id="cb30-73"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-73"></a><span class="co">#&gt; #   Measured_score.Pre &lt;dbl&gt;, Measured_score.Post &lt;dbl&gt;,</span></span>
<span id="cb30-74"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb30-74"></a><span class="co">#&gt; #   Measured_score.Change &lt;dbl&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-1"></a>covariate_RCT &lt;-<span class="st"> </span>bmbstats<span class="op">::</span><span class="kw">RCT_analysis</span>(</span>
<span id="cb31-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-2"></a>  <span class="dt">data =</span> RCT_data,</span>
<span id="cb31-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-3"></a>  <span class="dt">group =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb31-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-4"></a>  <span class="dt">treatment_label =</span> <span class="st">&quot;Treatment&quot;</span>,</span>
<span id="cb31-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-5"></a>  <span class="dt">control_label =</span> <span class="st">&quot;Control&quot;</span>,</span>
<span id="cb31-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-6"></a>  <span class="dt">pre_test =</span> <span class="st">&quot;Measured_score.Pre&quot;</span>,</span>
<span id="cb31-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-7"></a>  <span class="dt">post_test =</span> <span class="st">&quot;Measured_score.Post&quot;</span>,</span>
<span id="cb31-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-8"></a>  <span class="dt">SESOI_lower =</span> <span class="dv">-5</span>,</span>
<span id="cb31-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-9"></a>  <span class="dt">SESOI_upper =</span> <span class="dv">5</span>,</span>
<span id="cb31-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-10"></a>  <span class="dt">estimator_function =</span> bmbstats<span class="op">::</span>RCT_estimators_simple,</span>
<span id="cb31-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-11"></a>  <span class="dt">control =</span> <span class="kw">model_control</span>(<span class="dt">seed =</span> <span class="dv">1667</span>)</span>
<span id="cb31-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-12"></a>)</span>
<span id="cb31-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-13"></a><span class="co">#&gt; [1] &quot;All values of t are equal to  5 \n Cannot calculate confidence intervals&quot;</span></span>
<span id="cb31-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-14"></a><span class="co">#&gt; [1] &quot;All values of t are equal to  10 \n Cannot calculate confidence intervals&quot;</span></span>
<span id="cb31-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-15"></a></span>
<span id="cb31-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-16"></a></span>
<span id="cb31-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-17"></a>covariate_RCT</span>
<span id="cb31-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-18"></a><span class="co">#&gt; Bootstrap with 2000 resamples and 95% bca confidence intervals.</span></span>
<span id="cb31-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-19"></a><span class="co">#&gt; </span></span>
<span id="cb31-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-20"></a><span class="co">#&gt;                   estimator       value         lower      upper</span></span>
<span id="cb31-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-21"></a><span class="co">#&gt;                 SESOI lower -5.00000000            NA         NA</span></span>
<span id="cb31-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-22"></a><span class="co">#&gt;                 SESOI upper  5.00000000            NA         NA</span></span>
<span id="cb31-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-23"></a><span class="co">#&gt;                 SESOI range 10.00000000            NA         NA</span></span>
<span id="cb31-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-24"></a><span class="co">#&gt;           Systematic effect  7.66822167   3.177245093 13.3600521</span></span>
<span id="cb31-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-25"></a><span class="co">#&gt;               Random effect  7.55715014   4.539982652 12.2200229</span></span>
<span id="cb31-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-26"></a><span class="co">#&gt;  Systematic effect to SESOI  0.76682217   0.317724509  1.3360052</span></span>
<span id="cb31-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-27"></a><span class="co">#&gt;      SESOI to Random effect  1.32325014 -15.262114004  2.2188971</span></span>
<span id="cb31-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-28"></a><span class="co">#&gt;                      pLower  0.06399583   0.009577243  0.3562914</span></span>
<span id="cb31-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-29"></a><span class="co">#&gt;                 pEquivalent  0.30208543   0.110950450  0.5977061</span></span>
<span id="cb31-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb31-30"></a><span class="co">#&gt;                     pHigher  0.63391874   0.290351477  0.8781438</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-1"></a>panel_a &lt;-<span class="st"> </span><span class="kw">ggplot</span>(</span>
<span id="cb32-2"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-2"></a>  RCT_data,</span>
<span id="cb32-3"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-3"></a>  <span class="kw">aes</span>(<span class="dt">x =</span> Measured_score.Pre, <span class="dt">y =</span> Measured_score.Change, <span class="dt">color =</span> Group, <span class="dt">fill =</span> Group)) <span class="op">+</span></span>
<span id="cb32-4"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-4"></a><span class="st">  </span><span class="kw">theme_cowplot</span>(<span class="dv">8</span>) <span class="op">+</span></span>
<span id="cb32-5"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-5"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>, <span class="dt">alpha=</span><span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb32-6"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-6"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.8</span>) <span class="op">+</span></span>
<span id="cb32-7"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-7"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">Treatment =</span> <span class="st">&quot;#FAA43A&quot;</span>, <span class="dt">Control =</span> <span class="st">&quot;#5DA5DA&quot;</span>)) <span class="op">+</span></span>
<span id="cb32-8"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-8"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">Treatment =</span> <span class="st">&quot;#FAA43A&quot;</span>, <span class="dt">Control =</span> <span class="st">&quot;#5DA5DA&quot;</span>)) <span class="op">+</span></span>
<span id="cb32-9"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-9"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb32-10"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-10"></a></span>
<span id="cb32-11"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-11"></a>panel_b &lt;-<span class="st"> </span><span class="kw">ggplot</span>(</span>
<span id="cb32-12"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-12"></a>  RCT_data,</span>
<span id="cb32-13"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-13"></a>  <span class="kw">aes</span>(<span class="dt">x =</span> Squat_1RM_relative, <span class="dt">y =</span> Measured_score.Change, <span class="dt">color =</span> Group, <span class="dt">fill =</span> Group)) <span class="op">+</span></span>
<span id="cb32-14"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-14"></a><span class="st">  </span><span class="kw">theme_cowplot</span>(<span class="dv">8</span>) <span class="op">+</span></span>
<span id="cb32-15"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-15"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>, <span class="dt">alpha=</span><span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb32-16"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-16"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.8</span>) <span class="op">+</span></span>
<span id="cb32-17"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-17"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">Treatment =</span> <span class="st">&quot;#FAA43A&quot;</span>, <span class="dt">Control =</span> <span class="st">&quot;#5DA5DA&quot;</span>)) <span class="op">+</span></span>
<span id="cb32-18"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-18"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">Treatment =</span> <span class="st">&quot;#FAA43A&quot;</span>, <span class="dt">Control =</span> <span class="st">&quot;#5DA5DA&quot;</span>)) <span class="op">+</span></span>
<span id="cb32-19"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-19"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,.<span class="dv">95</span>)) <span class="op">+</span></span>
<span id="cb32-20"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-20"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="ot">NULL</span>)</span>
<span id="cb32-21"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-21"></a></span>
<span id="cb32-22"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-22"></a><span class="kw">plot_grid</span>(</span>
<span id="cb32-23"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-23"></a>  panel_a,</span>
<span id="cb32-24"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-24"></a>  panel_b,</span>
<span id="cb32-25"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-25"></a>  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb32-26"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-26"></a>  <span class="dt">label_size =</span> <span class="dv">10</span>,</span>
<span id="cb32-27"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-27"></a>  <span class="dt">align =</span> <span class="st">&quot;hv&quot;</span>,</span>
<span id="cb32-28"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-28"></a>  <span class="dt">axis =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb32-29"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-29"></a>  <span class="dt">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb32-30"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-30"></a>  <span class="dt">nrow =</span> <span class="dv">1</span></span>
<span id="cb32-31"><a href="rct-analysis-and-prediction-in-bmbstats.html#cb32-31"></a>)</span></code></pre></div>
<p><img src="16-RCT-analysis-prediction_files/figure-html/unnamed-chunk-33-1.png" width="90%" style="display: block; margin: auto;" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="validity-and-reliability.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix-a-dorem-package.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mladenjovanovic/bmbstats-book/16-RCT-analysis-prediction.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
